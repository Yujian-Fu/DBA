current path: saved_models/model_cifar_Nov.13_10.40.56
Loading data
build_classes_dict done
train loaders done
get poison test loader
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 201
create model done
Poisoned following participants: [17, 33, 77, 11]
We use following environment for graphs:  cifar
----------------------------------Start one training epoch------------------------------------------
Server Epoch:201 choose agents : [17, 33, 77, 11, 37, 53, 39, 57, 63, 48]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   1,  Average loss: 0.0159, Accuracy: 446/526 (84.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   2,  Average loss: 0.0177, Accuracy: 403/526 (76.6160%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   3,  Average loss: 0.0108, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   4,  Average loss: 0.0067, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 39.66945640520393. Distance: 13.53778834436541
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.3639, Accuracy: 3947/10000 (39.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2689, Accuracy: 8189/9000 (90.9889%)
Scaling by  100
Scaled Norm after poisoning: 1353.2644327698856, distance: 1353.7786931400567
Total norm for 4 adversaries is: 1353.2644327698856. distance: 1353.7786931400567
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   2,  Average loss: 0.0166, Accuracy: 429/527 (81.4042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   3,  Average loss: 0.0098, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   4,  Average loss: 0.0058, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   5,  Average loss: 0.0037, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 33, internal_epoch   6,  Average loss: 0.0034, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 38.978544153121916. Distance: 11.471742494254837
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.1886, Accuracy: 4162/10000 (41.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 0.2743, Accuracy: 8148/9000 (90.5333%)
Scaling by  100
Scaled Norm after poisoning: 1146.4508275543265, distance: 1147.174300182845
Total norm for 4 adversaries is: 1146.4508275543265. distance: 1147.174300182845
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   1,  Average loss: 0.0098, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66304237236004.
Norm before scaling: 37.93019357927056. Distance: 6.728784351491505
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.1871, Accuracy: 6217/10000 (62.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 3.9702, Accuracy: 601/9000 (6.6778%)
Scaling by  100
Scaled Norm after poisoning: 672.0682164036624, distance: 672.8784251259658
Total norm for 4 adversaries is: 672.0682164036624. distance: 672.8784251259658
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0076, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   4,  Average loss: 0.0019, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 201, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66304237236004.
Norm before scaling: 37.97278624379817. Distance: 7.098660420589627
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.4155, Accuracy: 5842/10000 (58.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: 4.7340, Accuracy: 50/9000 (0.5556%)
Scaling by  100
Scaled Norm after poisoning: 708.9653993672752, distance: 709.8660965280706
Total norm for 4 adversaries is: 708.9653993672752. distance: 709.8660965280706
___Test Local_ResNet_18 poisoned: True, epoch: 201: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   1,  Average loss: 0.0112, Accuracy: 583/725 (80.4138%)
___Train Local_ResNet_18,  epoch 201, local model 37, internal_epoch   2,  Average loss: 0.0175, Accuracy: 508/725 (70.0690%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 17.3497, Accuracy: 1870/10000 (18.7000%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   1,  Average loss: 0.0049, Accuracy: 558/625 (89.2800%)
___Train Local_ResNet_18,  epoch 201, local model 53, internal_epoch   2,  Average loss: 0.0042, Accuracy: 571/625 (91.3600%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 2.7258, Accuracy: 4159/10000 (41.5900%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   1,  Average loss: 0.0074, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 201, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.1660, Accuracy: 3152/10000 (31.5200%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   1,  Average loss: 0.0074, Accuracy: 245/290 (84.4828%)
___Train Local_ResNet_18,  epoch 201, local model 57, internal_epoch   2,  Average loss: 0.0019, Accuracy: 280/290 (96.5517%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 4.7077, Accuracy: 3029/10000 (30.2900%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   1,  Average loss: 0.0032, Accuracy: 704/752 (93.6170%)
___Train Local_ResNet_18,  epoch 201, local model 63, internal_epoch   2,  Average loss: 0.0030, Accuracy: 707/752 (94.0160%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 1.8134, Accuracy: 5587/10000 (55.8700%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   1,  Average loss: 0.0059, Accuracy: 332/378 (87.8307%)
___Train Local_ResNet_18,  epoch 201, local model 48, internal_epoch   2,  Average loss: 0.0020, Accuracy: 364/378 (96.2963%)
___Test Local_ResNet_18 poisoned: False, epoch: 201: Average loss: 3.7046, Accuracy: 3248/10000 (32.4800%)
time spent on training: 145.71562838554382
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4122392758756395  data num: [526, 527, 496, 546, 725, 625, 217, 290, 752, 378]
[foolsgold agg] considering poison per batch poison_fraction: 0.03220619342778434
[foolsgold agg] wv: [1.         0.         0.         0.         0.44121994 0.
 1.         0.         0.49675576 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 201: Average loss: 0.7355, Accuracy: 7598/10000 (75.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 201: Average loss: 6.8872, Accuracy: 138/9000 (1.5333%)
Done in 179.37324118614197 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:202 choose agents : [17, 33, 77, 11, 63, 50, 39, 72, 88, 71]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   1,  Average loss: 0.0167, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   2,  Average loss: 0.0186, Accuracy: 419/526 (79.6578%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   3,  Average loss: 0.0099, Accuracy: 437/526 (83.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.66175076524092.
Norm before scaling: 38.866908761563316. Distance: 11.349437790444938
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.7083, Accuracy: 4948/10000 (49.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.4411, Accuracy: 7681/9000 (85.3444%)
Scaling by  100
Scaled Norm after poisoning: 1133.956568833216, distance: 1134.9437761404747
Total norm for 4 adversaries is: 1133.956568833216. distance: 1134.9437761404747
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   1,  Average loss: 0.0154, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   2,  Average loss: 0.0116, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   3,  Average loss: 0.0068, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   4,  Average loss: 0.0041, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   5,  Average loss: 0.0046, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.66175076524092.
Norm before scaling: 38.64628414634856. Distance: 10.326881691664372
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.8620, Accuracy: 4659/10000 (46.5900%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 0.2351, Accuracy: 8227/9000 (91.4111%)
Scaling by  100
Scaled Norm after poisoning: 1031.8487655659621, distance: 1032.6882394992208
Total norm for 4 adversaries is: 1031.8487655659621. distance: 1032.6882394992208
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   1,  Average loss: 0.0099, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   2,  Average loss: 0.0072, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   3,  Average loss: 0.0044, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.66175076524092.
Norm before scaling: 38.00629091892634. Distance: 7.137425880915781
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.1936, Accuracy: 6094/10000 (60.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 3.2266, Accuracy: 806/9000 (8.9556%)
Scaling by  100
Scaled Norm after poisoning: 712.9934913798302, distance: 713.7425787705256
Total norm for 4 adversaries is: 712.9934913798302. distance: 713.7425787705256
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 481/546 (88.0952%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   2,  Average loss: 0.0064, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 202, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.66175076524092.
Norm before scaling: 37.96739323707581. Distance: 7.093488915297963
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.2595, Accuracy: 6062/10000 (60.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: 4.5433, Accuracy: 111/9000 (1.2333%)
Scaling by  100
Scaled Norm after poisoning: 708.4306599802129, distance: 709.3488651573357
Total norm for 4 adversaries is: 708.4306599802129. distance: 709.3488651573357
___Test Local_ResNet_18 poisoned: True, epoch: 202: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0038, Accuracy: 695/752 (92.4202%)
___Train Local_ResNet_18,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0033, Accuracy: 697/752 (92.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 1.9710, Accuracy: 5462/10000 (54.6200%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   1,  Average loss: 0.0027, Accuracy: 384/401 (95.7606%)
___Train Local_ResNet_18,  epoch 202, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 393/401 (98.0050%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 2.6296, Accuracy: 4497/10000 (44.9700%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   1,  Average loss: 0.0066, Accuracy: 188/217 (86.6359%)
___Train Local_ResNet_18,  epoch 202, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 3.6696, Accuracy: 3525/10000 (35.2500%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   1,  Average loss: 0.0107, Accuracy: 498/618 (80.5825%)
___Train Local_ResNet_18,  epoch 202, local model 72, internal_epoch   2,  Average loss: 0.0081, Accuracy: 533/618 (86.2460%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 7.0700, Accuracy: 2908/10000 (29.0800%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   1,  Average loss: 0.0080, Accuracy: 374/447 (83.6689%)
___Train Local_ResNet_18,  epoch 202, local model 88, internal_epoch   2,  Average loss: 0.0043, Accuracy: 413/447 (92.3937%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 5.5859, Accuracy: 2413/10000 (24.1300%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   1,  Average loss: 0.0070, Accuracy: 1038/1166 (89.0223%)
___Train Local_ResNet_18,  epoch 202, local model 71, internal_epoch   2,  Average loss: 0.0144, Accuracy: 834/1166 (71.5266%)
___Test Local_ResNet_18 poisoned: False, epoch: 202: Average loss: 6.9122, Accuracy: 2444/10000 (24.4400%)
time spent on training: 138.63738775253296
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.36780196629213485  data num: [526, 527, 496, 546, 752, 401, 217, 618, 447, 1166]
[foolsgold agg] considering poison per batch poison_fraction: 0.028734528616573034
[foolsgold agg] wv: [0.82116472 0.         0.02587192 0.         1.         0.90608586
 1.         0.90608586 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 202: Average loss: 0.7330, Accuracy: 7604/10000 (76.0400%)
___Test Target_ResNet_18 poisoned: True, epoch: 202: Average loss: 6.8732, Accuracy: 139/9000 (1.5444%)
Done in 172.65737891197205 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:203 choose agents : [17, 33, 77, 11, 92, 23, 26, 50, 14, 76]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   1,  Average loss: 0.0143, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   2,  Average loss: 0.0182, Accuracy: 433/526 (82.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   3,  Average loss: 0.0105, Accuracy: 449/526 (85.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   4,  Average loss: 0.0075, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Global model norm: 37.66136181589992.
Norm before scaling: 38.90873799775733. Distance: 11.374976524915681
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.9917, Accuracy: 4443/10000 (44.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2318, Accuracy: 8275/9000 (91.9444%)
Scaling by  100
Scaled Norm after poisoning: 1136.6315915898167, distance: 1137.4976923053514
Total norm for 4 adversaries is: 1136.6315915898167. distance: 1137.4976923053514
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   1,  Average loss: 0.0153, Accuracy: 434/527 (82.3529%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   2,  Average loss: 0.0127, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   3,  Average loss: 0.0083, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   4,  Average loss: 0.0045, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.66136181589992.
Norm before scaling: 38.68636881171374. Distance: 10.454490857490644
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.0122, Accuracy: 4543/10000 (45.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 0.2651, Accuracy: 8255/9000 (91.7222%)
Scaling by  100
Scaled Norm after poisoning: 1044.642522588469, distance: 1045.4490064082513
Total norm for 4 adversaries is: 1044.642522588469. distance: 1045.4490064082513
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   1,  Average loss: 0.0097, Accuracy: 428/496 (86.2903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   2,  Average loss: 0.0083, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   3,  Average loss: 0.0044, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   4,  Average loss: 0.0031, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 77, internal_epoch   6,  Average loss: 0.0015, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.66136181589992.
Norm before scaling: 37.95354955505644. Distance: 7.00280977805321
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1661, Accuracy: 6088/10000 (60.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 2.7946, Accuracy: 1696/9000 (18.8444%)
Scaling by  100
Scaled Norm after poisoning: 699.3692247303994, distance: 700.2809480844099
Total norm for 4 adversaries is: 699.3692247303994. distance: 700.2809480844099
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   5,  Average loss: 0.0023, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 203, local model 11, internal_epoch   6,  Average loss: 0.0018, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.66136181589992.
Norm before scaling: 37.88813780496641. Distance: 6.891313652520967
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.4855, Accuracy: 5381/10000 (53.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: 3.5612, Accuracy: 801/9000 (8.9000%)
Scaling by  100
Scaled Norm after poisoning: 687.9568709228798, distance: 689.1313826114728
Total norm for 4 adversaries is: 687.9568709228798. distance: 689.1313826114728
___Test Local_ResNet_18 poisoned: True, epoch: 203: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0067, Accuracy: 695/796 (87.3116%)
___Train Local_ResNet_18,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0069, Accuracy: 692/796 (86.9347%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.9552, Accuracy: 3608/10000 (36.0800%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   1,  Average loss: 0.0051, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 203, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 247/248 (99.5968%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 3.4878, Accuracy: 3574/10000 (35.7400%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   1,  Average loss: 0.0054, Accuracy: 422/468 (90.1709%)
___Train Local_ResNet_18,  epoch 203, local model 26, internal_epoch   2,  Average loss: 0.0061, Accuracy: 416/468 (88.8889%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 2.9676, Accuracy: 4407/10000 (44.0700%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 383/401 (95.5112%)
___Train Local_ResNet_18,  epoch 203, local model 50, internal_epoch   2,  Average loss: 0.0016, Accuracy: 390/401 (97.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.6644, Accuracy: 5621/10000 (56.2100%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   1,  Average loss: 0.0077, Accuracy: 266/318 (83.6478%)
___Train Local_ResNet_18,  epoch 203, local model 14, internal_epoch   2,  Average loss: 0.0025, Accuracy: 300/318 (94.3396%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 10.9598, Accuracy: 1852/10000 (18.5200%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   1,  Average loss: 0.0350, Accuracy: 57/65 (87.6923%)
___Train Local_ResNet_18,  epoch 203, local model 76, internal_epoch   2,  Average loss: 0.0402, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 203: Average loss: 1.1638, Accuracy: 6560/10000 (65.6000%)
time spent on training: 135.9910182952881
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.47711227510817583  data num: [526, 527, 496, 546, 796, 248, 468, 401, 318, 65]
[foolsgold agg] considering poison per batch poison_fraction: 0.03727439649282624
[foolsgold agg] wv: [1. 0. 0. 0. 1. 1. 0. 1. 0. 1.]
___Test Target_ResNet_18 poisoned: False, epoch: 203: Average loss: 0.7295, Accuracy: 7614/10000 (76.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 203: Average loss: 6.8348, Accuracy: 143/9000 (1.5889%)
Done in 169.07413363456726 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:204 choose agents : [17, 33, 77, 11, 49, 86, 26, 58, 6, 94]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   1,  Average loss: 0.0132, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   2,  Average loss: 0.0154, Accuracy: 431/526 (81.9392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   3,  Average loss: 0.0109, Accuracy: 444/526 (84.4106%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.66006853045743.
Norm before scaling: 38.982350586214814. Distance: 11.499684868516846
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.9371, Accuracy: 4262/10000 (42.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.0918, Accuracy: 8714/9000 (96.8222%)
Scaling by  100
Scaled Norm after poisoning: 1149.2414345993623, distance: 1149.968640876785
Total norm for 4 adversaries is: 1149.2414345993623. distance: 1149.968640876785
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   1,  Average loss: 0.0147, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   2,  Average loss: 0.0127, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   3,  Average loss: 0.0087, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   4,  Average loss: 0.0056, Accuracy: 494/527 (93.7381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   5,  Average loss: 0.0062, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 33, internal_epoch   6,  Average loss: 0.0040, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.66006853045743.
Norm before scaling: 38.85880170214417. Distance: 11.000962995511497
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.7652, Accuracy: 4757/10000 (47.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 0.7533, Accuracy: 7202/9000 (80.0222%)
Scaling by  100
Scaled Norm after poisoning: 1099.409216352128, distance: 1100.0963026026404
Total norm for 4 adversaries is: 1099.409216352128. distance: 1100.0963026026404
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   1,  Average loss: 0.0102, Accuracy: 426/496 (85.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   2,  Average loss: 0.0075, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   3,  Average loss: 0.0036, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.66006853045743.
Norm before scaling: 37.99099946091261. Distance: 7.067594058284975
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.1175, Accuracy: 6310/10000 (63.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 4.0267, Accuracy: 587/9000 (6.5222%)
Scaling by  100
Scaled Norm after poisoning: 705.9996237605229, distance: 706.759373832424
Total norm for 4 adversaries is: 705.9996237605229. distance: 706.759373832424
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   1,  Average loss: 0.0085, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   3,  Average loss: 0.0040, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 204, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.66006853045743.
Norm before scaling: 37.989855566671515. Distance: 7.239724342198769
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.3527, Accuracy: 5800/10000 (58.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: 4.1122, Accuracy: 128/9000 (1.4222%)
Scaling by  100
Scaled Norm after poisoning: 723.0544369202087, distance: 723.9724183282123
Total norm for 4 adversaries is: 723.0544369202087. distance: 723.9724183282123
___Test Local_ResNet_18 poisoned: True, epoch: 204: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 402/426 (94.3662%)
___Train Local_ResNet_18,  epoch 204, local model 49, internal_epoch   2,  Average loss: 0.0015, Accuracy: 411/426 (96.4789%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.7789, Accuracy: 5355/10000 (53.5500%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   1,  Average loss: 0.0046, Accuracy: 191/212 (90.0943%)
___Train Local_ResNet_18,  epoch 204, local model 86, internal_epoch   2,  Average loss: 0.0011, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 1.7154, Accuracy: 5691/10000 (56.9100%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   1,  Average loss: 0.0052, Accuracy: 424/468 (90.5983%)
___Train Local_ResNet_18,  epoch 204, local model 26, internal_epoch   2,  Average loss: 0.0079, Accuracy: 419/468 (89.5299%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 4.6674, Accuracy: 3487/10000 (34.8700%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   1,  Average loss: 0.0100, Accuracy: 187/234 (79.9145%)
___Train Local_ResNet_18,  epoch 204, local model 58, internal_epoch   2,  Average loss: 0.0031, Accuracy: 226/234 (96.5812%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 8.6299, Accuracy: 1514/10000 (15.1400%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   1,  Average loss: 0.0056, Accuracy: 462/520 (88.8462%)
___Train Local_ResNet_18,  epoch 204, local model 6, internal_epoch   2,  Average loss: 0.0059, Accuracy: 461/520 (88.6538%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 3.8261, Accuracy: 3445/10000 (34.4500%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   1,  Average loss: 0.0099, Accuracy: 161/203 (79.3103%)
___Train Local_ResNet_18,  epoch 204, local model 94, internal_epoch   2,  Average loss: 0.0040, Accuracy: 195/203 (96.0591%)
___Test Local_ResNet_18 poisoned: False, epoch: 204: Average loss: 7.7815, Accuracy: 1570/10000 (15.7000%)
time spent on training: 136.87483477592468
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5038480038480039  data num: [526, 527, 496, 546, 426, 212, 468, 234, 520, 203]
[foolsgold agg] considering poison per batch poison_fraction: 0.0393631253006253
[foolsgold agg] wv: [0.8239053  0.         0.17756902 0.         1.         1.
 0.35850552 0.15545857 0.15545857 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 204: Average loss: 0.7272, Accuracy: 7616/10000 (76.1600%)
___Test Target_ResNet_18 poisoned: True, epoch: 204: Average loss: 6.8108, Accuracy: 146/9000 (1.6222%)
Done in 170.64882230758667 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:205 choose agents : [17, 33, 77, 11, 61, 71, 8, 69, 89, 64]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   1,  Average loss: 0.0146, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   2,  Average loss: 0.0188, Accuracy: 422/526 (80.2281%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   3,  Average loss: 0.0110, Accuracy: 446/526 (84.7909%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   5,  Average loss: 0.0044, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.65863581653616.
Norm before scaling: 38.917797608589375. Distance: 11.490974533412693
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.9045, Accuracy: 4447/10000 (44.4700%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.3018, Accuracy: 7929/9000 (88.1000%)
Scaling by  100
Scaled Norm after poisoning: 1148.1642957347176, distance: 1149.097363150747
Total norm for 4 adversaries is: 1148.1642957347176. distance: 1149.097363150747
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0130, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0136, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   3,  Average loss: 0.0091, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   4,  Average loss: 0.0055, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 33, internal_epoch   6,  Average loss: 0.0039, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.65863581653616.
Norm before scaling: 38.69693947846522. Distance: 10.481595940246402
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.7545, Accuracy: 4807/10000 (48.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 0.3176, Accuracy: 8067/9000 (89.6333%)
Scaling by  100
Scaled Norm after poisoning: 1047.376902074893, distance: 1048.1595775453277
Total norm for 4 adversaries is: 1047.376902074893. distance: 1048.1595775453277
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   1,  Average loss: 0.0106, Accuracy: 426/496 (85.8871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   2,  Average loss: 0.0073, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   3,  Average loss: 0.0045, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.65863581653616.
Norm before scaling: 37.94829535192836. Distance: 6.8268312673295135
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.1379, Accuracy: 6388/10000 (63.8800%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 3.6274, Accuracy: 653/9000 (7.2556%)
Scaling by  100
Scaled Norm after poisoning: 681.9119032177103, distance: 682.6830798401261
Total norm for 4 adversaries is: 681.9119032177103. distance: 682.6830798401261
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 484/546 (88.6447%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 205, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.65863581653616.
Norm before scaling: 37.884350318085666. Distance: 6.781628576162184
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 1.3564, Accuracy: 5875/10000 (58.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: 4.2080, Accuracy: 164/9000 (1.8222%)
Scaling by  100
Scaled Norm after poisoning: 677.0738973701467, distance: 678.1628906464877
Total norm for 4 adversaries is: 677.0738973701467. distance: 678.1628906464877
___Test Local_ResNet_18 poisoned: True, epoch: 205: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   1,  Average loss: 0.0042, Accuracy: 539/590 (91.3559%)
___Train Local_ResNet_18,  epoch 205, local model 61, internal_epoch   2,  Average loss: 0.0041, Accuracy: 543/590 (92.0339%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 4.3503, Accuracy: 3075/10000 (30.7500%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   1,  Average loss: 0.0063, Accuracy: 1034/1166 (88.6792%)
___Train Local_ResNet_18,  epoch 205, local model 71, internal_epoch   2,  Average loss: 0.0100, Accuracy: 930/1166 (79.7599%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 6.0302, Accuracy: 2826/10000 (28.2600%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   1,  Average loss: 0.0046, Accuracy: 486/534 (91.0112%)
___Train Local_ResNet_18,  epoch 205, local model 8, internal_epoch   2,  Average loss: 0.0082, Accuracy: 474/534 (88.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.4409, Accuracy: 4029/10000 (40.2900%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   1,  Average loss: 0.0073, Accuracy: 185/216 (85.6481%)
___Train Local_ResNet_18,  epoch 205, local model 69, internal_epoch   2,  Average loss: 0.0016, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 9.6215, Accuracy: 1101/10000 (11.0100%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   1,  Average loss: 0.0074, Accuracy: 353/413 (85.4722%)
___Train Local_ResNet_18,  epoch 205, local model 89, internal_epoch   2,  Average loss: 0.0044, Accuracy: 384/413 (92.9782%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 5.1661, Accuracy: 2866/10000 (28.6600%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   1,  Average loss: 0.0053, Accuracy: 615/686 (89.6501%)
___Train Local_ResNet_18,  epoch 205, local model 64, internal_epoch   2,  Average loss: 0.0053, Accuracy: 614/686 (89.5044%)
___Test Local_ResNet_18 poisoned: False, epoch: 205: Average loss: 3.3128, Accuracy: 3888/10000 (38.8800%)
time spent on training: 139.67622590065002
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3675438596491228  data num: [526, 527, 496, 546, 590, 1166, 534, 216, 413, 686]
[foolsgold agg] considering poison per batch poison_fraction: 0.028714364035087717
[foolsgold agg] wv: [1.         0.         0.64947654 0.         1.         0.7466606
 1.         1.         1.         0.7466606 ]
___Test Target_ResNet_18 poisoned: False, epoch: 205: Average loss: 0.7209, Accuracy: 7638/10000 (76.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 205: Average loss: 6.7741, Accuracy: 151/9000 (1.6778%)
Done in 173.45338416099548 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:206 choose agents : [17, 33, 77, 11, 38, 64, 29, 23, 83, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0139, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0154, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   3,  Average loss: 0.0092, Accuracy: 450/526 (85.5513%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   4,  Average loss: 0.0065, Accuracy: 477/526 (90.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   5,  Average loss: 0.0044, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 17, internal_epoch   6,  Average loss: 0.0037, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.65831814860098.
Norm before scaling: 38.639846269447844. Distance: 10.380223441539641
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.7171, Accuracy: 4933/10000 (49.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2986, Accuracy: 8024/9000 (89.1556%)
Scaling by  100
Scaled Norm after poisoning: 1037.1224011658412, distance: 1038.0223383916166
Total norm for 4 adversaries is: 1037.1224011658412. distance: 1038.0223383916166
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   1,  Average loss: 0.0175, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   2,  Average loss: 0.0128, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   3,  Average loss: 0.0096, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   5,  Average loss: 0.0043, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 37.65831814860098.
Norm before scaling: 38.73038975817714. Distance: 10.790552344410408
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.9845, Accuracy: 4497/10000 (44.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 0.2138, Accuracy: 8277/9000 (91.9667%)
Scaling by  100
Scaled Norm after poisoning: 1078.1113694790533, distance: 1079.0552580845895
Total norm for 4 adversaries is: 1078.1113694790533. distance: 1079.0552580845895
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   1,  Average loss: 0.0076, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.65831814860098.
Norm before scaling: 37.91082097079523. Distance: 6.480543801837103
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.0333, Accuracy: 6660/10000 (66.6000%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 4.1751, Accuracy: 501/9000 (5.5667%)
Scaling by  100
Scaled Norm after poisoning: 647.3802012727915, distance: 648.0544923075528
Total norm for 4 adversaries is: 647.3802012727915. distance: 648.0544923075528
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 477/546 (87.3626%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 206, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.65831814860098.
Norm before scaling: 37.896885758533145. Distance: 6.80147198845344
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 1.3695, Accuracy: 6032/10000 (60.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: 4.9145, Accuracy: 12/9000 (0.1333%)
Scaling by  100
Scaled Norm after poisoning: 679.1132545459557, distance: 680.1472267090413
Total norm for 4 adversaries is: 679.1132545459557. distance: 680.1472267090413
___Test Local_ResNet_18 poisoned: True, epoch: 206: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   1,  Average loss: 0.0043, Accuracy: 691/756 (91.4021%)
___Train Local_ResNet_18,  epoch 206, local model 38, internal_epoch   2,  Average loss: 0.0047, Accuracy: 687/756 (90.8730%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.4988, Accuracy: 3307/10000 (33.0700%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0049, Accuracy: 614/686 (89.5044%)
___Train Local_ResNet_18,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0042, Accuracy: 634/686 (92.4198%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 4.1488, Accuracy: 3790/10000 (37.9000%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   1,  Average loss: 0.0075, Accuracy: 729/848 (85.9670%)
___Train Local_ResNet_18,  epoch 206, local model 29, internal_epoch   2,  Average loss: 0.0045, Accuracy: 776/848 (91.5094%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 16.8464, Accuracy: 1359/10000 (13.5900%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   1,  Average loss: 0.0049, Accuracy: 218/248 (87.9032%)
___Train Local_ResNet_18,  epoch 206, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.6254, Accuracy: 4103/10000 (41.0300%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 342/366 (93.4426%)
___Train Local_ResNet_18,  epoch 206, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 365/366 (99.7268%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 2.4638, Accuracy: 5074/10000 (50.7400%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   1,  Average loss: 0.0070, Accuracy: 299/345 (86.6667%)
___Train Local_ResNet_18,  epoch 206, local model 43, internal_epoch   2,  Average loss: 0.0034, Accuracy: 326/345 (94.4928%)
___Test Local_ResNet_18 poisoned: False, epoch: 206: Average loss: 7.3363, Accuracy: 2457/10000 (24.5700%)
time spent on training: 142.299311876297
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39202844311377244  data num: [526, 527, 496, 546, 756, 686, 848, 248, 366, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03062722211826347
[foolsgold agg] wv: [0.98882758 0.         0.59218574 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 206: Average loss: 0.7158, Accuracy: 7648/10000 (76.4800%)
___Test Target_ResNet_18 poisoned: True, epoch: 206: Average loss: 6.7265, Accuracy: 154/9000 (1.7111%)
Done in 177.8947114944458 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:207 choose agents : [17, 33, 77, 11, 56, 45, 1, 50, 16, 12]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   1,  Average loss: 0.0154, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   2,  Average loss: 0.0159, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   3,  Average loss: 0.0093, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   4,  Average loss: 0.0070, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 17, internal_epoch   6,  Average loss: 0.0040, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.65781895071726.
Norm before scaling: 38.69197078872599. Distance: 10.586068308117094
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.9561, Accuracy: 4107/10000 (41.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.0232, Accuracy: 8956/9000 (99.5111%)
Scaling by  100
Scaled Norm after poisoning: 1057.7125081987072, distance: 1058.6068675386534
Total norm for 4 adversaries is: 1057.7125081987072. distance: 1058.6068675386534
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   1,  Average loss: 0.0159, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   2,  Average loss: 0.0164, Accuracy: 420/527 (79.6964%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   3,  Average loss: 0.0088, Accuracy: 459/527 (87.0968%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   4,  Average loss: 0.0046, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Global model norm: 37.65781895071726.
Norm before scaling: 38.69087285882971. Distance: 10.543607711510266
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.1845, Accuracy: 4321/10000 (43.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 0.4705, Accuracy: 7546/9000 (83.8444%)
Scaling by  100
Scaled Norm after poisoning: 1053.5013051724236, distance: 1054.360766056856
Total norm for 4 adversaries is: 1053.5013051724236. distance: 1054.360766056856
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   1,  Average loss: 0.0089, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   3,  Average loss: 0.0042, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.65781895071726.
Norm before scaling: 37.94236962929355. Distance: 6.700669201126103
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.0819, Accuracy: 6462/10000 (64.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 4.3014, Accuracy: 377/9000 (4.1889%)
Scaling by  100
Scaled Norm after poisoning: 669.3796335040378, distance: 670.0669742645133
Total norm for 4 adversaries is: 669.3796335040378. distance: 670.0669742645133
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   1,  Average loss: 0.0093, Accuracy: 479/546 (87.7289%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 207, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.65781895071726.
Norm before scaling: 37.9584846591271. Distance: 7.20525707540717
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 1.4832, Accuracy: 5711/10000 (57.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: 4.8854, Accuracy: 29/9000 (0.3222%)
Scaling by  100
Scaled Norm after poisoning: 719.4841250854671, distance: 720.5256761559576
Total norm for 4 adversaries is: 719.4841250854671. distance: 720.5256761559576
___Test Local_ResNet_18 poisoned: True, epoch: 207: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   1,  Average loss: 0.0029, Accuracy: 707/743 (95.1548%)
___Train Local_ResNet_18,  epoch 207, local model 56, internal_epoch   2,  Average loss: 0.0032, Accuracy: 698/743 (93.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.1066, Accuracy: 5363/10000 (53.6300%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   1,  Average loss: 0.0080, Accuracy: 460/529 (86.9565%)
___Train Local_ResNet_18,  epoch 207, local model 45, internal_epoch   2,  Average loss: 0.0137, Accuracy: 427/529 (80.7183%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 34.1668, Accuracy: 1131/10000 (11.3100%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   1,  Average loss: 0.0045, Accuracy: 585/641 (91.2637%)
___Train Local_ResNet_18,  epoch 207, local model 1, internal_epoch   2,  Average loss: 0.0083, Accuracy: 596/641 (92.9797%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 4.3489, Accuracy: 2734/10000 (27.3400%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   1,  Average loss: 0.0029, Accuracy: 376/401 (93.7656%)
___Train Local_ResNet_18,  epoch 207, local model 50, internal_epoch   2,  Average loss: 0.0021, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 2.9877, Accuracy: 4076/10000 (40.7600%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   1,  Average loss: 0.0061, Accuracy: 703/773 (90.9444%)
___Train Local_ResNet_18,  epoch 207, local model 16, internal_epoch   2,  Average loss: 0.0219, Accuracy: 485/773 (62.7426%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 369.1483, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 868/977 (88.8434%)
___Train Local_ResNet_18,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0091, Accuracy: 803/977 (82.1904%)
___Test Local_ResNet_18 poisoned: False, epoch: 207: Average loss: 10.2111, Accuracy: 3210/10000 (32.1000%)
time spent on training: 142.62099409103394
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.34015262217892517  data num: [526, 527, 496, 546, 743, 529, 641, 401, 773, 977]
[foolsgold agg] considering poison per batch poison_fraction: 0.026574423607728527
[foolsgold agg] wv: [0.52064213 0.         0.16027561 0.         0.         0.85542996
 1.         0.         0.85542996 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 207: Average loss: 0.7120, Accuracy: 7656/10000 (76.5600%)
___Test Target_ResNet_18 poisoned: True, epoch: 207: Average loss: 6.7224, Accuracy: 160/9000 (1.7778%)
Done in 177.89828443527222 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:208 choose agents : [17, 33, 77, 11, 44, 86, 20, 50, 49, 43]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   1,  Average loss: 0.0150, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   2,  Average loss: 0.0154, Accuracy: 434/526 (82.5095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   3,  Average loss: 0.0094, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.65730515897198.
Norm before scaling: 38.771072269436594. Distance: 10.841478269221948
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.8366, Accuracy: 4907/10000 (49.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.6098, Accuracy: 7441/9000 (82.6778%)
Scaling by  100
Scaled Norm after poisoning: 1083.3066278759675, distance: 1084.147764375318
Total norm for 4 adversaries is: 1083.3066278759675. distance: 1084.147764375318
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   1,  Average loss: 0.0154, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   2,  Average loss: 0.0132, Accuracy: 427/527 (81.0247%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   3,  Average loss: 0.0070, Accuracy: 473/527 (89.7533%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   5,  Average loss: 0.0035, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 33, internal_epoch   6,  Average loss: 0.0040, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Global model norm: 37.65730515897198.
Norm before scaling: 39.27360922853841. Distance: 12.188565408159583
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.1130, Accuracy: 4354/10000 (43.5400%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 0.4413, Accuracy: 7968/9000 (88.5333%)
Scaling by  100
Scaled Norm after poisoning: 1218.444654056966, distance: 1218.856482527783
Total norm for 4 adversaries is: 1218.444654056966. distance: 1218.856482527783
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   1,  Average loss: 0.0078, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.65730515897198.
Norm before scaling: 37.810976208966096. Distance: 6.011715577281489
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.0717, Accuracy: 6512/10000 (65.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 3.9113, Accuracy: 809/9000 (8.9889%)
Scaling by  100
Scaled Norm after poisoning: 600.3090349978085, distance: 601.171538539542
Total norm for 4 adversaries is: 600.3090349978085. distance: 601.171538539542
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   3,  Average loss: 0.0035, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 208, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.65730515897198.
Norm before scaling: 38.02077839607903. Distance: 7.21230037948476
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.3655, Accuracy: 6072/10000 (60.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: 5.6987, Accuracy: 2/9000 (0.0222%)
Scaling by  100
Scaled Norm after poisoning: 720.5135321421798, distance: 721.230047384328
Total norm for 4 adversaries is: 720.5135321421798. distance: 721.230047384328
___Test Local_ResNet_18 poisoned: True, epoch: 208: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   1,  Average loss: 0.0044, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 208, local model 44, internal_epoch   2,  Average loss: 0.0025, Accuracy: 416/436 (95.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.4926, Accuracy: 4714/10000 (47.1400%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   1,  Average loss: 0.0043, Accuracy: 190/212 (89.6226%)
___Train Local_ResNet_18,  epoch 208, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 1.4765, Accuracy: 6099/10000 (60.9900%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0079, Accuracy: 300/362 (82.8729%)
___Train Local_ResNet_18,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0029, Accuracy: 342/362 (94.4751%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.2671, Accuracy: 2888/10000 (28.8800%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0031, Accuracy: 380/401 (94.7631%)
___Train Local_ResNet_18,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0023, Accuracy: 389/401 (97.0075%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.5733, Accuracy: 4397/10000 (43.9700%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   1,  Average loss: 0.0030, Accuracy: 398/426 (93.4272%)
___Train Local_ResNet_18,  epoch 208, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 413/426 (96.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 2.7761, Accuracy: 4394/10000 (43.9400%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   1,  Average loss: 0.0073, Accuracy: 302/345 (87.5362%)
___Train Local_ResNet_18,  epoch 208, local model 43, internal_epoch   2,  Average loss: 0.0038, Accuracy: 327/345 (94.7826%)
___Test Local_ResNet_18 poisoned: False, epoch: 208: Average loss: 7.0852, Accuracy: 2690/10000 (26.9000%)
time spent on training: 139.8914875984192
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4898293196165537  data num: [526, 527, 496, 546, 436, 212, 362, 401, 426, 345]
[foolsgold agg] considering poison per batch poison_fraction: 0.03826791559504326
[foolsgold agg] wv: [0.57580638 0.         0.19784403 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 208: Average loss: 0.7105, Accuracy: 7659/10000 (76.5900%)
___Test Target_ResNet_18 poisoned: True, epoch: 208: Average loss: 6.7154, Accuracy: 158/9000 (1.7556%)
Done in 174.47468280792236 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:209 choose agents : [17, 33, 77, 11, 28, 51, 4, 97, 85, 59]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   1,  Average loss: 0.0155, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   2,  Average loss: 0.0163, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   3,  Average loss: 0.0106, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   5,  Average loss: 0.0040, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 17, internal_epoch   6,  Average loss: 0.0035, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 37.6561284360071.
Norm before scaling: 38.72517003119951. Distance: 10.8061614227636
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.7485, Accuracy: 4449/10000 (44.4900%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.1385, Accuracy: 8541/9000 (94.9000%)
Scaling by  100
Scaled Norm after poisoning: 1079.6468751402006, distance: 1080.6161436884051
Total norm for 4 adversaries is: 1079.6468751402006. distance: 1080.6161436884051
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   1,  Average loss: 0.0131, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   2,  Average loss: 0.0113, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   3,  Average loss: 0.0067, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.6561284360071.
Norm before scaling: 38.51376453417336. Distance: 9.793059511072235
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.6896, Accuracy: 4939/10000 (49.3900%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 0.2624, Accuracy: 8181/9000 (90.9000%)
Scaling by  100
Scaled Norm after poisoning: 978.468158654128, distance: 979.3059404496636
Total norm for 4 adversaries is: 978.468158654128. distance: 979.3059404496636
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   1,  Average loss: 0.0086, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   2,  Average loss: 0.0074, Accuracy: 452/496 (91.1290%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 466/496 (93.9516%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   4,  Average loss: 0.0014, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.6561284360071.
Norm before scaling: 37.91354815615471. Distance: 6.547789152503655
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.1485, Accuracy: 6328/10000 (63.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 3.5117, Accuracy: 853/9000 (9.4778%)
Scaling by  100
Scaled Norm after poisoning: 654.0729842685753, distance: 654.779041929413
Total norm for 4 adversaries is: 654.0729842685753. distance: 654.779041929413
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   1,  Average loss: 0.0080, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 209, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.6561284360071.
Norm before scaling: 37.89967836429734. Distance: 6.803985594539654
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.3837, Accuracy: 5973/10000 (59.7300%)
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: 5.0816, Accuracy: 19/9000 (0.2111%)
Scaling by  100
Scaled Norm after poisoning: 679.3900987282638, distance: 680.3985964124265
Total norm for 4 adversaries is: 679.3900987282638. distance: 680.3985964124265
___Test Local_ResNet_18 poisoned: True, epoch: 209: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 410/423 (96.9267%)
___Train Local_ResNet_18,  epoch 209, local model 28, internal_epoch   2,  Average loss: 0.0013, Accuracy: 412/423 (97.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.6147, Accuracy: 5939/10000 (59.3900%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   1,  Average loss: 0.0045, Accuracy: 434/479 (90.6054%)
___Train Local_ResNet_18,  epoch 209, local model 51, internal_epoch   2,  Average loss: 0.0024, Accuracy: 458/479 (95.6159%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 3.5465, Accuracy: 3589/10000 (35.8900%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   1,  Average loss: 0.0061, Accuracy: 495/557 (88.8689%)
___Train Local_ResNet_18,  epoch 209, local model 4, internal_epoch   2,  Average loss: 0.0040, Accuracy: 516/557 (92.6391%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 4.2205, Accuracy: 3490/10000 (34.9000%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   1,  Average loss: 0.0030, Accuracy: 395/418 (94.4976%)
___Train Local_ResNet_18,  epoch 209, local model 97, internal_epoch   2,  Average loss: 0.0014, Accuracy: 409/418 (97.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 1.9999, Accuracy: 5343/10000 (53.4300%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 308/364 (84.6154%)
___Train Local_ResNet_18,  epoch 209, local model 85, internal_epoch   2,  Average loss: 0.0037, Accuracy: 338/364 (92.8571%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 5.0306, Accuracy: 2631/10000 (26.3100%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   1,  Average loss: 0.0106, Accuracy: 584/642 (90.9657%)
___Train Local_ResNet_18,  epoch 209, local model 59, internal_epoch   2,  Average loss: 0.0170, Accuracy: 485/642 (75.5452%)
___Test Local_ResNet_18 poisoned: False, epoch: 209: Average loss: 15.3270, Accuracy: 1457/10000 (14.5700%)
time spent on training: 143.02023029327393
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4208517476898353  data num: [526, 527, 496, 546, 423, 479, 557, 418, 364, 642]
[foolsgold agg] considering poison per batch poison_fraction: 0.032879042788268385
[foolsgold agg] wv: [0.41338075 0.         0.11920599 0.         0.07827529 1.
 1.         1.         0.07827529 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 209: Average loss: 0.7093, Accuracy: 7664/10000 (76.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 209: Average loss: 6.7127, Accuracy: 161/9000 (1.7889%)
Done in 176.84794569015503 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:210 choose agents : [17, 33, 77, 11, 51, 13, 57, 76, 80, 85]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0134, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0153, Accuracy: 437/526 (83.0798%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   3,  Average loss: 0.0092, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   4,  Average loss: 0.0063, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   5,  Average loss: 0.0030, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 17, internal_epoch   6,  Average loss: 0.0035, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.65496788533105.
Norm before scaling: 38.523298867880754. Distance: 10.08839676095974
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.9283, Accuracy: 4244/10000 (42.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.0758, Accuracy: 8824/9000 (98.0444%)
Scaling by  100
Scaled Norm after poisoning: 1007.7762028347365, distance: 1008.839772957034
Total norm for 4 adversaries is: 1007.7762028347365. distance: 1008.839772957034
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   1,  Average loss: 0.0132, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   2,  Average loss: 0.0118, Accuracy: 448/527 (85.0095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   3,  Average loss: 0.0073, Accuracy: 482/527 (91.4611%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   4,  Average loss: 0.0045, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   5,  Average loss: 0.0031, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.65496788533105.
Norm before scaling: 38.630051563375666. Distance: 10.177999173476728
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.6792, Accuracy: 4791/10000 (47.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 0.4355, Accuracy: 7795/9000 (86.6111%)
Scaling by  100
Scaled Norm after poisoning: 1017.0613305007718, distance: 1017.7998636765482
Total norm for 4 adversaries is: 1017.0613305007718. distance: 1017.7998636765482
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   1,  Average loss: 0.0102, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   2,  Average loss: 0.0071, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   4,  Average loss: 0.0018, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 77, internal_epoch   6,  Average loss: 0.0004, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.65496788533105.
Norm before scaling: 37.967795126881875. Distance: 6.856251902827761
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.0747, Accuracy: 6423/10000 (64.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 4.1055, Accuracy: 587/9000 (6.5222%)
Scaling by  100
Scaled Norm after poisoning: 684.9559292392468, distance: 685.6251937100911
Total norm for 4 adversaries is: 684.9559292392468. distance: 685.6251937100911
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   3,  Average loss: 0.0019, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 210, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.65496788533105.
Norm before scaling: 37.89137885848013. Distance: 6.780039877085037
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 1.2933, Accuracy: 6050/10000 (60.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: 4.3388, Accuracy: 157/9000 (1.7444%)
Scaling by  100
Scaled Norm after poisoning: 676.9759273785147, distance: 678.0039408071312
Total norm for 4 adversaries is: 676.9759273785147. distance: 678.0039408071312
___Test Local_ResNet_18 poisoned: True, epoch: 210: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   1,  Average loss: 0.0039, Accuracy: 436/479 (91.0230%)
___Train Local_ResNet_18,  epoch 210, local model 51, internal_epoch   2,  Average loss: 0.0031, Accuracy: 456/479 (95.1983%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 6.5922, Accuracy: 2802/10000 (28.0200%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   1,  Average loss: 0.0041, Accuracy: 573/620 (92.4194%)
___Train Local_ResNet_18,  epoch 210, local model 13, internal_epoch   2,  Average loss: 0.0032, Accuracy: 578/620 (93.2258%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.5650, Accuracy: 4597/10000 (45.9700%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   1,  Average loss: 0.0068, Accuracy: 248/290 (85.5172%)
___Train Local_ResNet_18,  epoch 210, local model 57, internal_epoch   2,  Average loss: 0.0017, Accuracy: 281/290 (96.8966%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.1045, Accuracy: 3945/10000 (39.4500%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   1,  Average loss: 0.0374, Accuracy: 59/65 (90.7692%)
___Train Local_ResNet_18,  epoch 210, local model 76, internal_epoch   2,  Average loss: 0.0425, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 2.5030, Accuracy: 4067/10000 (40.6700%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   1,  Average loss: 0.0066, Accuracy: 311/363 (85.6749%)
___Train Local_ResNet_18,  epoch 210, local model 80, internal_epoch   2,  Average loss: 0.0015, Accuracy: 352/363 (96.9697%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 4.8441, Accuracy: 3292/10000 (32.9200%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   1,  Average loss: 0.0078, Accuracy: 308/364 (84.6154%)
___Train Local_ResNet_18,  epoch 210, local model 85, internal_epoch   2,  Average loss: 0.0035, Accuracy: 343/364 (94.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 210: Average loss: 3.5771, Accuracy: 3237/10000 (32.3700%)
time spent on training: 137.77767062187195
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4899438727782975  data num: [526, 527, 496, 546, 479, 620, 290, 65, 363, 364]
[foolsgold agg] considering poison per batch poison_fraction: 0.038276865060804494
[foolsgold agg] wv: [0.53369691 0.         0.         0.         1.         0.
 0.         0.78593541 0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 210: Average loss: 0.7075, Accuracy: 7668/10000 (76.6800%)
___Test Target_ResNet_18 poisoned: True, epoch: 210: Average loss: 6.6850, Accuracy: 161/9000 (1.7889%)
Done in 171.79793071746826 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:211 choose agents : [17, 33, 77, 11, 90, 24, 63, 1, 52, 31]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0147, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0162, Accuracy: 434/526 (82.5095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 17, internal_epoch   6,  Average loss: 0.0024, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.65331776705988.
Norm before scaling: 38.75881483661571. Distance: 10.880075256984956
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.7840, Accuracy: 4814/10000 (48.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.3097, Accuracy: 8099/9000 (89.9889%)
Scaling by  100
Scaled Norm after poisoning: 1087.100731303222, distance: 1088.0075252497109
Total norm for 4 adversaries is: 1087.100731303222. distance: 1088.0075252497109
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   1,  Average loss: 0.0164, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   2,  Average loss: 0.0122, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   3,  Average loss: 0.0089, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   4,  Average loss: 0.0060, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   5,  Average loss: 0.0033, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 33, internal_epoch   6,  Average loss: 0.0024, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.65331776705988.
Norm before scaling: 38.58143464944474. Distance: 10.144776421758191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.7061, Accuracy: 5116/10000 (51.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 0.4812, Accuracy: 7610/9000 (84.5556%)
Scaling by  100
Scaled Norm after poisoning: 1013.5910479577057, distance: 1014.4777289324788
Total norm for 4 adversaries is: 1013.5910479577057. distance: 1014.4777289324788
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   1,  Average loss: 0.0094, Accuracy: 434/496 (87.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   4,  Average loss: 0.0029, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 37.65331776705988.
Norm before scaling: 37.912748051859154. Distance: 6.681884404351457
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.1191, Accuracy: 6358/10000 (63.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 3.2194, Accuracy: 987/9000 (10.9667%)
Scaling by  100
Scaled Norm after poisoning: 667.3748712305551, distance: 668.1884558266478
Total norm for 4 adversaries is: 667.3748712305551. distance: 668.1884558266478
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   1,  Average loss: 0.0078, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 500/546 (91.5751%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 211, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.65331776705988.
Norm before scaling: 37.92257190593667. Distance: 6.794639763563743
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.2091, Accuracy: 6368/10000 (63.6800%)
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: 4.8360, Accuracy: 40/9000 (0.4444%)
Scaling by  100
Scaled Norm after poisoning: 678.6069370408765, distance: 679.4639661159376
Total norm for 4 adversaries is: 678.6069370408765. distance: 679.4639661159376
___Test Local_ResNet_18 poisoned: True, epoch: 211: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   1,  Average loss: 0.0148, Accuracy: 514/578 (88.9273%)
___Train Local_ResNet_18,  epoch 211, local model 90, internal_epoch   2,  Average loss: 0.0184, Accuracy: 388/578 (67.1280%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 103.3416, Accuracy: 1082/10000 (10.8200%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 291/320 (90.9375%)
___Train Local_ResNet_18,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0007, Accuracy: 316/320 (98.7500%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 2.9729, Accuracy: 3939/10000 (39.3900%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   1,  Average loss: 0.0026, Accuracy: 712/752 (94.6809%)
___Train Local_ResNet_18,  epoch 211, local model 63, internal_epoch   2,  Average loss: 0.0024, Accuracy: 718/752 (95.4787%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 1.2764, Accuracy: 6377/10000 (63.7700%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   1,  Average loss: 0.0090, Accuracy: 595/641 (92.8237%)
___Train Local_ResNet_18,  epoch 211, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 557/641 (86.8955%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 4.6556, Accuracy: 3716/10000 (37.1600%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   1,  Average loss: 0.0078, Accuracy: 181/214 (84.5794%)
___Train Local_ResNet_18,  epoch 211, local model 52, internal_epoch   2,  Average loss: 0.0020, Accuracy: 210/214 (98.1308%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 3.9416, Accuracy: 3596/10000 (35.9600%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   1,  Average loss: 0.0041, Accuracy: 657/706 (93.0595%)
___Train Local_ResNet_18,  epoch 211, local model 31, internal_epoch   2,  Average loss: 0.0107, Accuracy: 568/706 (80.4533%)
___Test Local_ResNet_18 poisoned: False, epoch: 211: Average loss: 8.4901, Accuracy: 2098/10000 (20.9800%)
time spent on training: 136.86021327972412
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3948360346777233  data num: [526, 527, 496, 546, 578, 320, 752, 641, 214, 706]
[foolsgold agg] considering poison per batch poison_fraction: 0.030846565209197135
[foolsgold agg] wv: [0.43777897 0.         0.16376302 0.         1.         0.
 0.         0.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 211: Average loss: 0.7065, Accuracy: 7670/10000 (76.7000%)
___Test Target_ResNet_18 poisoned: True, epoch: 211: Average loss: 6.6841, Accuracy: 163/9000 (1.8111%)
Done in 170.95106887817383 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:212 choose agents : [17, 33, 77, 11, 59, 67, 71, 66, 76, 96]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   1,  Average loss: 0.0137, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   2,  Average loss: 0.0165, Accuracy: 427/526 (81.1787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   3,  Average loss: 0.0103, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   4,  Average loss: 0.0064, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   5,  Average loss: 0.0053, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 17, internal_epoch   6,  Average loss: 0.0044, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 37.6519869215507.
Norm before scaling: 38.86663080631475. Distance: 11.300623945716449
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.8324, Accuracy: 4334/10000 (43.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1962, Accuracy: 8295/9000 (92.1667%)
Scaling by  100
Scaled Norm after poisoning: 1129.1512852580915, distance: 1130.0624429649895
Total norm for 4 adversaries is: 1129.1512852580915. distance: 1130.0624429649895
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   1,  Average loss: 0.0145, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   2,  Average loss: 0.0137, Accuracy: 433/527 (82.1632%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   3,  Average loss: 0.0090, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   4,  Average loss: 0.0051, Accuracy: 493/527 (93.5484%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   5,  Average loss: 0.0045, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.6519869215507.
Norm before scaling: 38.846474537393675. Distance: 10.9431570192004
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.7678, Accuracy: 4743/10000 (47.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 0.1950, Accuracy: 8390/9000 (93.2222%)
Scaling by  100
Scaled Norm after poisoning: 1093.6667682617042, distance: 1094.3158250706238
Total norm for 4 adversaries is: 1093.6667682617042. distance: 1094.3158250706238
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   1,  Average loss: 0.0112, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   2,  Average loss: 0.0083, Accuracy: 434/496 (87.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   3,  Average loss: 0.0053, Accuracy: 463/496 (93.3468%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   4,  Average loss: 0.0023, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.6519869215507.
Norm before scaling: 37.930483224145554. Distance: 6.831186406990427
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.1306, Accuracy: 6215/10000 (62.1500%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 3.0676, Accuracy: 1088/9000 (12.0889%)
Scaling by  100
Scaled Norm after poisoning: 682.2808485147447, distance: 683.1186527609973
Total norm for 4 adversaries is: 682.2808485147447. distance: 683.1186527609973
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   1,  Average loss: 0.0090, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 212, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.6519869215507.
Norm before scaling: 37.84216617763345. Distance: 6.5621175018738
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1.2928, Accuracy: 6063/10000 (60.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: 4.5997, Accuracy: 106/9000 (1.1778%)
Scaling by  100
Scaled Norm after poisoning: 655.1038801213133, distance: 656.2117369797647
Total norm for 4 adversaries is: 655.1038801213133. distance: 656.2117369797647
___Test Local_ResNet_18 poisoned: True, epoch: 212: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   1,  Average loss: 0.0094, Accuracy: 587/642 (91.4330%)
___Train Local_ResNet_18,  epoch 212, local model 59, internal_epoch   2,  Average loss: 0.0172, Accuracy: 452/642 (70.4050%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 1499.3122, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   1,  Average loss: 0.0042, Accuracy: 772/842 (91.6865%)
___Train Local_ResNet_18,  epoch 212, local model 67, internal_epoch   2,  Average loss: 0.0118, Accuracy: 674/842 (80.0475%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 39.4749, Accuracy: 1039/10000 (10.3900%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   1,  Average loss: 0.0055, Accuracy: 1058/1166 (90.7376%)
___Train Local_ResNet_18,  epoch 212, local model 71, internal_epoch   2,  Average loss: 0.0127, Accuracy: 880/1166 (75.4717%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 9.0830, Accuracy: 2536/10000 (25.3600%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   1,  Average loss: 0.0044, Accuracy: 511/555 (92.0721%)
___Train Local_ResNet_18,  epoch 212, local model 66, internal_epoch   2,  Average loss: 0.0015, Accuracy: 536/555 (96.5766%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 4.0384, Accuracy: 3607/10000 (36.0700%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   1,  Average loss: 0.0267, Accuracy: 60/65 (92.3077%)
___Train Local_ResNet_18,  epoch 212, local model 76, internal_epoch   2,  Average loss: 0.0566, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.8748, Accuracy: 7250/10000 (72.5000%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   1,  Average loss: 0.0051, Accuracy: 629/708 (88.8418%)
___Train Local_ResNet_18,  epoch 212, local model 96, internal_epoch   2,  Average loss: 0.0057, Accuracy: 621/708 (87.7119%)
___Test Local_ResNet_18 poisoned: False, epoch: 212: Average loss: 3.2908, Accuracy: 3704/10000 (37.0400%)
time spent on training: 140.32386469841003
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3449695372962292  data num: [526, 527, 496, 546, 642, 842, 1166, 555, 65, 708]
[foolsgold agg] considering poison per batch poison_fraction: 0.026950745101267905
[foolsgold agg] wv: [0.47253316 0.         0.11605593 0.         0.36848163 0.34407277
 0.34407277 1.         0.36848163 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 212: Average loss: 0.7031, Accuracy: 7676/10000 (76.7600%)
___Test Target_ResNet_18 poisoned: True, epoch: 212: Average loss: 6.6747, Accuracy: 163/9000 (1.8111%)
Done in 175.0826268196106 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:213 choose agents : [17, 33, 77, 11, 80, 81, 22, 72, 64, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   1,  Average loss: 0.0132, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   2,  Average loss: 0.0161, Accuracy: 433/526 (82.3194%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   3,  Average loss: 0.0074, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 17, internal_epoch   6,  Average loss: 0.0039, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.65116504827158.
Norm before scaling: 38.5293712792186. Distance: 9.976224482821175
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.5889, Accuracy: 5093/10000 (50.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.5799, Accuracy: 7581/9000 (84.2333%)
Scaling by  100
Scaled Norm after poisoning: 996.6974528411317, distance: 997.622454889624
Total norm for 4 adversaries is: 996.6974528411317. distance: 997.622454889624
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   1,  Average loss: 0.0144, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   2,  Average loss: 0.0156, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   3,  Average loss: 0.0080, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 33, internal_epoch   6,  Average loss: 0.0033, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.65116504827158.
Norm before scaling: 38.59340523631434. Distance: 10.212948706865344
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.9844, Accuracy: 4593/10000 (45.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 0.6397, Accuracy: 7264/9000 (80.7111%)
Scaling by  100
Scaled Norm after poisoning: 1020.3990640920836, distance: 1021.2947970591058
Total norm for 4 adversaries is: 1020.3990640920836. distance: 1021.2947970591058
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   1,  Average loss: 0.0072, Accuracy: 436/496 (87.9032%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   4,  Average loss: 0.0021, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   5,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.65116504827158.
Norm before scaling: 37.87885448621038. Distance: 6.275216464378316
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.0213, Accuracy: 6642/10000 (66.4200%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 4.5942, Accuracy: 462/9000 (5.1333%)
Scaling by  100
Scaled Norm after poisoning: 626.883511906319, distance: 627.5216131736022
Total norm for 4 adversaries is: 626.883511906319. distance: 627.5216131736022
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   2,  Average loss: 0.0068, Accuracy: 503/546 (92.1245%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   3,  Average loss: 0.0038, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 213, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.65116504827158.
Norm before scaling: 37.918490076062334. Distance: 6.971975905621337
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 1.4881, Accuracy: 5535/10000 (55.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: 4.7761, Accuracy: 39/9000 (0.4333%)
Scaling by  100
Scaled Norm after poisoning: 696.1762528268255, distance: 697.1976047004177
Total norm for 4 adversaries is: 696.1762528268255. distance: 697.1976047004177
___Test Local_ResNet_18 poisoned: True, epoch: 213: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   1,  Average loss: 0.0058, Accuracy: 322/363 (88.7052%)
___Train Local_ResNet_18,  epoch 213, local model 80, internal_epoch   2,  Average loss: 0.0016, Accuracy: 354/363 (97.5207%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.2875, Accuracy: 4146/10000 (41.4600%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   1,  Average loss: 0.0072, Accuracy: 915/1034 (88.4913%)
___Train Local_ResNet_18,  epoch 213, local model 81, internal_epoch   2,  Average loss: 0.0200, Accuracy: 678/1034 (65.5706%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 136.1400, Accuracy: 1015/10000 (10.1500%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   1,  Average loss: 0.0075, Accuracy: 426/494 (86.2348%)
___Train Local_ResNet_18,  epoch 213, local model 22, internal_epoch   2,  Average loss: 0.0032, Accuracy: 459/494 (92.9150%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 3.1567, Accuracy: 3642/10000 (36.4200%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   1,  Average loss: 0.0091, Accuracy: 519/618 (83.9806%)
___Train Local_ResNet_18,  epoch 213, local model 72, internal_epoch   2,  Average loss: 0.0081, Accuracy: 525/618 (84.9515%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 4.4899, Accuracy: 3165/10000 (31.6500%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   1,  Average loss: 0.0047, Accuracy: 620/686 (90.3790%)
___Train Local_ResNet_18,  epoch 213, local model 64, internal_epoch   2,  Average loss: 0.0045, Accuracy: 621/686 (90.5248%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 4.0156, Accuracy: 3907/10000 (39.0700%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   1,  Average loss: 0.0063, Accuracy: 464/529 (87.7127%)
___Train Local_ResNet_18,  epoch 213, local model 45, internal_epoch   2,  Average loss: 0.0084, Accuracy: 458/529 (86.5784%)
___Test Local_ResNet_18 poisoned: False, epoch: 213: Average loss: 12.1521, Accuracy: 1426/10000 (14.2600%)
time spent on training: 139.82655119895935
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3600274961333563  data num: [526, 527, 496, 546, 363, 1034, 494, 618, 686, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.02812714813541846
[foolsgold agg] wv: [0.73577229 0.         0.35967466 0.         1.         1.
 0.71963326 1.         1.         0.71963326]
___Test Target_ResNet_18 poisoned: False, epoch: 213: Average loss: 0.7012, Accuracy: 7679/10000 (76.7900%)
___Test Target_ResNet_18 poisoned: True, epoch: 213: Average loss: 6.6541, Accuracy: 164/9000 (1.8222%)
Done in 174.11526560783386 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:214 choose agents : [17, 33, 77, 11, 80, 54, 44, 35, 68, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   1,  Average loss: 0.0141, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   2,  Average loss: 0.0130, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   4,  Average loss: 0.0035, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.650625228249865.
Norm before scaling: 38.463575695369734. Distance: 9.714403167783907
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.7336, Accuracy: 5033/10000 (50.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.8200, Accuracy: 6764/9000 (75.1556%)
Scaling by  100
Scaled Norm after poisoning: 970.4970698049531, distance: 971.4403288416638
Total norm for 4 adversaries is: 970.4970698049531. distance: 971.4403288416638
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   1,  Average loss: 0.0150, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   2,  Average loss: 0.0138, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   3,  Average loss: 0.0075, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   5,  Average loss: 0.0025, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.650625228249865.
Norm before scaling: 38.81398132740797. Distance: 10.86948088107355
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.8263, Accuracy: 4862/10000 (48.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 0.2976, Accuracy: 8148/9000 (90.5333%)
Scaling by  100
Scaled Norm after poisoning: 1086.2572209196126, distance: 1086.9480783367712
Total norm for 4 adversaries is: 1086.2572209196126. distance: 1086.9480783367712
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   1,  Average loss: 0.0086, Accuracy: 431/496 (86.8952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.650625228249865.
Norm before scaling: 37.91505977593204. Distance: 6.536745232799378
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.1230, Accuracy: 6314/10000 (63.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 3.6527, Accuracy: 778/9000 (8.6444%)
Scaling by  100
Scaled Norm after poisoning: 653.0186875197371, distance: 653.6745415342409
Total norm for 4 adversaries is: 653.0186875197371. distance: 653.6745415342409
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 214, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.650625228249865.
Norm before scaling: 37.81357501054516. Distance: 6.419491364957634
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.2046, Accuracy: 6311/10000 (63.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: 4.6936, Accuracy: 114/9000 (1.2667%)
Scaling by  100
Scaled Norm after poisoning: 640.800256515242, distance: 641.9491558916485
Total norm for 4 adversaries is: 640.800256515242. distance: 641.9491558916485
___Test Local_ResNet_18 poisoned: True, epoch: 214: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   1,  Average loss: 0.0060, Accuracy: 317/363 (87.3278%)
___Train Local_ResNet_18,  epoch 214, local model 80, internal_epoch   2,  Average loss: 0.0014, Accuracy: 354/363 (97.5207%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.6889, Accuracy: 3629/10000 (36.2900%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   1,  Average loss: 0.0036, Accuracy: 408/440 (92.7273%)
___Train Local_ResNet_18,  epoch 214, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 432/440 (98.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.0510, Accuracy: 4574/10000 (45.7400%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0050, Accuracy: 393/436 (90.1376%)
___Train Local_ResNet_18,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0023, Accuracy: 416/436 (95.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.0096, Accuracy: 3929/10000 (39.2900%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   1,  Average loss: 0.0074, Accuracy: 366/419 (87.3508%)
___Train Local_ResNet_18,  epoch 214, local model 35, internal_epoch   2,  Average loss: 0.0035, Accuracy: 393/419 (93.7947%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 4.7482, Accuracy: 3026/10000 (30.2600%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0031, Accuracy: 396/416 (95.1923%)
___Train Local_ResNet_18,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0009, Accuracy: 408/416 (98.0769%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 1.4478, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   1,  Average loss: 0.0035, Accuracy: 509/545 (93.3945%)
___Train Local_ResNet_18,  epoch 214, local model 25, internal_epoch   2,  Average loss: 0.0030, Accuracy: 520/545 (95.4128%)
___Test Local_ResNet_18 poisoned: False, epoch: 214: Average loss: 3.4892, Accuracy: 3911/10000 (39.1100%)
time spent on training: 138.04447197914124
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4444208739923632  data num: [526, 527, 496, 546, 363, 440, 436, 419, 416, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03472038078065337
[foolsgold agg] wv: [0.65249512 0.         0.30262358 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 214: Average loss: 0.6983, Accuracy: 7687/10000 (76.8700%)
___Test Target_ResNet_18 poisoned: True, epoch: 214: Average loss: 6.6177, Accuracy: 171/9000 (1.9000%)
Done in 172.7464280128479 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:215 choose agents : [17, 33, 77, 11, 4, 79, 43, 63, 35, 49]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0158, Accuracy: 435/526 (82.6996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   3,  Average loss: 0.0102, Accuracy: 449/526 (85.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   4,  Average loss: 0.0055, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   5,  Average loss: 0.0038, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.64945964450801.
Norm before scaling: 38.51280257153538. Distance: 10.084756251629742
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.6242, Accuracy: 4998/10000 (49.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.4116, Accuracy: 7803/9000 (86.7000%)
Scaling by  100
Scaled Norm after poisoning: 1007.3954970616059, distance: 1008.4755822527385
Total norm for 4 adversaries is: 1007.3954970616059. distance: 1008.4755822527385
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   1,  Average loss: 0.0178, Accuracy: 429/527 (81.4042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   2,  Average loss: 0.0170, Accuracy: 417/527 (79.1271%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   3,  Average loss: 0.0095, Accuracy: 460/527 (87.2865%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   4,  Average loss: 0.0050, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   5,  Average loss: 0.0035, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.64945964450801.
Norm before scaling: 38.84325660889384. Distance: 11.24506185023564
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.9823, Accuracy: 4425/10000 (44.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 0.4721, Accuracy: 7566/9000 (84.0667%)
Scaling by  100
Scaled Norm after poisoning: 1123.573762598611, distance: 1124.5063361315488
Total norm for 4 adversaries is: 1123.573762598611. distance: 1124.5063361315488
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 435/496 (87.7016%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   2,  Average loss: 0.0068, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   3,  Average loss: 0.0042, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   4,  Average loss: 0.0028, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.64945964450801.
Norm before scaling: 37.87619892904382. Distance: 6.472775004096937
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.1496, Accuracy: 6271/10000 (62.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 3.4330, Accuracy: 826/9000 (9.1778%)
Scaling by  100
Scaled Norm after poisoning: 646.4582836502291, distance: 647.2774955534913
Total norm for 4 adversaries is: 646.4582836502291. distance: 647.2774955534913
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   1,  Average loss: 0.0061, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   2,  Average loss: 0.0057, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 215, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.64945964450801.
Norm before scaling: 37.80073260853799. Distance: 6.194648081687695
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.2734, Accuracy: 6261/10000 (62.6100%)
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: 5.4596, Accuracy: 31/9000 (0.3444%)
Scaling by  100
Scaled Norm after poisoning: 618.4319637195348, distance: 619.4647639293134
Total norm for 4 adversaries is: 618.4319637195348. distance: 619.4647639293134
___Test Local_ResNet_18 poisoned: True, epoch: 215: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   1,  Average loss: 0.0050, Accuracy: 501/557 (89.9461%)
___Train Local_ResNet_18,  epoch 215, local model 4, internal_epoch   2,  Average loss: 0.0038, Accuracy: 514/557 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.4711, Accuracy: 3194/10000 (31.9400%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   1,  Average loss: 0.0094, Accuracy: 127/154 (82.4675%)
___Train Local_ResNet_18,  epoch 215, local model 79, internal_epoch   2,  Average loss: 0.0016, Accuracy: 153/154 (99.3506%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.7963, Accuracy: 5558/10000 (55.5800%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   1,  Average loss: 0.0079, Accuracy: 290/345 (84.0580%)
___Train Local_ResNet_18,  epoch 215, local model 43, internal_epoch   2,  Average loss: 0.0026, Accuracy: 329/345 (95.3623%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 5.1068, Accuracy: 3215/10000 (32.1500%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 708/752 (94.1489%)
___Train Local_ResNet_18,  epoch 215, local model 63, internal_epoch   2,  Average loss: 0.0019, Accuracy: 724/752 (96.2766%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 1.3753, Accuracy: 6125/10000 (61.2500%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 370/419 (88.3055%)
___Train Local_ResNet_18,  epoch 215, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 399/419 (95.2267%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 4.9462, Accuracy: 2759/10000 (27.5900%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0033, Accuracy: 401/426 (94.1315%)
___Train Local_ResNet_18,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0019, Accuracy: 412/426 (96.7136%)
___Test Local_ResNet_18 poisoned: False, epoch: 215: Average loss: 2.1358, Accuracy: 5202/10000 (52.0200%)
time spent on training: 140.84051060676575
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4412384161752317  data num: [526, 527, 496, 546, 557, 154, 345, 752, 419, 426]
[foolsgold agg] considering poison per batch poison_fraction: 0.034471751263689974
[foolsgold agg] wv: [1.         0.10845331 0.75269394 0.10845331 1.         0.
 0.         0.05373945 0.86569732 0.86569732]
___Test Target_ResNet_18 poisoned: False, epoch: 215: Average loss: 0.6958, Accuracy: 7691/10000 (76.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 215: Average loss: 6.5681, Accuracy: 174/9000 (1.9333%)
Done in 175.4315767288208 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:216 choose agents : [17, 33, 77, 11, 8, 12, 18, 94, 57, 83]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   1,  Average loss: 0.0146, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   2,  Average loss: 0.0159, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   3,  Average loss: 0.0073, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.648088132587326.
Norm before scaling: 38.43723323078158. Distance: 9.632445787068843
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.9678, Accuracy: 4519/10000 (45.1900%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.3109, Accuracy: 8063/9000 (89.5889%)
Scaling by  100
Scaled Norm after poisoning: 962.2801372261614, distance: 963.2444848012367
Total norm for 4 adversaries is: 962.2801372261614. distance: 963.2444848012367
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   3,  Average loss: 0.0075, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 33, internal_epoch   6,  Average loss: 0.0035, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.648088132587326.
Norm before scaling: 38.70321015836412. Distance: 10.565016948868696
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.0524, Accuracy: 4558/10000 (45.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 0.3497, Accuracy: 7864/9000 (87.3778%)
Scaling by  100
Scaled Norm after poisoning: 1055.7021952236341, distance: 1056.5016564113848
Total norm for 4 adversaries is: 1055.7021952236341. distance: 1056.5016564113848
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   1,  Average loss: 0.0100, Accuracy: 430/496 (86.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.648088132587326.
Norm before scaling: 37.8561360433525. Distance: 6.321889107764319
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.0635, Accuracy: 6505/10000 (65.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 4.0501, Accuracy: 402/9000 (4.4667%)
Scaling by  100
Scaled Norm after poisoning: 631.3908753696081, distance: 632.1889304234929
Total norm for 4 adversaries is: 631.3908753696081. distance: 632.1889304234929
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 216, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.648088132587326.
Norm before scaling: 37.88606125866494. Distance: 6.722051332821979
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.2706, Accuracy: 6091/10000 (60.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: 4.9726, Accuracy: 71/9000 (0.7889%)
Scaling by  100
Scaled Norm after poisoning: 671.2346832516926, distance: 672.2050933308971
Total norm for 4 adversaries is: 671.2346832516926. distance: 672.2050933308971
___Test Local_ResNet_18 poisoned: True, epoch: 216: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   1,  Average loss: 0.0047, Accuracy: 483/534 (90.4494%)
___Train Local_ResNet_18,  epoch 216, local model 8, internal_epoch   2,  Average loss: 0.0066, Accuracy: 474/534 (88.7640%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.6615, Accuracy: 3093/10000 (30.9300%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   1,  Average loss: 0.0061, Accuracy: 862/977 (88.2293%)
___Train Local_ResNet_18,  epoch 216, local model 12, internal_epoch   2,  Average loss: 0.0085, Accuracy: 793/977 (81.1668%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 5.3824, Accuracy: 2834/10000 (28.3400%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   1,  Average loss: 0.0030, Accuracy: 366/386 (94.8187%)
___Train Local_ResNet_18,  epoch 216, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 381/386 (98.7047%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 1.7071, Accuracy: 5611/10000 (56.1100%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   1,  Average loss: 0.0076, Accuracy: 170/203 (83.7438%)
___Train Local_ResNet_18,  epoch 216, local model 94, internal_epoch   2,  Average loss: 0.0009, Accuracy: 200/203 (98.5222%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 3.6730, Accuracy: 3113/10000 (31.1300%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   1,  Average loss: 0.0061, Accuracy: 251/290 (86.5517%)
___Train Local_ResNet_18,  epoch 216, local model 57, internal_epoch   2,  Average loss: 0.0014, Accuracy: 284/290 (97.9310%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 4.3998, Accuracy: 3749/10000 (37.4900%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   1,  Average loss: 0.0029, Accuracy: 341/366 (93.1694%)
___Train Local_ResNet_18,  epoch 216, local model 83, internal_epoch   2,  Average loss: 0.0006, Accuracy: 364/366 (99.4536%)
___Test Local_ResNet_18 poisoned: False, epoch: 216: Average loss: 2.3650, Accuracy: 4756/10000 (47.5600%)
time spent on training: 137.99344682693481
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4318697175840033  data num: [526, 527, 496, 546, 534, 977, 386, 203, 290, 366]
[foolsgold agg] considering poison per batch poison_fraction: 0.033739821686250254
[foolsgold agg] wv: [0.54399164 0.         0.         0.         1.         0.14177281
 1.         0.14177281 0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 216: Average loss: 0.6938, Accuracy: 7695/10000 (76.9500%)
___Test Target_ResNet_18 poisoned: True, epoch: 216: Average loss: 6.5511, Accuracy: 181/9000 (2.0111%)
Done in 171.67865228652954 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:217 choose agents : [17, 33, 77, 11, 37, 22, 38, 65, 29, 18]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   2,  Average loss: 0.0144, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   3,  Average loss: 0.0077, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   4,  Average loss: 0.0047, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   5,  Average loss: 0.0032, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 17, internal_epoch   6,  Average loss: 0.0021, Accuracy: 517/526 (98.2890%), train_poison_data_count: 45
Global model norm: 37.6467976336675.
Norm before scaling: 38.60173879867654. Distance: 10.33531744171865
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.6222, Accuracy: 5013/10000 (50.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.3161, Accuracy: 8053/9000 (89.4778%)
Scaling by  100
Scaled Norm after poisoning: 1032.5718498002936, distance: 1033.5317484238208
Total norm for 4 adversaries is: 1032.5718498002936. distance: 1033.5317484238208
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   1,  Average loss: 0.0128, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   2,  Average loss: 0.0123, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   3,  Average loss: 0.0051, Accuracy: 484/527 (91.8406%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   4,  Average loss: 0.0039, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 33, internal_epoch   6,  Average loss: 0.0018, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.6467976336675.
Norm before scaling: 38.48135360398998. Distance: 9.647267135494577
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.6162, Accuracy: 5135/10000 (51.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 0.1643, Accuracy: 8483/9000 (94.2556%)
Scaling by  100
Scaled Norm after poisoning: 963.9300091292936, distance: 964.7267100065178
Total norm for 4 adversaries is: 963.9300091292936. distance: 964.7267100065178
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   1,  Average loss: 0.0089, Accuracy: 430/496 (86.6935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 467/496 (94.1532%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   5,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.6467976336675.
Norm before scaling: 37.916638943728415. Distance: 6.5427352453669405
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.0921, Accuracy: 6455/10000 (64.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 3.8159, Accuracy: 903/9000 (10.0333%)
Scaling by  100
Scaled Norm after poisoning: 653.6432274184442, distance: 654.2735952948125
Total norm for 4 adversaries is: 653.6432274184442. distance: 654.2735952948125
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   1,  Average loss: 0.0088, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   2,  Average loss: 0.0060, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   3,  Average loss: 0.0044, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 217, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.6467976336675.
Norm before scaling: 37.88699241607781. Distance: 6.917604528367365
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 1.3182, Accuracy: 5932/10000 (59.3200%)
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: 4.4111, Accuracy: 40/9000 (0.4444%)
Scaling by  100
Scaled Norm after poisoning: 690.6364818050087, distance: 691.7604354109882
Total norm for 4 adversaries is: 690.6364818050087. distance: 691.7604354109882
___Test Local_ResNet_18 poisoned: True, epoch: 217: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   1,  Average loss: 0.0084, Accuracy: 621/725 (85.6552%)
___Train Local_ResNet_18,  epoch 217, local model 37, internal_epoch   2,  Average loss: 0.0138, Accuracy: 551/725 (76.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 20.8532, Accuracy: 1724/10000 (17.2400%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   1,  Average loss: 0.0060, Accuracy: 429/494 (86.8421%)
___Train Local_ResNet_18,  epoch 217, local model 22, internal_epoch   2,  Average loss: 0.0033, Accuracy: 452/494 (91.4980%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.2970, Accuracy: 3560/10000 (35.6000%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   1,  Average loss: 0.0025, Accuracy: 720/756 (95.2381%)
___Train Local_ResNet_18,  epoch 217, local model 38, internal_epoch   2,  Average loss: 0.0033, Accuracy: 705/756 (93.2540%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 3.0960, Accuracy: 4421/10000 (44.2100%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   1,  Average loss: 0.0042, Accuracy: 291/314 (92.6752%)
___Train Local_ResNet_18,  epoch 217, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 313/314 (99.6815%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 2.4368, Accuracy: 4212/10000 (42.1200%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   1,  Average loss: 0.0062, Accuracy: 764/848 (90.0943%)
___Train Local_ResNet_18,  epoch 217, local model 29, internal_epoch   2,  Average loss: 0.0068, Accuracy: 743/848 (87.6179%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 13.8598, Accuracy: 1208/10000 (12.0800%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   1,  Average loss: 0.0082, Accuracy: 358/386 (92.7461%)
___Train Local_ResNet_18,  epoch 217, local model 18, internal_epoch   2,  Average loss: 0.0224, Accuracy: 255/386 (66.0622%)
___Test Local_ResNet_18 poisoned: False, epoch: 217: Average loss: 134.9610, Accuracy: 1003/10000 (10.0300%)
time spent on training: 139.01491165161133
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.37290850836596656  data num: [526, 527, 496, 546, 725, 494, 756, 314, 848, 386]
[foolsgold agg] considering poison per batch poison_fraction: 0.029133477216091136
[foolsgold agg] wv: [0.22483583 0.         0.         0.         0.         0.
 1.         0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 217: Average loss: 0.6924, Accuracy: 7698/10000 (76.9800%)
___Test Target_ResNet_18 poisoned: True, epoch: 217: Average loss: 6.5623, Accuracy: 180/9000 (2.0000%)
Done in 173.49866843223572 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:218 choose agents : [17, 33, 77, 11, 53, 15, 7, 29, 86, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   1,  Average loss: 0.0127, Accuracy: 469/526 (89.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   2,  Average loss: 0.0156, Accuracy: 440/526 (83.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   3,  Average loss: 0.0100, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   4,  Average loss: 0.0059, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   5,  Average loss: 0.0049, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 17, internal_epoch   6,  Average loss: 0.0041, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Global model norm: 37.64582162394902.
Norm before scaling: 38.6524319810135. Distance: 10.36861912861483
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.9113, Accuracy: 4386/10000 (43.8600%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.6146, Accuracy: 7232/9000 (80.3556%)
Scaling by  100
Scaled Norm after poisoning: 1036.0643078496623, distance: 1036.8619724919995
Total norm for 4 adversaries is: 1036.0643078496623. distance: 1036.8619724919995
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   1,  Average loss: 0.0149, Accuracy: 432/527 (81.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   2,  Average loss: 0.0123, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   3,  Average loss: 0.0068, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   5,  Average loss: 0.0049, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Global model norm: 37.64582162394902.
Norm before scaling: 38.60725978119271. Distance: 10.168884118900795
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.9119, Accuracy: 4491/10000 (44.9100%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 0.3598, Accuracy: 7892/9000 (87.6889%)
Scaling by  100
Scaled Norm after poisoning: 1016.1053402575935, distance: 1016.8883296606368
Total norm for 4 adversaries is: 1016.1053402575935. distance: 1016.8883296606368
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   1,  Average loss: 0.0102, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   2,  Average loss: 0.0070, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   3,  Average loss: 0.0045, Accuracy: 468/496 (94.3548%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.64582162394902.
Norm before scaling: 37.842000049857795. Distance: 6.284325601088636
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.0753, Accuracy: 6433/10000 (64.3300%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 3.3719, Accuracy: 624/9000 (6.9333%)
Scaling by  100
Scaled Norm after poisoning: 627.5956600391688, distance: 628.432598812315
Total norm for 4 adversaries is: 627.5956600391688. distance: 628.432598812315
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   1,  Average loss: 0.0096, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   3,  Average loss: 0.0032, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 218, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.64582162394902.
Norm before scaling: 37.91279312860634. Distance: 6.930478503508806
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.3925, Accuracy: 5900/10000 (59.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: 5.0958, Accuracy: 46/9000 (0.5111%)
Scaling by  100
Scaled Norm after poisoning: 692.0595846818394, distance: 693.0478203197814
Total norm for 4 adversaries is: 692.0595846818394. distance: 693.0478203197814
___Test Local_ResNet_18 poisoned: True, epoch: 218: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   1,  Average loss: 0.0043, Accuracy: 568/625 (90.8800%)
___Train Local_ResNet_18,  epoch 218, local model 53, internal_epoch   2,  Average loss: 0.0033, Accuracy: 584/625 (93.4400%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 2.4879, Accuracy: 4712/10000 (47.1200%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   1,  Average loss: 0.0112, Accuracy: 285/341 (83.5777%)
___Train Local_ResNet_18,  epoch 218, local model 15, internal_epoch   2,  Average loss: 0.0042, Accuracy: 317/341 (92.9619%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 4.8818, Accuracy: 3112/10000 (31.1200%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   1,  Average loss: 0.0029, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 218, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 351/352 (99.7159%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.1399, Accuracy: 3878/10000 (38.7800%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 771/848 (90.9198%)
___Train Local_ResNet_18,  epoch 218, local model 29, internal_epoch   2,  Average loss: 0.0053, Accuracy: 769/848 (90.6840%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 9.7585, Accuracy: 2062/10000 (20.6200%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   1,  Average loss: 0.0051, Accuracy: 191/212 (90.0943%)
___Train Local_ResNet_18,  epoch 218, local model 86, internal_epoch   2,  Average loss: 0.0012, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 1.5954, Accuracy: 5799/10000 (57.9900%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 260/284 (91.5493%)
___Train Local_ResNet_18,  epoch 218, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 283/284 (99.6479%)
___Test Local_ResNet_18 poisoned: False, epoch: 218: Average loss: 3.0568, Accuracy: 4151/10000 (41.5100%)
time spent on training: 137.57875800132751
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4404036157241959  data num: [526, 527, 496, 546, 625, 341, 352, 848, 212, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.0344065324784528
[foolsgold agg] wv: [0.51995312 0.         0.07896451 0.         1.         1.
 1.         0.44889368 1.         0.44889368]
___Test Target_ResNet_18 poisoned: False, epoch: 218: Average loss: 0.6911, Accuracy: 7706/10000 (77.0600%)
___Test Target_ResNet_18 poisoned: True, epoch: 218: Average loss: 6.5485, Accuracy: 184/9000 (2.0444%)
Done in 171.47352051734924 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:219 choose agents : [17, 33, 77, 11, 81, 8, 28, 1, 93, 53]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   1,  Average loss: 0.0141, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   2,  Average loss: 0.0146, Accuracy: 442/526 (84.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   3,  Average loss: 0.0076, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   4,  Average loss: 0.0040, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   5,  Average loss: 0.0046, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 17, internal_epoch   6,  Average loss: 0.0041, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Global model norm: 37.64466561957185.
Norm before scaling: 38.386495949605276. Distance: 9.5868431851084
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.9174, Accuracy: 4823/10000 (48.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.3856, Accuracy: 7854/9000 (87.2667%)
Scaling by  100
Scaled Norm after poisoning: 957.571048277881, distance: 958.6843523809075
Total norm for 4 adversaries is: 957.571048277881. distance: 958.6843523809075
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   1,  Average loss: 0.0161, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 429/527 (81.4042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   3,  Average loss: 0.0091, Accuracy: 451/527 (85.5787%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   5,  Average loss: 0.0029, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 33, internal_epoch   6,  Average loss: 0.0023, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.64466561957185.
Norm before scaling: 38.85909384950565. Distance: 11.149459866839543
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.9808, Accuracy: 4378/10000 (43.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 0.3833, Accuracy: 8016/9000 (89.0667%)
Scaling by  100
Scaled Norm after poisoning: 1114.1730116997091, distance: 1114.9459628161358
Total norm for 4 adversaries is: 1114.1730116997091. distance: 1114.9459628161358
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   1,  Average loss: 0.0099, Accuracy: 429/496 (86.4919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   2,  Average loss: 0.0074, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   3,  Average loss: 0.0049, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.64466561957185.
Norm before scaling: 37.92511799843624. Distance: 6.651183013091191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.0975, Accuracy: 6399/10000 (63.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 3.5938, Accuracy: 676/9000 (7.5111%)
Scaling by  100
Scaled Norm after poisoning: 664.4509246362744, distance: 665.1182930501911
Total norm for 4 adversaries is: 664.4509246362744. distance: 665.1182930501911
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   3,  Average loss: 0.0030, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 219, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.64466561957185.
Norm before scaling: 37.795933548113844. Distance: 6.183381222165026
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.2668, Accuracy: 6111/10000 (61.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: 5.5476, Accuracy: 43/9000 (0.4778%)
Scaling by  100
Scaled Norm after poisoning: 617.3143192491164, distance: 618.3381204891059
Total norm for 4 adversaries is: 617.3143192491164. distance: 618.3381204891059
___Test Local_ResNet_18 poisoned: True, epoch: 219: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   1,  Average loss: 0.0068, Accuracy: 911/1034 (88.1044%)
___Train Local_ResNet_18,  epoch 219, local model 81, internal_epoch   2,  Average loss: 0.0109, Accuracy: 830/1034 (80.2708%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 6.2787, Accuracy: 2998/10000 (29.9800%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   1,  Average loss: 0.0050, Accuracy: 490/534 (91.7603%)
___Train Local_ResNet_18,  epoch 219, local model 8, internal_epoch   2,  Average loss: 0.0039, Accuracy: 496/534 (92.8839%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.3615, Accuracy: 4461/10000 (44.6100%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   1,  Average loss: 0.0022, Accuracy: 405/423 (95.7447%)
___Train Local_ResNet_18,  epoch 219, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 419/423 (99.0544%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 1.7914, Accuracy: 5720/10000 (57.2000%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   1,  Average loss: 0.0070, Accuracy: 587/641 (91.5757%)
___Train Local_ResNet_18,  epoch 219, local model 1, internal_epoch   2,  Average loss: 0.0150, Accuracy: 536/641 (83.6193%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.9291, Accuracy: 4582/10000 (45.8200%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   1,  Average loss: 0.0036, Accuracy: 536/584 (91.7808%)
___Train Local_ResNet_18,  epoch 219, local model 93, internal_epoch   2,  Average loss: 0.0036, Accuracy: 539/584 (92.2945%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 3.4744, Accuracy: 4073/10000 (40.7300%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   1,  Average loss: 0.0044, Accuracy: 576/625 (92.1600%)
___Train Local_ResNet_18,  epoch 219, local model 53, internal_epoch   2,  Average loss: 0.0027, Accuracy: 590/625 (94.4000%)
___Test Local_ResNet_18 poisoned: False, epoch: 219: Average loss: 2.4512, Accuracy: 4548/10000 (45.4800%)
time spent on training: 138.33903622627258
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35293126684636117  data num: [526, 527, 496, 546, 1034, 534, 423, 641, 584, 625]
[foolsgold agg] considering poison per batch poison_fraction: 0.027572755222371965
[foolsgold agg] wv: [0.63730047 0.         0.19741411 0.         1.         0.99015722
 1.         0.99015722 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 219: Average loss: 0.6878, Accuracy: 7712/10000 (77.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 219: Average loss: 6.5302, Accuracy: 188/9000 (2.0889%)
Done in 173.26083874702454 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:220 choose agents : [17, 33, 77, 11, 12, 50, 10, 18, 39, 62]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   1,  Average loss: 0.0144, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   2,  Average loss: 0.0135, Accuracy: 453/526 (86.1217%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   3,  Average loss: 0.0083, Accuracy: 469/526 (89.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 17, internal_epoch   6,  Average loss: 0.0043, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.64444187268886.
Norm before scaling: 38.44558159451649. Distance: 9.689952515287944
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.6234, Accuracy: 4846/10000 (48.4600%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.1225, Accuracy: 8577/9000 (95.3000%)
Scaling by  100
Scaled Norm after poisoning: 968.0264394633031, distance: 968.995259276329
Total norm for 4 adversaries is: 968.0264394633031. distance: 968.995259276329
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   1,  Average loss: 0.0129, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   2,  Average loss: 0.0121, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   3,  Average loss: 0.0078, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   5,  Average loss: 0.0037, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 33, internal_epoch   6,  Average loss: 0.0022, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.64444187268886.
Norm before scaling: 38.53022035830284. Distance: 9.904854757446637
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.7735, Accuracy: 4971/10000 (49.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 0.5134, Accuracy: 7671/9000 (85.2333%)
Scaling by  100
Scaled Norm after poisoning: 989.654137817854, distance: 990.4853923708315
Total norm for 4 adversaries is: 989.654137817854. distance: 990.4853923708315
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   1,  Average loss: 0.0086, Accuracy: 442/496 (89.1129%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   3,  Average loss: 0.0040, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.64444187268886.
Norm before scaling: 37.81930465631937. Distance: 6.080287989772707
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.0507, Accuracy: 6604/10000 (66.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 3.7675, Accuracy: 713/9000 (7.9222%)
Scaling by  100
Scaled Norm after poisoning: 607.2385497067853, distance: 608.02880791127
Total norm for 4 adversaries is: 607.2385497067853. distance: 608.02880791127
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   1,  Average loss: 0.0092, Accuracy: 476/546 (87.1795%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 220, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.64444187268886.
Norm before scaling: 37.880776748508104. Distance: 6.768156991837742
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.5011, Accuracy: 5579/10000 (55.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: 4.4168, Accuracy: 151/9000 (1.6778%)
Scaling by  100
Scaled Norm after poisoning: 675.7963589351455, distance: 676.8157753406757
Total norm for 4 adversaries is: 675.7963589351455. distance: 676.8157753406757
___Test Local_ResNet_18 poisoned: True, epoch: 220: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   1,  Average loss: 0.0048, Accuracy: 883/977 (90.3787%)
___Train Local_ResNet_18,  epoch 220, local model 12, internal_epoch   2,  Average loss: 0.0092, Accuracy: 807/977 (82.5998%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 9.7097, Accuracy: 2118/10000 (21.1800%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   1,  Average loss: 0.0025, Accuracy: 386/401 (96.2594%)
___Train Local_ResNet_18,  epoch 220, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 390/401 (97.2569%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 2.7052, Accuracy: 4557/10000 (45.5700%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   1,  Average loss: 0.0048, Accuracy: 685/752 (91.0904%)
___Train Local_ResNet_18,  epoch 220, local model 10, internal_epoch   2,  Average loss: 0.0045, Accuracy: 697/752 (92.6862%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 6.1489, Accuracy: 2676/10000 (26.7600%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   1,  Average loss: 0.0034, Accuracy: 364/386 (94.3005%)
___Train Local_ResNet_18,  epoch 220, local model 18, internal_epoch   2,  Average loss: 0.0021, Accuracy: 374/386 (96.8912%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.8236, Accuracy: 5426/10000 (54.2600%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   1,  Average loss: 0.0069, Accuracy: 185/217 (85.2535%)
___Train Local_ResNet_18,  epoch 220, local model 39, internal_epoch   2,  Average loss: 0.0011, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 3.7357, Accuracy: 3451/10000 (34.5100%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   1,  Average loss: 0.0020, Accuracy: 347/358 (96.9274%)
___Train Local_ResNet_18,  epoch 220, local model 62, internal_epoch   2,  Average loss: 0.0004, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 220: Average loss: 1.3379, Accuracy: 6296/10000 (62.9600%)
time spent on training: 141.43663048744202
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40397223293482454  data num: [526, 527, 496, 546, 977, 401, 752, 386, 217, 358]
[foolsgold agg] considering poison per batch poison_fraction: 0.03156033069803317
[foolsgold agg] wv: [0.94984473 0.00294953 0.4279736  0.00294953 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 220: Average loss: 0.6838, Accuracy: 7721/10000 (77.2100%)
___Test Target_ResNet_18 poisoned: True, epoch: 220: Average loss: 6.4788, Accuracy: 195/9000 (2.1667%)
Done in 176.03226709365845 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:221 choose agents : [17, 33, 77, 11, 65, 87, 12, 74, 4, 7]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   1,  Average loss: 0.0156, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   2,  Average loss: 0.0122, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   5,  Average loss: 0.0048, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 17, internal_epoch   6,  Average loss: 0.0054, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Global model norm: 37.64363929140702.
Norm before scaling: 38.756547140954936. Distance: 10.682709629779314
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.9882, Accuracy: 4695/10000 (46.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.6351, Accuracy: 7329/9000 (81.4333%)
Scaling by  100
Scaled Norm after poisoning: 1067.5723043428954, distance: 1068.2710915306095
Total norm for 4 adversaries is: 1067.5723043428954. distance: 1068.2710915306095
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0156, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0135, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   3,  Average loss: 0.0095, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   4,  Average loss: 0.0044, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.64363929140702.
Norm before scaling: 38.844436651714524. Distance: 11.021716096325827
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.8403, Accuracy: 4657/10000 (46.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 0.1546, Accuracy: 8459/9000 (93.9889%)
Scaling by  100
Scaled Norm after poisoning: 1101.4700404459488, distance: 1102.1717765393923
Total norm for 4 adversaries is: 1101.4700404459488. distance: 1102.1717765393923
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   1,  Average loss: 0.0088, Accuracy: 441/496 (88.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 459/496 (92.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.64363929140702.
Norm before scaling: 37.825557856407585. Distance: 6.217817533734204
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.1110, Accuracy: 6334/10000 (63.3400%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 3.5280, Accuracy: 660/9000 (7.3333%)
Scaling by  100
Scaled Norm after poisoning: 620.9158054841251, distance: 621.7816638499402
Total norm for 4 adversaries is: 620.9158054841251. distance: 621.7816638499402
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   1,  Average loss: 0.0082, Accuracy: 485/546 (88.8278%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   2,  Average loss: 0.0067, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   3,  Average loss: 0.0037, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 221, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.64363929140702.
Norm before scaling: 37.83034509181254. Distance: 6.502376415423177
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 1.3637, Accuracy: 6106/10000 (61.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: 4.6527, Accuracy: 40/9000 (0.4444%)
Scaling by  100
Scaled Norm after poisoning: 649.1587585098117, distance: 650.2376728935351
Total norm for 4 adversaries is: 649.1587585098117. distance: 650.2376728935351
___Test Local_ResNet_18 poisoned: True, epoch: 221: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0048, Accuracy: 275/314 (87.5796%)
___Train Local_ResNet_18,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0014, Accuracy: 306/314 (97.4522%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.6976, Accuracy: 3941/10000 (39.4100%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   1,  Average loss: 0.0092, Accuracy: 327/397 (82.3678%)
___Train Local_ResNet_18,  epoch 221, local model 87, internal_epoch   2,  Average loss: 0.0070, Accuracy: 354/397 (89.1688%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.8305, Accuracy: 3248/10000 (32.4800%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0062, Accuracy: 874/977 (89.4575%)
___Train Local_ResNet_18,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0109, Accuracy: 782/977 (80.0409%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 7.7479, Accuracy: 2593/10000 (25.9300%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   1,  Average loss: 0.0060, Accuracy: 419/469 (89.3390%)
___Train Local_ResNet_18,  epoch 221, local model 74, internal_epoch   2,  Average loss: 0.0037, Accuracy: 438/469 (93.3902%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 3.2277, Accuracy: 3786/10000 (37.8600%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   1,  Average loss: 0.0056, Accuracy: 486/557 (87.2531%)
___Train Local_ResNet_18,  epoch 221, local model 4, internal_epoch   2,  Average loss: 0.0046, Accuracy: 513/557 (92.1005%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 4.5819, Accuracy: 3822/10000 (38.2200%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 335/352 (95.1705%)
___Train Local_ResNet_18,  epoch 221, local model 7, internal_epoch   2,  Average loss: 0.0008, Accuracy: 347/352 (98.5795%)
___Test Local_ResNet_18 poisoned: False, epoch: 221: Average loss: 2.1346, Accuracy: 5037/10000 (50.3700%)
time spent on training: 137.87338423728943
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4059290835109475  data num: [526, 527, 496, 546, 314, 397, 977, 469, 557, 352]
[foolsgold agg] considering poison per batch poison_fraction: 0.03171320964929277
[foolsgold agg] wv: [0.76912335 0.         0.26112225 0.         1.         0.99731952
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 221: Average loss: 0.6810, Accuracy: 7726/10000 (77.2600%)
___Test Target_ResNet_18 poisoned: True, epoch: 221: Average loss: 6.4542, Accuracy: 199/9000 (2.2111%)
Done in 172.68183207511902 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:222 choose agents : [17, 33, 77, 11, 35, 30, 72, 51, 63, 46]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   1,  Average loss: 0.0146, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   2,  Average loss: 0.0146, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   4,  Average loss: 0.0050, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 17, internal_epoch   6,  Average loss: 0.0026, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.6433052828413.
Norm before scaling: 38.60933389819747. Distance: 10.261352207243144
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.6661, Accuracy: 5000/10000 (50.0000%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.7232, Accuracy: 7322/9000 (81.3556%)
Scaling by  100
Scaled Norm after poisoning: 1025.2840460087145, distance: 1026.135225006919
Total norm for 4 adversaries is: 1025.2840460087145. distance: 1026.135225006919
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   1,  Average loss: 0.0132, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   2,  Average loss: 0.0124, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   3,  Average loss: 0.0074, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   5,  Average loss: 0.0042, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.6433052828413.
Norm before scaling: 38.61456612208501. Distance: 10.160586514101777
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.7864, Accuracy: 4816/10000 (48.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 0.3505, Accuracy: 8128/9000 (90.3111%)
Scaling by  100
Scaled Norm after poisoning: 1015.320208111707, distance: 1016.0586535727158
Total norm for 4 adversaries is: 1015.320208111707. distance: 1016.0586535727158
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   1,  Average loss: 0.0101, Accuracy: 434/496 (87.5000%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   2,  Average loss: 0.0079, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   4,  Average loss: 0.0023, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   5,  Average loss: 0.0014, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.6433052828413.
Norm before scaling: 37.894841904522444. Distance: 6.5651051028133836
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.0975, Accuracy: 6356/10000 (63.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 3.5415, Accuracy: 582/9000 (6.4667%)
Scaling by  100
Scaled Norm after poisoning: 655.7538124174346, distance: 656.5105911179195
Total norm for 4 adversaries is: 655.7538124174346. distance: 656.5105911179195
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 478/546 (87.5458%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   3,  Average loss: 0.0039, Accuracy: 521/546 (95.4212%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 222, local model 11, internal_epoch   6,  Average loss: 0.0005, Accuracy: 545/546 (99.8168%), train_poison_data_count: 45
Global model norm: 37.6433052828413.
Norm before scaling: 37.96953767187092. Distance: 7.239173171319063
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.2418, Accuracy: 6072/10000 (60.7200%)
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: 4.4730, Accuracy: 72/9000 (0.8000%)
Scaling by  100
Scaled Norm after poisoning: 722.979555381755, distance: 723.9173165838762
Total norm for 4 adversaries is: 722.979555381755. distance: 723.9173165838762
___Test Local_ResNet_18 poisoned: True, epoch: 222: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   1,  Average loss: 0.0077, Accuracy: 363/419 (86.6348%)
___Train Local_ResNet_18,  epoch 222, local model 35, internal_epoch   2,  Average loss: 0.0025, Accuracy: 400/419 (95.4654%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 3.3048, Accuracy: 3940/10000 (39.4000%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   1,  Average loss: 0.0058, Accuracy: 299/337 (88.7240%)
___Train Local_ResNet_18,  epoch 222, local model 30, internal_epoch   2,  Average loss: 0.0054, Accuracy: 309/337 (91.6914%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 5.2340, Accuracy: 2747/10000 (27.4700%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   1,  Average loss: 0.0081, Accuracy: 525/618 (84.9515%)
___Train Local_ResNet_18,  epoch 222, local model 72, internal_epoch   2,  Average loss: 0.0053, Accuracy: 547/618 (88.5113%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 8.4272, Accuracy: 2723/10000 (27.2300%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   1,  Average loss: 0.0042, Accuracy: 442/479 (92.2756%)
___Train Local_ResNet_18,  epoch 222, local model 51, internal_epoch   2,  Average loss: 0.0020, Accuracy: 460/479 (96.0334%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 6.4766, Accuracy: 2564/10000 (25.6400%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 714/752 (94.9468%)
___Train Local_ResNet_18,  epoch 222, local model 63, internal_epoch   2,  Average loss: 0.0017, Accuracy: 728/752 (96.8085%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.4316, Accuracy: 6092/10000 (60.9200%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 588/601 (97.8369%)
___Train Local_ResNet_18,  epoch 222, local model 46, internal_epoch   2,  Average loss: 0.0008, Accuracy: 594/601 (98.8353%)
___Test Local_ResNet_18 poisoned: False, epoch: 222: Average loss: 1.8096, Accuracy: 5519/10000 (55.1900%)
time spent on training: 137.08307576179504
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39520845123561593  data num: [526, 527, 496, 546, 419, 337, 618, 479, 752, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.030875660252782496
[foolsgold agg] wv: [0.77055894 0.         0.22757432 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 222: Average loss: 0.6784, Accuracy: 7740/10000 (77.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 222: Average loss: 6.4114, Accuracy: 207/9000 (2.3000%)
Done in 173.18576288223267 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:223 choose agents : [17, 33, 77, 11, 54, 95, 26, 2, 82, 45]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   1,  Average loss: 0.0138, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   2,  Average loss: 0.0135, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   3,  Average loss: 0.0097, Accuracy: 459/526 (87.2624%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   4,  Average loss: 0.0058, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.642671306975544.
Norm before scaling: 38.956518730021294. Distance: 11.339348561785375
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.9575, Accuracy: 4507/10000 (45.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.3131, Accuracy: 8061/9000 (89.5667%)
Scaling by  100
Scaled Norm after poisoning: 1133.3275673872934, distance: 1133.9349628616274
Total norm for 4 adversaries is: 1133.3275673872934. distance: 1133.9349628616274
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   1,  Average loss: 0.0161, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   2,  Average loss: 0.0125, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   3,  Average loss: 0.0075, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   5,  Average loss: 0.0030, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 33, internal_epoch   6,  Average loss: 0.0017, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Global model norm: 37.642671306975544.
Norm before scaling: 38.843479735584324. Distance: 10.90222618397736
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.8583, Accuracy: 4924/10000 (49.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 0.4729, Accuracy: 7865/9000 (87.3889%)
Scaling by  100
Scaled Norm after poisoning: 1089.6334245974654, distance: 1090.2225690197392
Total norm for 4 adversaries is: 1089.6334245974654. distance: 1090.2225690197392
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   1,  Average loss: 0.0081, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   2,  Average loss: 0.0062, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   3,  Average loss: 0.0042, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.642671306975544.
Norm before scaling: 37.86319238905543. Distance: 6.346377575538571
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.0661, Accuracy: 6426/10000 (64.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 3.5904, Accuracy: 1236/9000 (13.7333%)
Scaling by  100
Scaled Norm after poisoning: 633.8923163676935, distance: 634.6376919156315
Total norm for 4 adversaries is: 633.8923163676935. distance: 634.6376919156315
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   2,  Average loss: 0.0056, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   5,  Average loss: 0.0025, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 223, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.642671306975544.
Norm before scaling: 37.90530643405188. Distance: 6.710583643082809
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 1.6476, Accuracy: 5802/10000 (58.0200%)
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: 5.9872, Accuracy: 4/9000 (0.0444%)
Scaling by  100
Scaled Norm after poisoning: 670.2367119160215, distance: 671.0583990980218
Total norm for 4 adversaries is: 670.2367119160215. distance: 671.0583990980218
___Test Local_ResNet_18 poisoned: True, epoch: 223: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   1,  Average loss: 0.0035, Accuracy: 408/440 (92.7273%)
___Train Local_ResNet_18,  epoch 223, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 432/440 (98.1818%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.6879, Accuracy: 4484/10000 (44.8400%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   1,  Average loss: 0.0087, Accuracy: 465/569 (81.7223%)
___Train Local_ResNet_18,  epoch 223, local model 95, internal_epoch   2,  Average loss: 0.0059, Accuracy: 502/569 (88.2250%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 11.6299, Accuracy: 1933/10000 (19.3300%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   1,  Average loss: 0.0038, Accuracy: 432/468 (92.3077%)
___Train Local_ResNet_18,  epoch 223, local model 26, internal_epoch   2,  Average loss: 0.0037, Accuracy: 434/468 (92.7350%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.0643, Accuracy: 5184/10000 (51.8400%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   1,  Average loss: 0.0080, Accuracy: 396/461 (85.9002%)
___Train Local_ResNet_18,  epoch 223, local model 2, internal_epoch   2,  Average loss: 0.0099, Accuracy: 387/461 (83.9479%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 7.6030, Accuracy: 2204/10000 (22.0400%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0025, Accuracy: 582/601 (96.8386%)
___Train Local_ResNet_18,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0044, Accuracy: 556/601 (92.5125%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 2.8646, Accuracy: 4407/10000 (44.0700%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   1,  Average loss: 0.0071, Accuracy: 462/529 (87.3346%)
___Train Local_ResNet_18,  epoch 223, local model 45, internal_epoch   2,  Average loss: 0.0055, Accuracy: 475/529 (89.7921%)
___Test Local_ResNet_18 poisoned: False, epoch: 223: Average loss: 4.7967, Accuracy: 3046/10000 (30.4600%)
time spent on training: 139.9749779701233
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4057718380786364  data num: [526, 527, 496, 546, 440, 569, 468, 461, 601, 529]
[foolsgold agg] considering poison per batch poison_fraction: 0.03170092484989347
[foolsgold agg] wv: [0.58570188 0.         0.         0.         1.         0.80441101
 0.47884111 0.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 223: Average loss: 0.6778, Accuracy: 7742/10000 (77.4200%)
___Test Target_ResNet_18 poisoned: True, epoch: 223: Average loss: 6.3858, Accuracy: 212/9000 (2.3556%)
Done in 173.89728832244873 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:224 choose agents : [17, 33, 77, 11, 0, 34, 62, 66, 95, 10]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   1,  Average loss: 0.0141, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   2,  Average loss: 0.0156, Accuracy: 428/526 (81.3688%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   3,  Average loss: 0.0100, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   4,  Average loss: 0.0065, Accuracy: 488/526 (92.7757%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   5,  Average loss: 0.0035, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 17, internal_epoch   6,  Average loss: 0.0032, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.641730862750585.
Norm before scaling: 39.41231955388045. Distance: 12.795427960196186
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.9068, Accuracy: 4445/10000 (44.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.1828, Accuracy: 8388/9000 (93.2000%)
Scaling by  100
Scaled Norm after poisoning: 1279.0301012876905, distance: 1279.5428871280556
Total norm for 4 adversaries is: 1279.0301012876905. distance: 1279.5428871280556
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   1,  Average loss: 0.0144, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   2,  Average loss: 0.0138, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   3,  Average loss: 0.0066, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   4,  Average loss: 0.0038, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 507/527 (96.2049%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.641730862750585.
Norm before scaling: 38.37600199730132. Distance: 9.429965011191966
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.9015, Accuracy: 4677/10000 (46.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 0.4683, Accuracy: 7800/9000 (86.6667%)
Scaling by  100
Scaled Norm after poisoning: 941.9918723110088, distance: 942.9964872681128
Total norm for 4 adversaries is: 941.9918723110088. distance: 942.9964872681128
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   1,  Average loss: 0.0092, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   2,  Average loss: 0.0061, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.641730862750585.
Norm before scaling: 37.80928285642545. Distance: 6.15970603637786
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.0683, Accuracy: 6508/10000 (65.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 3.4501, Accuracy: 885/9000 (9.8333%)
Scaling by  100
Scaled Norm after poisoning: 615.0663582086082, distance: 615.9705502294732
Total norm for 4 adversaries is: 615.0663582086082. distance: 615.9705502294732
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   1,  Average loss: 0.0075, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 224, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.641730862750585.
Norm before scaling: 37.78477967641617. Distance: 6.232027993566593
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.2697, Accuracy: 6111/10000 (61.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: 5.0611, Accuracy: 162/9000 (1.8000%)
Scaling by  100
Scaled Norm after poisoning: 622.0882925678637, distance: 623.2028161040353
Total norm for 4 adversaries is: 622.0882925678637. distance: 623.2028161040353
___Test Local_ResNet_18 poisoned: True, epoch: 224: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   1,  Average loss: 0.0072, Accuracy: 313/367 (85.2861%)
___Train Local_ResNet_18,  epoch 224, local model 0, internal_epoch   2,  Average loss: 0.0026, Accuracy: 349/367 (95.0954%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 5.2838, Accuracy: 2539/10000 (25.3900%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0057, Accuracy: 309/349 (88.5387%)
___Train Local_ResNet_18,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0032, Accuracy: 331/349 (94.8424%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.3698, Accuracy: 3732/10000 (37.3200%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   1,  Average loss: 0.0019, Accuracy: 345/358 (96.3687%)
___Train Local_ResNet_18,  epoch 224, local model 62, internal_epoch   2,  Average loss: 0.0006, Accuracy: 357/358 (99.7207%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 1.1650, Accuracy: 6607/10000 (66.0700%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   1,  Average loss: 0.0031, Accuracy: 526/555 (94.7748%)
___Train Local_ResNet_18,  epoch 224, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 547/555 (98.5586%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 3.2300, Accuracy: 4170/10000 (41.7000%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   1,  Average loss: 0.0100, Accuracy: 470/569 (82.6011%)
___Train Local_ResNet_18,  epoch 224, local model 95, internal_epoch   2,  Average loss: 0.0063, Accuracy: 505/569 (88.7522%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 6.8150, Accuracy: 1878/10000 (18.7800%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   1,  Average loss: 0.0038, Accuracy: 700/752 (93.0851%)
___Train Local_ResNet_18,  epoch 224, local model 10, internal_epoch   2,  Average loss: 0.0029, Accuracy: 713/752 (94.8138%)
___Test Local_ResNet_18 poisoned: False, epoch: 224: Average loss: 4.2483, Accuracy: 3293/10000 (32.9300%)
time spent on training: 138.40354895591736
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41526263627353815  data num: [526, 527, 496, 546, 367, 349, 358, 555, 569, 752]
[foolsgold agg] considering poison per batch poison_fraction: 0.03244239345887017
[foolsgold agg] wv: [0.65729826 0.         0.10906224 0.         0.42253994 1.
 1.         1.         0.85968933 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 224: Average loss: 0.6769, Accuracy: 7744/10000 (77.4400%)
___Test Target_ResNet_18 poisoned: True, epoch: 224: Average loss: 6.3462, Accuracy: 216/9000 (2.4000%)
Done in 172.80700850486755 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:225 choose agents : [17, 33, 77, 11, 12, 38, 41, 4, 68, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   1,  Average loss: 0.0136, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   2,  Average loss: 0.0128, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   3,  Average loss: 0.0088, Accuracy: 457/526 (86.8821%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   4,  Average loss: 0.0060, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   5,  Average loss: 0.0043, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 17, internal_epoch   6,  Average loss: 0.0042, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Global model norm: 37.6406752671935.
Norm before scaling: 38.53975220470417. Distance: 9.976428671038565
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.7162, Accuracy: 4806/10000 (48.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.4150, Accuracy: 7752/9000 (86.1333%)
Scaling by  100
Scaled Norm after poisoning: 996.7971207823585, distance: 997.6428469146662
Total norm for 4 adversaries is: 996.7971207823585. distance: 997.6428469146662
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   1,  Average loss: 0.0127, Accuracy: 438/527 (83.1120%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   2,  Average loss: 0.0134, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   3,  Average loss: 0.0064, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.6406752671935.
Norm before scaling: 38.70256831200369. Distance: 10.482942440667863
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.8821, Accuracy: 4713/10000 (47.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 0.3760, Accuracy: 7914/9000 (87.9333%)
Scaling by  100
Scaled Norm after poisoning: 1047.5950434208821, distance: 1048.294209656812
Total norm for 4 adversaries is: 1047.5950434208821. distance: 1048.294209656812
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   1,  Average loss: 0.0095, Accuracy: 437/496 (88.1048%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 77, internal_epoch   6,  Average loss: 0.0016, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.6406752671935.
Norm before scaling: 37.84657716782738. Distance: 6.340392177738637
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.0352, Accuracy: 6597/10000 (65.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 3.5657, Accuracy: 697/9000 (7.7444%)
Scaling by  100
Scaled Norm after poisoning: 633.2114575716394, distance: 634.0392338018208
Total norm for 4 adversaries is: 633.2114575716394. distance: 634.0392338018208
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 495/546 (90.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 508/546 (93.0403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   5,  Average loss: 0.0006, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 225, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.6406752671935.
Norm before scaling: 37.85483973815716. Distance: 6.553459698120725
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.3876, Accuracy: 5911/10000 (59.1100%)
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: 4.8668, Accuracy: 83/9000 (0.9222%)
Scaling by  100
Scaled Norm after poisoning: 654.3830825670847, distance: 655.3459487171642
Total norm for 4 adversaries is: 654.3830825670847. distance: 655.3459487171642
___Test Local_ResNet_18 poisoned: True, epoch: 225: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   1,  Average loss: 0.0054, Accuracy: 880/977 (90.0716%)
___Train Local_ResNet_18,  epoch 225, local model 12, internal_epoch   2,  Average loss: 0.0104, Accuracy: 787/977 (80.5527%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 13.5517, Accuracy: 2412/10000 (24.1200%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   1,  Average loss: 0.0029, Accuracy: 715/756 (94.5767%)
___Train Local_ResNet_18,  epoch 225, local model 38, internal_epoch   2,  Average loss: 0.0029, Accuracy: 711/756 (94.0476%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 2.2731, Accuracy: 5107/10000 (51.0700%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   1,  Average loss: 0.0081, Accuracy: 441/513 (85.9649%)
___Train Local_ResNet_18,  epoch 225, local model 41, internal_epoch   2,  Average loss: 0.0039, Accuracy: 477/513 (92.9825%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 18.1082, Accuracy: 1101/10000 (11.0100%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0067, Accuracy: 476/557 (85.4578%)
___Train Local_ResNet_18,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0042, Accuracy: 514/557 (92.2801%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 4.6283, Accuracy: 3264/10000 (32.6400%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   1,  Average loss: 0.0027, Accuracy: 397/416 (95.4327%)
___Train Local_ResNet_18,  epoch 225, local model 68, internal_epoch   2,  Average loss: 0.0014, Accuracy: 405/416 (97.3558%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 1.4317, Accuracy: 6085/10000 (60.8500%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   1,  Average loss: 0.0050, Accuracy: 275/299 (91.9732%)
___Train Local_ResNet_18,  epoch 225, local model 55, internal_epoch   2,  Average loss: 0.0011, Accuracy: 293/299 (97.9933%)
___Test Local_ResNet_18 poisoned: False, epoch: 225: Average loss: 7.3226, Accuracy: 2343/10000 (23.4300%)
time spent on training: 137.51513147354126
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3732406912524497  data num: [526, 527, 496, 546, 977, 756, 513, 557, 416, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.029159429004097633
[foolsgold agg] wv: [0.50522113 0.         0.         0.         0.         0.50732002
 0.         0.50732002 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 225: Average loss: 0.6763, Accuracy: 7747/10000 (77.4700%)
___Test Target_ResNet_18 poisoned: True, epoch: 225: Average loss: 6.3360, Accuracy: 218/9000 (2.4222%)
Done in 171.93739104270935 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:226 choose agents : [17, 33, 77, 11, 30, 39, 10, 64, 23, 60]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   1,  Average loss: 0.0129, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   2,  Average loss: 0.0132, Accuracy: 430/526 (81.7490%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   3,  Average loss: 0.0100, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   4,  Average loss: 0.0044, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   5,  Average loss: 0.0042, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 17, internal_epoch   6,  Average loss: 0.0019, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.63926127407142.
Norm before scaling: 38.60861619043896. Distance: 10.067902625127191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.9461, Accuracy: 4616/10000 (46.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.2556, Accuracy: 8185/9000 (90.9444%)
Scaling by  100
Scaled Norm after poisoning: 1006.1303344994624, distance: 1006.7903828503727
Total norm for 4 adversaries is: 1006.1303344994624. distance: 1006.7903828503727
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   1,  Average loss: 0.0134, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   2,  Average loss: 0.0102, Accuracy: 458/527 (86.9070%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   3,  Average loss: 0.0061, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   4,  Average loss: 0.0046, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   5,  Average loss: 0.0038, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.63926127407142.
Norm before scaling: 38.412679359124056. Distance: 9.42973725843852
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.0241, Accuracy: 4350/10000 (43.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 0.3857, Accuracy: 7996/9000 (88.8444%)
Scaling by  100
Scaled Norm after poisoning: 942.1285740279826, distance: 942.973621052042
Total norm for 4 adversaries is: 942.1285740279826. distance: 942.973621052042
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   1,  Average loss: 0.0092, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 456/496 (91.9355%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.63926127407142.
Norm before scaling: 37.84550954569693. Distance: 6.248526742864979
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.0508, Accuracy: 6531/10000 (65.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 3.7511, Accuracy: 644/9000 (7.1556%)
Scaling by  100
Scaled Norm after poisoning: 624.1073625587187, distance: 624.8526076203891
Total norm for 4 adversaries is: 624.1073625587187. distance: 624.8526076203891
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   1,  Average loss: 0.0089, Accuracy: 488/546 (89.3773%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   2,  Average loss: 0.0059, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   3,  Average loss: 0.0048, Accuracy: 520/546 (95.2381%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   4,  Average loss: 0.0023, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 226, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.63926127407142.
Norm before scaling: 37.855000972563886. Distance: 6.776831809285065
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 1.2180, Accuracy: 6209/10000 (62.0900%)
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: 4.2094, Accuracy: 76/9000 (0.8444%)
Scaling by  100
Scaled Norm after poisoning: 676.5407415669806, distance: 677.6832316798166
Total norm for 4 adversaries is: 676.5407415669806. distance: 677.6832316798166
___Test Local_ResNet_18 poisoned: True, epoch: 226: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   1,  Average loss: 0.0051, Accuracy: 299/337 (88.7240%)
___Train Local_ResNet_18,  epoch 226, local model 30, internal_epoch   2,  Average loss: 0.0027, Accuracy: 324/337 (96.1424%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.2999, Accuracy: 2970/10000 (29.7000%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   1,  Average loss: 0.0068, Accuracy: 182/217 (83.8710%)
___Train Local_ResNet_18,  epoch 226, local model 39, internal_epoch   2,  Average loss: 0.0016, Accuracy: 210/217 (96.7742%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.5973, Accuracy: 2881/10000 (28.8100%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   1,  Average loss: 0.0043, Accuracy: 684/752 (90.9574%)
___Train Local_ResNet_18,  epoch 226, local model 10, internal_epoch   2,  Average loss: 0.0032, Accuracy: 698/752 (92.8191%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 4.5071, Accuracy: 3640/10000 (36.4000%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   1,  Average loss: 0.0050, Accuracy: 611/686 (89.0671%)
___Train Local_ResNet_18,  epoch 226, local model 64, internal_epoch   2,  Average loss: 0.0040, Accuracy: 626/686 (91.2536%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 3.9469, Accuracy: 3867/10000 (38.6700%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0040, Accuracy: 221/248 (89.1129%)
___Train Local_ResNet_18,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0008, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.2292, Accuracy: 4520/10000 (45.2000%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   1,  Average loss: 0.0051, Accuracy: 256/284 (90.1408%)
___Train Local_ResNet_18,  epoch 226, local model 60, internal_epoch   2,  Average loss: 0.0010, Accuracy: 281/284 (98.9437%)
___Test Local_ResNet_18 poisoned: False, epoch: 226: Average loss: 2.6749, Accuracy: 4401/10000 (44.0100%)
time spent on training: 136.91058039665222
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4535613769214116  data num: [526, 527, 496, 546, 337, 217, 752, 686, 248, 284]
[foolsgold agg] considering poison per batch poison_fraction: 0.03543448257198528
[foolsgold agg] wv: [0.49176666 0.         0.         0.         1.         0.
 1.         1.         0.15032357 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 226: Average loss: 0.6753, Accuracy: 7752/10000 (77.5200%)
___Test Target_ResNet_18 poisoned: True, epoch: 226: Average loss: 6.3079, Accuracy: 220/9000 (2.4444%)
Done in 171.6103823184967 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:227 choose agents : [17, 33, 77, 11, 23, 34, 52, 92, 57, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   1,  Average loss: 0.0152, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   2,  Average loss: 0.0161, Accuracy: 440/526 (83.6502%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   3,  Average loss: 0.0081, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   4,  Average loss: 0.0058, Accuracy: 494/526 (93.9163%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   5,  Average loss: 0.0050, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 17, internal_epoch   6,  Average loss: 0.0038, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 37.63821371739017.
Norm before scaling: 38.796785327624924. Distance: 10.917181182462034
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.0461, Accuracy: 3976/10000 (39.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.0580, Accuracy: 8876/9000 (98.6222%)
Scaling by  100
Scaled Norm after poisoning: 1090.9638513718041, distance: 1091.7179695324246
Total norm for 4 adversaries is: 1090.9638513718041. distance: 1091.7179695324246
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0170, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0120, Accuracy: 455/527 (86.3378%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   3,  Average loss: 0.0058, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   4,  Average loss: 0.0035, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.63821371739017.
Norm before scaling: 38.578392377060474. Distance: 10.182508497864465
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.8029, Accuracy: 4804/10000 (48.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 0.6877, Accuracy: 7229/9000 (80.3222%)
Scaling by  100
Scaled Norm after poisoning: 1017.3733643554858, distance: 1018.2506444878884
Total norm for 4 adversaries is: 1017.3733643554858. distance: 1018.2506444878884
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0083, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   3,  Average loss: 0.0035, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   5,  Average loss: 0.0015, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Global model norm: 37.63821371739017.
Norm before scaling: 37.811525039083655. Distance: 6.089808358119576
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.0530, Accuracy: 6403/10000 (64.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 3.1385, Accuracy: 1065/9000 (11.8333%)
Scaling by  100
Scaled Norm after poisoning: 608.1721847059433, distance: 608.9808084003962
Total norm for 4 adversaries is: 608.1721847059433. distance: 608.9808084003962
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 487/546 (89.1941%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   3,  Average loss: 0.0031, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   4,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 227, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63821371739017.
Norm before scaling: 37.857395222688986. Distance: 6.627508875993089
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 1.2807, Accuracy: 6145/10000 (61.4500%)
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: 4.2559, Accuracy: 351/9000 (3.9000%)
Scaling by  100
Scaled Norm after poisoning: 661.7534945128738, distance: 662.7508487357825
Total norm for 4 adversaries is: 661.7534945128738. distance: 662.7508487357825
___Test Local_ResNet_18 poisoned: True, epoch: 227: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   1,  Average loss: 0.0041, Accuracy: 224/248 (90.3226%)
___Train Local_ResNet_18,  epoch 227, local model 23, internal_epoch   2,  Average loss: 0.0010, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 2.3803, Accuracy: 4398/10000 (43.9800%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   1,  Average loss: 0.0052, Accuracy: 310/349 (88.8252%)
___Train Local_ResNet_18,  epoch 227, local model 34, internal_epoch   2,  Average loss: 0.0016, Accuracy: 338/349 (96.8481%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 4.3714, Accuracy: 3594/10000 (35.9400%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   1,  Average loss: 0.0080, Accuracy: 183/214 (85.5140%)
___Train Local_ResNet_18,  epoch 227, local model 52, internal_epoch   2,  Average loss: 0.0018, Accuracy: 208/214 (97.1963%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.7675, Accuracy: 3537/10000 (35.3700%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0063, Accuracy: 696/796 (87.4372%)
___Train Local_ResNet_18,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0086, Accuracy: 670/796 (84.1709%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 7.0226, Accuracy: 2358/10000 (23.5800%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   1,  Average loss: 0.0056, Accuracy: 254/290 (87.5862%)
___Train Local_ResNet_18,  epoch 227, local model 57, internal_epoch   2,  Average loss: 0.0009, Accuracy: 287/290 (98.9655%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.5764, Accuracy: 4227/10000 (42.2700%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 422/469 (89.9787%)
___Train Local_ResNet_18,  epoch 227, local model 74, internal_epoch   2,  Average loss: 0.0025, Accuracy: 450/469 (95.9488%)
___Test Local_ResNet_18 poisoned: False, epoch: 227: Average loss: 3.5065, Accuracy: 3881/10000 (38.8100%)
time spent on training: 137.2771279811859
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4696256444743331  data num: [526, 527, 496, 546, 248, 349, 214, 796, 290, 469]
[foolsgold agg] considering poison per batch poison_fraction: 0.036689503474557274
[foolsgold agg] wv: [0.79609772 0.         0.         0.         1.         1.
 1.         1.         0.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 227: Average loss: 0.6744, Accuracy: 7757/10000 (77.5700%)
___Test Target_ResNet_18 poisoned: True, epoch: 227: Average loss: 6.2782, Accuracy: 230/9000 (2.5556%)
Done in 171.49436807632446 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:228 choose agents : [17, 33, 77, 11, 67, 16, 64, 30, 35, 81]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   1,  Average loss: 0.0130, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   2,  Average loss: 0.0140, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   3,  Average loss: 0.0080, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   4,  Average loss: 0.0070, Accuracy: 486/526 (92.3954%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   5,  Average loss: 0.0034, Accuracy: 490/526 (93.1559%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.63722775505573.
Norm before scaling: 38.68014589583961. Distance: 10.390305593070053
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.8852, Accuracy: 4556/10000 (45.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.1416, Accuracy: 8540/9000 (94.8889%)
Scaling by  100
Scaled Norm after poisoning: 1038.3469434635035, distance: 1039.0305577797026
Total norm for 4 adversaries is: 1038.3469434635035. distance: 1039.0305577797026
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   2,  Average loss: 0.0110, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   3,  Average loss: 0.0078, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   4,  Average loss: 0.0041, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 33, internal_epoch   6,  Average loss: 0.0032, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.63722775505573.
Norm before scaling: 38.66126748459788. Distance: 10.370685093761397
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.9799, Accuracy: 4323/10000 (43.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 0.2442, Accuracy: 8245/9000 (91.6111%)
Scaling by  100
Scaled Norm after poisoning: 1036.3329580786283, distance: 1037.068645268962
Total norm for 4 adversaries is: 1036.3329580786283. distance: 1037.068645268962
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   1,  Average loss: 0.0097, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   2,  Average loss: 0.0067, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.63722775505573.
Norm before scaling: 37.82738762963697. Distance: 6.203520409115182
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.1024, Accuracy: 6326/10000 (63.2600%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 3.2427, Accuracy: 1082/9000 (12.0222%)
Scaling by  100
Scaled Norm after poisoning: 619.5481216176836, distance: 620.3520925651819
Total norm for 4 adversaries is: 619.5481216176836. distance: 620.3520925651819
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   1,  Average loss: 0.0077, Accuracy: 495/546 (90.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 228, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.63722775505573.
Norm before scaling: 37.81985659325502. Distance: 6.351155585923819
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 1.3610, Accuracy: 5869/10000 (58.6900%)
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: 4.8614, Accuracy: 179/9000 (1.9889%)
Scaling by  100
Scaled Norm after poisoning: 634.1393527845437, distance: 635.1155898732136
Total norm for 4 adversaries is: 634.1393527845437. distance: 635.1155898732136
___Test Local_ResNet_18 poisoned: True, epoch: 228: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0046, Accuracy: 774/842 (91.9240%)
___Train Local_ResNet_18,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0168, Accuracy: 602/842 (71.4964%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 79.7063, Accuracy: 1065/10000 (10.6500%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   1,  Average loss: 0.0052, Accuracy: 709/773 (91.7206%)
___Train Local_ResNet_18,  epoch 228, local model 16, internal_epoch   2,  Average loss: 0.0211, Accuracy: 573/773 (74.1268%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 46.6726, Accuracy: 1120/10000 (11.2000%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   1,  Average loss: 0.0042, Accuracy: 625/686 (91.1079%)
___Train Local_ResNet_18,  epoch 228, local model 64, internal_epoch   2,  Average loss: 0.0035, Accuracy: 643/686 (93.7318%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 2.3347, Accuracy: 4984/10000 (49.8400%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   1,  Average loss: 0.0049, Accuracy: 305/337 (90.5045%)
___Train Local_ResNet_18,  epoch 228, local model 30, internal_epoch   2,  Average loss: 0.0026, Accuracy: 320/337 (94.9555%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 3.5609, Accuracy: 3572/10000 (35.7200%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   1,  Average loss: 0.0064, Accuracy: 370/419 (88.3055%)
___Train Local_ResNet_18,  epoch 228, local model 35, internal_epoch   2,  Average loss: 0.0024, Accuracy: 397/419 (94.7494%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 4.4789, Accuracy: 2946/10000 (29.4600%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   1,  Average loss: 0.0074, Accuracy: 893/1034 (86.3636%)
___Train Local_ResNet_18,  epoch 228, local model 81, internal_epoch   2,  Average loss: 0.0068, Accuracy: 890/1034 (86.0735%)
___Test Local_ResNet_18 poisoned: False, epoch: 228: Average loss: 5.6130, Accuracy: 3255/10000 (32.5500%)
time spent on training: 140.15202975273132
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.338667959909473  data num: [526, 527, 496, 546, 842, 773, 686, 337, 419, 1034]
[foolsgold agg] considering poison per batch poison_fraction: 0.02645843436792758
[foolsgold agg] wv: [0.69930547 0.         0.15527074 0.         0.72909119 0.72909119
 0.12849907 1.         0.12849907 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 228: Average loss: 0.6732, Accuracy: 7754/10000 (77.5400%)
___Test Target_ResNet_18 poisoned: True, epoch: 228: Average loss: 6.2420, Accuracy: 238/9000 (2.6444%)
Done in 174.45321321487427 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:229 choose agents : [17, 33, 77, 11, 62, 68, 2, 74, 39, 1]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   1,  Average loss: 0.0133, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   2,  Average loss: 0.0122, Accuracy: 447/526 (84.9810%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   4,  Average loss: 0.0043, Accuracy: 508/526 (96.5779%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.636642327698745.
Norm before scaling: 38.66774599169345. Distance: 10.32389063752168
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.5599, Accuracy: 5067/10000 (50.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.3450, Accuracy: 7973/9000 (88.5889%)
Scaling by  100
Scaled Norm after poisoning: 1031.7233762011986, distance: 1032.389037620993
Total norm for 4 adversaries is: 1031.7233762011986. distance: 1032.389037620993
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   1,  Average loss: 0.0144, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   2,  Average loss: 0.0134, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   3,  Average loss: 0.0069, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   4,  Average loss: 0.0028, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 33, internal_epoch   6,  Average loss: 0.0030, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.636642327698745.
Norm before scaling: 38.64375082130437. Distance: 10.344007413951463
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.9409, Accuracy: 4883/10000 (48.8300%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 0.4153, Accuracy: 7923/9000 (88.0333%)
Scaling by  100
Scaled Norm after poisoning: 1033.6266855107795, distance: 1034.4007323083254
Total norm for 4 adversaries is: 1033.6266855107795. distance: 1034.4007323083254
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   1,  Average loss: 0.0099, Accuracy: 443/496 (89.3145%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   2,  Average loss: 0.0071, Accuracy: 444/496 (89.5161%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   4,  Average loss: 0.0021, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.636642327698745.
Norm before scaling: 37.849081607294316. Distance: 6.369213694574724
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.1114, Accuracy: 6343/10000 (63.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 3.7888, Accuracy: 522/9000 (5.8000%)
Scaling by  100
Scaled Norm after poisoning: 636.1070811978121, distance: 636.9212569070057
Total norm for 4 adversaries is: 636.1070811978121. distance: 636.9212569070057
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   2,  Average loss: 0.0061, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   3,  Average loss: 0.0033, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   5,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 229, local model 11, internal_epoch   6,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.636642327698745.
Norm before scaling: 37.95531848334137. Distance: 7.114776772531182
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.3538, Accuracy: 5874/10000 (58.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: 4.4430, Accuracy: 240/9000 (2.6667%)
Scaling by  100
Scaled Norm after poisoning: 710.6081242499272, distance: 711.4777095946155
Total norm for 4 adversaries is: 710.6081242499272. distance: 711.4777095946155
___Test Local_ResNet_18 poisoned: True, epoch: 229: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   1,  Average loss: 0.0022, Accuracy: 344/358 (96.0894%)
___Train Local_ResNet_18,  epoch 229, local model 62, internal_epoch   2,  Average loss: 0.0010, Accuracy: 352/358 (98.3240%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.0853, Accuracy: 6702/10000 (67.0200%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   1,  Average loss: 0.0026, Accuracy: 400/416 (96.1538%)
___Train Local_ResNet_18,  epoch 229, local model 68, internal_epoch   2,  Average loss: 0.0008, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 1.4848, Accuracy: 6004/10000 (60.0400%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   1,  Average loss: 0.0090, Accuracy: 382/461 (82.8633%)
___Train Local_ResNet_18,  epoch 229, local model 2, internal_epoch   2,  Average loss: 0.0140, Accuracy: 379/461 (82.2126%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 54.6201, Accuracy: 1000/10000 (10.0000%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   1,  Average loss: 0.0040, Accuracy: 434/469 (92.5373%)
___Train Local_ResNet_18,  epoch 229, local model 74, internal_epoch   2,  Average loss: 0.0028, Accuracy: 443/469 (94.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 2.3049, Accuracy: 4796/10000 (47.9600%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   1,  Average loss: 0.0077, Accuracy: 186/217 (85.7143%)
___Train Local_ResNet_18,  epoch 229, local model 39, internal_epoch   2,  Average loss: 0.0019, Accuracy: 211/217 (97.2350%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 3.9010, Accuracy: 3330/10000 (33.3000%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   1,  Average loss: 0.0098, Accuracy: 588/641 (91.7317%)
___Train Local_ResNet_18,  epoch 229, local model 1, internal_epoch   2,  Average loss: 0.0116, Accuracy: 524/641 (81.7473%)
___Test Local_ResNet_18 poisoned: False, epoch: 229: Average loss: 4.6621, Accuracy: 2997/10000 (29.9700%)
time spent on training: 137.5115966796875
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.44986042516641617  data num: [526, 527, 496, 546, 358, 416, 461, 469, 217, 641]
[foolsgold agg] considering poison per batch poison_fraction: 0.035145345716126264
[foolsgold agg] wv: [1.         0.51921058 0.90456813 0.51921058 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 229: Average loss: 0.6695, Accuracy: 7764/10000 (77.6400%)
___Test Target_ResNet_18 poisoned: True, epoch: 229: Average loss: 6.1915, Accuracy: 247/9000 (2.7444%)
Done in 172.3727912902832 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:230 choose agents : [17, 33, 77, 11, 64, 29, 21, 39, 95, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   1,  Average loss: 0.0124, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   2,  Average loss: 0.0127, Accuracy: 443/526 (84.2205%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   3,  Average loss: 0.0077, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 496/526 (94.2966%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 516/526 (98.0989%), train_poison_data_count: 45
Global model norm: 37.63626771427977.
Norm before scaling: 38.49001113316609. Distance: 9.668751941130825
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.6592, Accuracy: 4930/10000 (49.3000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.4604, Accuracy: 7800/9000 (86.6667%)
Scaling by  100
Scaled Norm after poisoning: 966.1339516340371, distance: 966.8752181641642
Total norm for 4 adversaries is: 966.1339516340371. distance: 966.8752181641642
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   1,  Average loss: 0.0147, Accuracy: 428/527 (81.2144%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   2,  Average loss: 0.0110, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   3,  Average loss: 0.0073, Accuracy: 468/527 (88.8046%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 497/527 (94.3074%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   5,  Average loss: 0.0054, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.63626771427977.
Norm before scaling: 38.872770484701114. Distance: 10.960966386165607
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.8090, Accuracy: 4793/10000 (47.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 0.4739, Accuracy: 7641/9000 (84.9000%)
Scaling by  100
Scaled Norm after poisoning: 1095.5776444415064, distance: 1096.0965970205364
Total norm for 4 adversaries is: 1095.5776444415064. distance: 1096.0965970205364
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   1,  Average loss: 0.0082, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   3,  Average loss: 0.0037, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   4,  Average loss: 0.0022, Accuracy: 480/496 (96.7742%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.63626771427977.
Norm before scaling: 37.86047930962691. Distance: 6.332747214785772
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.0759, Accuracy: 6450/10000 (64.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 3.6433, Accuracy: 734/9000 (8.1556%)
Scaling by  100
Scaled Norm after poisoning: 632.5628674290011, distance: 633.2747231652311
Total norm for 4 adversaries is: 632.5628674290011. distance: 633.2747231652311
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0073, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0040, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   3,  Average loss: 0.0016, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 230, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63626771427977.
Norm before scaling: 37.77499754405187. Distance: 6.126002949713016
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 1.2533, Accuracy: 6237/10000 (62.3700%)
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: 5.2979, Accuracy: 54/9000 (0.6000%)
Scaling by  100
Scaled Norm after poisoning: 611.5463494290518, distance: 612.6003234164997
Total norm for 4 adversaries is: 611.5463494290518. distance: 612.6003234164997
___Test Local_ResNet_18 poisoned: True, epoch: 230: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   1,  Average loss: 0.0052, Accuracy: 605/686 (88.1924%)
___Train Local_ResNet_18,  epoch 230, local model 64, internal_epoch   2,  Average loss: 0.0052, Accuracy: 605/686 (88.1924%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.2577, Accuracy: 3734/10000 (37.3400%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   1,  Average loss: 0.0047, Accuracy: 770/848 (90.8019%)
___Train Local_ResNet_18,  epoch 230, local model 29, internal_epoch   2,  Average loss: 0.0032, Accuracy: 801/848 (94.4575%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 4.9789, Accuracy: 3148/10000 (31.4800%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0041, Accuracy: 240/262 (91.6031%)
___Train Local_ResNet_18,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0029, Accuracy: 258/262 (98.4733%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 3.3670, Accuracy: 3746/10000 (37.4600%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   1,  Average loss: 0.0064, Accuracy: 190/217 (87.5576%)
___Train Local_ResNet_18,  epoch 230, local model 39, internal_epoch   2,  Average loss: 0.0012, Accuracy: 215/217 (99.0783%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 2.8222, Accuracy: 4261/10000 (42.6100%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   1,  Average loss: 0.0085, Accuracy: 467/569 (82.0738%)
___Train Local_ResNet_18,  epoch 230, local model 95, internal_epoch   2,  Average loss: 0.0073, Accuracy: 497/569 (87.3462%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 6.7051, Accuracy: 2156/10000 (21.5600%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0054, Accuracy: 519/578 (89.7924%)
___Train Local_ResNet_18,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0033, Accuracy: 542/578 (93.7716%)
___Test Local_ResNet_18 poisoned: False, epoch: 230: Average loss: 7.2953, Accuracy: 2071/10000 (20.7100%)
time spent on training: 137.2369623184204
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.39866793529971456  data num: [526, 527, 496, 546, 686, 848, 262, 217, 569, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.0311459324452902
[foolsgold agg] wv: [0.69162858 0.         0.15331912 0.         1.         0.54075911
 1.         0.79647846 0.78749642 0.54075911]
___Test Target_ResNet_18 poisoned: False, epoch: 230: Average loss: 0.6682, Accuracy: 7775/10000 (77.7500%)
___Test Target_ResNet_18 poisoned: True, epoch: 230: Average loss: 6.1683, Accuracy: 254/9000 (2.8222%)
Done in 170.96025323867798 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:231 choose agents : [17, 33, 77, 11, 68, 38, 97, 3, 98, 90]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   1,  Average loss: 0.0108, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   2,  Average loss: 0.0120, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   3,  Average loss: 0.0072, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   4,  Average loss: 0.0040, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   5,  Average loss: 0.0033, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.63544874122169.
Norm before scaling: 38.396332120561986. Distance: 9.209221108105112
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.8161, Accuracy: 4653/10000 (46.5300%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.2263, Accuracy: 8283/9000 (92.0333%)
Scaling by  100
Scaled Norm after poisoning: 920.2271458721483, distance: 920.9220583198124
Total norm for 4 adversaries is: 920.2271458721483. distance: 920.9220583198124
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   1,  Average loss: 0.0136, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   2,  Average loss: 0.0089, Accuracy: 467/527 (88.6148%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   3,  Average loss: 0.0066, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   4,  Average loss: 0.0032, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 33, internal_epoch   6,  Average loss: 0.0025, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.63544874122169.
Norm before scaling: 38.28311219960441. Distance: 8.806787248931883
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.7238, Accuracy: 5025/10000 (50.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 0.6723, Accuracy: 7440/9000 (82.6667%)
Scaling by  100
Scaled Norm after poisoning: 879.8706936249213, distance: 880.678751021052
Total norm for 4 adversaries is: 879.8706936249213. distance: 880.678751021052
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   1,  Average loss: 0.0082, Accuracy: 445/496 (89.7177%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63544874122169.
Norm before scaling: 37.78213204615543. Distance: 5.910343426893917
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.0728, Accuracy: 6498/10000 (64.9800%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 3.4006, Accuracy: 907/9000 (10.0778%)
Scaling by  100
Scaled Norm after poisoning: 590.2128059013969, distance: 591.0343951497239
Total norm for 4 adversaries is: 590.2128059013969. distance: 591.0343951497239
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   4,  Average loss: 0.0014, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 231, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.63544874122169.
Norm before scaling: 37.8367626187647. Distance: 6.45551128463462
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3739, Accuracy: 5964/10000 (59.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: 5.2174, Accuracy: 178/9000 (1.9778%)
Scaling by  100
Scaled Norm after poisoning: 644.5965065449859, distance: 645.551096931916
Total norm for 4 adversaries is: 644.5965065449859. distance: 645.551096931916
___Test Local_ResNet_18 poisoned: True, epoch: 231: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   1,  Average loss: 0.0028, Accuracy: 400/416 (96.1538%)
___Train Local_ResNet_18,  epoch 231, local model 68, internal_epoch   2,  Average loss: 0.0008, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 1.3616, Accuracy: 6150/10000 (61.5000%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   1,  Average loss: 0.0039, Accuracy: 701/756 (92.7249%)
___Train Local_ResNet_18,  epoch 231, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 685/756 (90.6085%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.9971, Accuracy: 4071/10000 (40.7100%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   1,  Average loss: 0.0027, Accuracy: 394/418 (94.2584%)
___Train Local_ResNet_18,  epoch 231, local model 97, internal_epoch   2,  Average loss: 0.0018, Accuracy: 405/418 (96.8900%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3.0103, Accuracy: 4478/10000 (44.7800%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   1,  Average loss: 0.0057, Accuracy: 692/780 (88.7179%)
___Train Local_ResNet_18,  epoch 231, local model 3, internal_epoch   2,  Average loss: 0.0091, Accuracy: 657/780 (84.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 4.9077, Accuracy: 2793/10000 (27.9300%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   1,  Average loss: 0.0050, Accuracy: 733/802 (91.3965%)
___Train Local_ResNet_18,  epoch 231, local model 98, internal_epoch   2,  Average loss: 0.0072, Accuracy: 698/802 (87.0324%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 6.9455, Accuracy: 2164/10000 (21.6400%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   1,  Average loss: 0.0114, Accuracy: 512/578 (88.5813%)
___Train Local_ResNet_18,  epoch 231, local model 90, internal_epoch   2,  Average loss: 0.0173, Accuracy: 403/578 (69.7232%)
___Test Local_ResNet_18 poisoned: False, epoch: 231: Average loss: 3827.2222, Accuracy: 1000/10000 (10.0000%)
time spent on training: 138.0065701007843
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.358426005132592  data num: [526, 527, 496, 546, 416, 756, 418, 780, 802, 578]
[foolsgold agg] considering poison per batch poison_fraction: 0.02800203165098375
[foolsgold agg] wv: [0.51117626 0.         0.         0.         1.         0.87357141
 0.87357141 1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 231: Average loss: 0.6682, Accuracy: 7783/10000 (77.8300%)
___Test Target_ResNet_18 poisoned: True, epoch: 231: Average loss: 6.1710, Accuracy: 264/9000 (2.9333%)
Done in 173.1135585308075 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:232 choose agents : [17, 33, 77, 11, 88, 25, 27, 56, 93, 42]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   1,  Average loss: 0.0128, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   2,  Average loss: 0.0108, Accuracy: 451/526 (85.7414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 466/526 (88.5932%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   4,  Average loss: 0.0030, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   5,  Average loss: 0.0032, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.635346571055216.
Norm before scaling: 38.5644594062574. Distance: 9.926576764903965
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.6972, Accuracy: 4823/10000 (48.2300%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.2126, Accuracy: 8346/9000 (92.7333%)
Scaling by  100
Scaled Norm after poisoning: 991.973663964926, distance: 992.6576700957888
Total norm for 4 adversaries is: 991.973663964926. distance: 992.6576700957888
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 444/527 (84.2505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   2,  Average loss: 0.0119, Accuracy: 454/527 (86.1480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   3,  Average loss: 0.0087, Accuracy: 460/527 (87.2865%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   4,  Average loss: 0.0047, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   5,  Average loss: 0.0044, Accuracy: 498/527 (94.4972%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Global model norm: 37.635346571055216.
Norm before scaling: 38.965999552093486. Distance: 11.167483019998425
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 2.0243, Accuracy: 4367/10000 (43.6700%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 0.4919, Accuracy: 7601/9000 (84.4556%)
Scaling by  100
Scaled Norm after poisoning: 1116.362452342428, distance: 1116.7482930365284
Total norm for 4 adversaries is: 1116.362452342428. distance: 1116.7482930365284
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   1,  Average loss: 0.0090, Accuracy: 439/496 (88.5081%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   2,  Average loss: 0.0054, Accuracy: 458/496 (92.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   4,  Average loss: 0.0026, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 77, internal_epoch   6,  Average loss: 0.0005, Accuracy: 494/496 (99.5968%), train_poison_data_count: 40
Global model norm: 37.635346571055216.
Norm before scaling: 37.81859616406078. Distance: 6.121265129022362
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.0988, Accuracy: 6336/10000 (63.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 3.8594, Accuracy: 700/9000 (7.7778%)
Scaling by  100
Scaled Norm after poisoning: 611.3517297759122, distance: 612.1265187851283
Total norm for 4 adversaries is: 611.3517297759122. distance: 612.1265187851283
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   1,  Average loss: 0.0086, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 232, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.635346571055216.
Norm before scaling: 37.821108911517584. Distance: 6.501425366742004
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.2724, Accuracy: 6074/10000 (60.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: 4.4346, Accuracy: 279/9000 (3.1000%)
Scaling by  100
Scaled Norm after poisoning: 649.0582119502071, distance: 650.1425564828071
Total norm for 4 adversaries is: 649.0582119502071. distance: 650.1425564828071
___Test Local_ResNet_18 poisoned: True, epoch: 232: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   1,  Average loss: 0.0074, Accuracy: 370/447 (82.7740%)
___Train Local_ResNet_18,  epoch 232, local model 88, internal_epoch   2,  Average loss: 0.0044, Accuracy: 408/447 (91.2752%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 5.0153, Accuracy: 2632/10000 (26.3200%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   1,  Average loss: 0.0034, Accuracy: 513/545 (94.1284%)
___Train Local_ResNet_18,  epoch 232, local model 25, internal_epoch   2,  Average loss: 0.0016, Accuracy: 526/545 (96.5138%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 4.2605, Accuracy: 3476/10000 (34.7600%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 382/397 (96.2217%)
___Train Local_ResNet_18,  epoch 232, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 397/397 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.5487, Accuracy: 5971/10000 (59.7100%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   1,  Average loss: 0.0020, Accuracy: 721/743 (97.0390%)
___Train Local_ResNet_18,  epoch 232, local model 56, internal_epoch   2,  Average loss: 0.0013, Accuracy: 731/743 (98.3849%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 1.3793, Accuracy: 6254/10000 (62.5400%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   1,  Average loss: 0.0027, Accuracy: 554/584 (94.8630%)
___Train Local_ResNet_18,  epoch 232, local model 93, internal_epoch   2,  Average loss: 0.0027, Accuracy: 559/584 (95.7192%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.3806, Accuracy: 4139/10000 (41.3900%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   1,  Average loss: 0.0049, Accuracy: 178/198 (89.8990%)
___Train Local_ResNet_18,  epoch 232, local model 42, internal_epoch   2,  Average loss: 0.0005, Accuracy: 198/198 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 232: Average loss: 3.2680, Accuracy: 3678/10000 (36.7800%)
time spent on training: 139.06106543540955
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4182471551207826  data num: [526, 527, 496, 546, 447, 545, 397, 743, 584, 198]
[foolsgold agg] considering poison per batch poison_fraction: 0.03267555899381114
[foolsgold agg] wv: [0.55527545 0.         0.03138169 0.         1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 232: Average loss: 0.6671, Accuracy: 7791/10000 (77.9100%)
___Test Target_ResNet_18 poisoned: True, epoch: 232: Average loss: 6.1508, Accuracy: 267/9000 (2.9667%)
Done in 173.80271863937378 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:233 choose agents : [17, 33, 77, 11, 18, 66, 27, 82, 86, 67]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   1,  Average loss: 0.0132, Accuracy: 471/526 (89.5437%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   2,  Average loss: 0.0141, Accuracy: 439/526 (83.4601%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   3,  Average loss: 0.0096, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   4,  Average loss: 0.0060, Accuracy: 491/526 (93.3460%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.63422268091737.
Norm before scaling: 38.76020216000395. Distance: 10.73830860366196
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.7686, Accuracy: 4893/10000 (48.9300%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.3764, Accuracy: 7945/9000 (88.2778%)
Scaling by  100
Scaled Norm after poisoning: 1073.1261575416006, distance: 1073.8308758831624
Total norm for 4 adversaries is: 1073.1261575416006. distance: 1073.8308758831624
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   1,  Average loss: 0.0156, Accuracy: 437/527 (82.9222%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   3,  Average loss: 0.0086, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   5,  Average loss: 0.0038, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 33, internal_epoch   6,  Average loss: 0.0034, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.63422268091737.
Norm before scaling: 38.60447092994865. Distance: 10.14375846895345
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.7958, Accuracy: 4829/10000 (48.2900%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 0.3699, Accuracy: 7808/9000 (86.7556%)
Scaling by  100
Scaled Norm after poisoning: 1013.6477753638095, distance: 1014.375700862358
Total norm for 4 adversaries is: 1013.6477753638095. distance: 1014.375700862358
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   1,  Average loss: 0.0087, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   4,  Average loss: 0.0019, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63422268091737.
Norm before scaling: 37.80350487016713. Distance: 6.113856240431411
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.0827, Accuracy: 6478/10000 (64.7800%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 3.3515, Accuracy: 706/9000 (7.8444%)
Scaling by  100
Scaled Norm after poisoning: 610.5307629431952, distance: 611.3856955719524
Total norm for 4 adversaries is: 610.5307629431952. distance: 611.3856955719524
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 482/546 (88.2784%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 509/546 (93.2234%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 523/546 (95.7875%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   4,  Average loss: 0.0020, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 233, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.63422268091737.
Norm before scaling: 37.84197424353594. Distance: 6.589297558592556
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.3547, Accuracy: 5807/10000 (58.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: 4.1805, Accuracy: 158/9000 (1.7556%)
Scaling by  100
Scaled Norm after poisoning: 657.8988809080009, distance: 658.9297430303174
Total norm for 4 adversaries is: 657.8988809080009. distance: 658.9297430303174
___Test Local_ResNet_18 poisoned: True, epoch: 233: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   1,  Average loss: 0.0028, Accuracy: 364/386 (94.3005%)
___Train Local_ResNet_18,  epoch 233, local model 18, internal_epoch   2,  Average loss: 0.0016, Accuracy: 377/386 (97.6684%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.9756, Accuracy: 5446/10000 (54.4600%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   1,  Average loss: 0.0025, Accuracy: 530/555 (95.4955%)
___Train Local_ResNet_18,  epoch 233, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 544/555 (98.0180%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 3.2686, Accuracy: 4096/10000 (40.9600%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   1,  Average loss: 0.0019, Accuracy: 384/397 (96.7254%)
___Train Local_ResNet_18,  epoch 233, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 396/397 (99.7481%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4664, Accuracy: 6011/10000 (60.1100%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   1,  Average loss: 0.0039, Accuracy: 572/601 (95.1747%)
___Train Local_ResNet_18,  epoch 233, local model 82, internal_epoch   2,  Average loss: 0.0040, Accuracy: 552/601 (91.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 4.1508, Accuracy: 3781/10000 (37.8100%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   1,  Average loss: 0.0038, Accuracy: 199/212 (93.8679%)
___Train Local_ResNet_18,  epoch 233, local model 86, internal_epoch   2,  Average loss: 0.0008, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 1.4295, Accuracy: 6309/10000 (63.0900%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   1,  Average loss: 0.0054, Accuracy: 766/842 (90.9739%)
___Train Local_ResNet_18,  epoch 233, local model 67, internal_epoch   2,  Average loss: 0.0134, Accuracy: 655/842 (77.7910%)
___Test Local_ResNet_18 poisoned: False, epoch: 233: Average loss: 64.1645, Accuracy: 1144/10000 (11.4400%)
time spent on training: 138.53748321533203
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4117531446540881  data num: [526, 527, 496, 546, 386, 555, 397, 601, 212, 842]
[foolsgold agg] considering poison per batch poison_fraction: 0.03216821442610063
[foolsgold agg] wv: [0.57082677 0.         0.01966642 0.         1.         0.59706931
 0.39567914 0.39567914 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 233: Average loss: 0.6656, Accuracy: 7797/10000 (77.9700%)
___Test Target_ResNet_18 poisoned: True, epoch: 233: Average loss: 6.1451, Accuracy: 270/9000 (3.0000%)
Done in 173.19260573387146 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:234 choose agents : [17, 33, 77, 11, 38, 29, 30, 96, 0, 3]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   1,  Average loss: 0.0104, Accuracy: 468/526 (88.9734%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   2,  Average loss: 0.0136, Accuracy: 441/526 (83.8403%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   3,  Average loss: 0.0075, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   4,  Average loss: 0.0042, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   5,  Average loss: 0.0032, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 17, internal_epoch   6,  Average loss: 0.0033, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Global model norm: 37.633163631068975.
Norm before scaling: 38.90648531555343. Distance: 11.042698611614515
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.7735, Accuracy: 4865/10000 (48.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.2566, Accuracy: 8242/9000 (91.5778%)
Scaling by  100
Scaled Norm after poisoning: 1103.8025185693318, distance: 1104.2700077426716
Total norm for 4 adversaries is: 1103.8025185693318. distance: 1104.2700077426716
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   2,  Average loss: 0.0117, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   3,  Average loss: 0.0064, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   4,  Average loss: 0.0046, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 33, internal_epoch   6,  Average loss: 0.0026, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.633163631068975.
Norm before scaling: 38.50995457751801. Distance: 9.837107133594332
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.8617, Accuracy: 4656/10000 (46.5600%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 0.2487, Accuracy: 8184/9000 (90.9333%)
Scaling by  100
Scaled Norm after poisoning: 982.9050691699581, distance: 983.7107044248324
Total norm for 4 adversaries is: 982.9050691699581. distance: 983.7107044248324
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   1,  Average loss: 0.0093, Accuracy: 438/496 (88.3065%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   2,  Average loss: 0.0064, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 77, internal_epoch   6,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.633163631068975.
Norm before scaling: 37.78190265151756. Distance: 5.970157477316246
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.0391, Accuracy: 6576/10000 (65.7600%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 3.2609, Accuracy: 1134/9000 (12.6000%)
Scaling by  100
Scaled Norm after poisoning: 596.1556004936966, distance: 597.0157294829006
Total norm for 4 adversaries is: 596.1556004936966. distance: 597.0157294829006
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 501/546 (91.7582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   3,  Average loss: 0.0026, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   5,  Average loss: 0.0014, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 234, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.633163631068975.
Norm before scaling: 37.83980644966934. Distance: 6.495406361613585
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 1.3311, Accuracy: 6097/10000 (60.9700%)
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: 4.8641, Accuracy: 170/9000 (1.8889%)
Scaling by  100
Scaled Norm after poisoning: 648.5830469184343, distance: 649.5407271680507
Total norm for 4 adversaries is: 648.5830469184343. distance: 649.5407271680507
___Test Local_ResNet_18 poisoned: True, epoch: 234: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   1,  Average loss: 0.0021, Accuracy: 729/756 (96.4286%)
___Train Local_ResNet_18,  epoch 234, local model 38, internal_epoch   2,  Average loss: 0.0026, Accuracy: 717/756 (94.8413%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 2.1999, Accuracy: 5174/10000 (51.7400%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   1,  Average loss: 0.0059, Accuracy: 759/848 (89.5047%)
___Train Local_ResNet_18,  epoch 234, local model 29, internal_epoch   2,  Average loss: 0.0047, Accuracy: 764/848 (90.0943%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.5124, Accuracy: 3347/10000 (33.4700%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   1,  Average loss: 0.0055, Accuracy: 297/337 (88.1306%)
___Train Local_ResNet_18,  epoch 234, local model 30, internal_epoch   2,  Average loss: 0.0036, Accuracy: 321/337 (95.2522%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 4.5220, Accuracy: 3232/10000 (32.3200%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   1,  Average loss: 0.0053, Accuracy: 648/708 (91.5254%)
___Train Local_ResNet_18,  epoch 234, local model 96, internal_epoch   2,  Average loss: 0.0245, Accuracy: 389/708 (54.9435%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 24.4349, Accuracy: 1611/10000 (16.1100%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   1,  Average loss: 0.0071, Accuracy: 317/367 (86.3760%)
___Train Local_ResNet_18,  epoch 234, local model 0, internal_epoch   2,  Average loss: 0.0023, Accuracy: 354/367 (96.4578%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 7.7861, Accuracy: 1890/10000 (18.9000%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   1,  Average loss: 0.0081, Accuracy: 682/780 (87.4359%)
___Train Local_ResNet_18,  epoch 234, local model 3, internal_epoch   2,  Average loss: 0.0196, Accuracy: 537/780 (68.8462%)
___Test Local_ResNet_18 poisoned: False, epoch: 234: Average loss: 187.3444, Accuracy: 1281/10000 (12.8100%)
time spent on training: 137.66691899299622
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35562722797487695  data num: [526, 527, 496, 546, 756, 848, 337, 708, 367, 780]
[foolsgold agg] considering poison per batch poison_fraction: 0.02778337718553726
[foolsgold agg] wv: [0.87770248 0.         0.24395001 0.         1.         1.
 1.         1.         0.4869932  1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 234: Average loss: 0.6652, Accuracy: 7789/10000 (77.8900%)
___Test Target_ResNet_18 poisoned: True, epoch: 234: Average loss: 6.1197, Accuracy: 277/9000 (3.0778%)
Done in 172.42797470092773 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:235 choose agents : [17, 33, 77, 11, 8, 68, 79, 90, 21, 25]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   1,  Average loss: 0.0117, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   2,  Average loss: 0.0097, Accuracy: 460/526 (87.4525%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   3,  Average loss: 0.0077, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   4,  Average loss: 0.0056, Accuracy: 495/526 (94.1065%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 17, internal_epoch   6,  Average loss: 0.0030, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.63291548797409.
Norm before scaling: 38.41010679119413. Distance: 9.361737037608359
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.8129, Accuracy: 4885/10000 (48.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.4606, Accuracy: 7823/9000 (86.9222%)
Scaling by  100
Scaled Norm after poisoning: 935.4052931751028, distance: 936.1736617743526
Total norm for 4 adversaries is: 935.4052931751028. distance: 936.1736617743526
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   1,  Average loss: 0.0149, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   2,  Average loss: 0.0119, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   3,  Average loss: 0.0081, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 495/527 (93.9279%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   5,  Average loss: 0.0030, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 33, internal_epoch   6,  Average loss: 0.0014, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.63291548797409.
Norm before scaling: 38.67569583397547. Distance: 10.404871943875957
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.9216, Accuracy: 4514/10000 (45.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 0.0815, Accuracy: 8732/9000 (97.0222%)
Scaling by  100
Scaled Norm after poisoning: 1039.7888607789564, distance: 1040.4872055916883
Total norm for 4 adversaries is: 1039.7888607789564. distance: 1040.4872055916883
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   1,  Average loss: 0.0073, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   2,  Average loss: 0.0057, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   3,  Average loss: 0.0029, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.63291548797409.
Norm before scaling: 37.779083568469964. Distance: 5.846959176367441
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.0931, Accuracy: 6475/10000 (64.7500%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 4.0250, Accuracy: 519/9000 (5.7667%)
Scaling by  100
Scaled Norm after poisoning: 583.9256427405804, distance: 584.6959680038849
Total norm for 4 adversaries is: 583.9256427405804. distance: 584.6959680038849
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 495/546 (90.6593%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   2,  Average loss: 0.0054, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   3,  Average loss: 0.0018, Accuracy: 534/546 (97.8022%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   4,  Average loss: 0.0007, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   5,  Average loss: 0.0002, Accuracy: 546/546 (100.0000%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 235, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.63291548797409.
Norm before scaling: 37.82268070591044. Distance: 6.284060935770946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.2969, Accuracy: 6165/10000 (61.6500%)
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: 5.3905, Accuracy: 20/9000 (0.2222%)
Scaling by  100
Scaled Norm after poisoning: 627.5296307745157, distance: 628.4060689554168
Total norm for 4 adversaries is: 627.5296307745157. distance: 628.4060689554168
___Test Local_ResNet_18 poisoned: True, epoch: 235: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   1,  Average loss: 0.0038, Accuracy: 498/534 (93.2584%)
___Train Local_ResNet_18,  epoch 235, local model 8, internal_epoch   2,  Average loss: 0.0037, Accuracy: 499/534 (93.4457%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 2.7289, Accuracy: 4289/10000 (42.8900%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   1,  Average loss: 0.0024, Accuracy: 402/416 (96.6346%)
___Train Local_ResNet_18,  epoch 235, local model 68, internal_epoch   2,  Average loss: 0.0012, Accuracy: 412/416 (99.0385%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.4426, Accuracy: 6183/10000 (61.8300%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   1,  Average loss: 0.0086, Accuracy: 132/154 (85.7143%)
___Train Local_ResNet_18,  epoch 235, local model 79, internal_epoch   2,  Average loss: 0.0006, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 1.7188, Accuracy: 5857/10000 (58.5700%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   1,  Average loss: 0.0111, Accuracy: 519/578 (89.7924%)
___Train Local_ResNet_18,  epoch 235, local model 90, internal_epoch   2,  Average loss: 0.0201, Accuracy: 435/578 (75.2595%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 136.3031, Accuracy: 1495/10000 (14.9500%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0054, Accuracy: 245/262 (93.5115%)
___Train Local_ResNet_18,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0069, Accuracy: 253/262 (96.5649%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 19.7288, Accuracy: 1142/10000 (11.4200%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   1,  Average loss: 0.0043, Accuracy: 503/545 (92.2936%)
___Train Local_ResNet_18,  epoch 235, local model 25, internal_epoch   2,  Average loss: 0.0018, Accuracy: 528/545 (96.8807%)
___Test Local_ResNet_18 poisoned: False, epoch: 235: Average loss: 4.8273, Accuracy: 3528/10000 (35.2800%)
time spent on training: 140.04840087890625
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4570244328097731  data num: [526, 527, 496, 546, 534, 416, 154, 578, 262, 545]
[foolsgold agg] considering poison per batch poison_fraction: 0.03570503381326352
[foolsgold agg] wv: [0.64853587 0.         0.05215466 0.         0.89465629 1.
 1.         0.89465629 1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 235: Average loss: 0.6621, Accuracy: 7800/10000 (78.0000%)
___Test Target_ResNet_18 poisoned: True, epoch: 235: Average loss: 6.0957, Accuracy: 284/9000 (3.1556%)
Done in 174.1684319972992 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:236 choose agents : [17, 33, 77, 11, 53, 14, 6, 12, 7, 58]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0126, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0123, Accuracy: 463/526 (88.0228%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   3,  Average loss: 0.0079, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   4,  Average loss: 0.0035, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 499/526 (94.8669%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 17, internal_epoch   6,  Average loss: 0.0036, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.63175259951279.
Norm before scaling: 38.340889448615265. Distance: 9.114192048892845
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.7555, Accuracy: 4917/10000 (49.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 0.4934, Accuracy: 7740/9000 (86.0000%)
Scaling by  100
Scaled Norm after poisoning: 910.594208470491, distance: 911.4192915447862
Total norm for 4 adversaries is: 910.594208470491. distance: 911.4192915447862
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   1,  Average loss: 0.0126, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   2,  Average loss: 0.0094, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   3,  Average loss: 0.0070, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   4,  Average loss: 0.0032, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   5,  Average loss: 0.0033, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 33, internal_epoch   6,  Average loss: 0.0049, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Global model norm: 37.63175259951279.
Norm before scaling: 38.73491074659751. Distance: 10.54786779181524
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.3568, Accuracy: 4190/10000 (41.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 1.6064, Accuracy: 5900/9000 (65.5556%)
Scaling by  100
Scaled Norm after poisoning: 1054.1775230007515, distance: 1054.7868268043549
Total norm for 4 adversaries is: 1054.1775230007515. distance: 1054.7868268043549
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   1,  Average loss: 0.0078, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   2,  Average loss: 0.0042, Accuracy: 469/496 (94.5565%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 479/496 (96.5726%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   4,  Average loss: 0.0011, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.63175259951279.
Norm before scaling: 37.71633076593364. Distance: 5.4719018191514195
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.0065, Accuracy: 6763/10000 (67.6300%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 3.9650, Accuracy: 511/9000 (5.6778%)
Scaling by  100
Scaled Norm after poisoning: 546.3298854629866, distance: 547.1902377144534
Total norm for 4 adversaries is: 546.3298854629866. distance: 547.1902377144534
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   1,  Average loss: 0.0084, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   2,  Average loss: 0.0048, Accuracy: 507/546 (92.8571%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   4,  Average loss: 0.0017, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 236, local model 11, internal_epoch   6,  Average loss: 0.0018, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.63175259951279.
Norm before scaling: 37.844082239458196. Distance: 6.542886251811993
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 1.4370, Accuracy: 5679/10000 (56.7900%)
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: 3.8686, Accuracy: 367/9000 (4.0778%)
Scaling by  100
Scaled Norm after poisoning: 653.3233072147358, distance: 654.2885449096599
Total norm for 4 adversaries is: 653.3233072147358. distance: 654.2885449096599
___Test Local_ResNet_18 poisoned: True, epoch: 236: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   1,  Average loss: 0.0042, Accuracy: 569/625 (91.0400%)
___Train Local_ResNet_18,  epoch 236, local model 53, internal_epoch   2,  Average loss: 0.0035, Accuracy: 580/625 (92.8000%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.0845, Accuracy: 2945/10000 (29.4500%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   1,  Average loss: 0.0081, Accuracy: 271/318 (85.2201%)
___Train Local_ResNet_18,  epoch 236, local model 14, internal_epoch   2,  Average loss: 0.0016, Accuracy: 309/318 (97.1698%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.7504, Accuracy: 2728/10000 (27.2800%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   1,  Average loss: 0.0036, Accuracy: 485/520 (93.2692%)
___Train Local_ResNet_18,  epoch 236, local model 6, internal_epoch   2,  Average loss: 0.0032, Accuracy: 485/520 (93.2692%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.7919, Accuracy: 4225/10000 (42.2500%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   1,  Average loss: 0.0046, Accuracy: 898/977 (91.9140%)
___Train Local_ResNet_18,  epoch 236, local model 12, internal_epoch   2,  Average loss: 0.0085, Accuracy: 825/977 (84.4422%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 7.3971, Accuracy: 2605/10000 (26.0500%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   1,  Average loss: 0.0028, Accuracy: 333/352 (94.6023%)
___Train Local_ResNet_18,  epoch 236, local model 7, internal_epoch   2,  Average loss: 0.0010, Accuracy: 346/352 (98.2955%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 2.5094, Accuracy: 4555/10000 (45.5500%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   1,  Average loss: 0.0090, Accuracy: 193/234 (82.4786%)
___Train Local_ResNet_18,  epoch 236, local model 58, internal_epoch   2,  Average loss: 0.0008, Accuracy: 230/234 (98.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 236: Average loss: 5.7817, Accuracy: 2144/10000 (21.4400%)
time spent on training: 141.75759625434875
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4090997851982035  data num: [526, 527, 496, 546, 625, 318, 520, 977, 352, 234]
[foolsgold agg] considering poison per batch poison_fraction: 0.03196092071860965
[foolsgold agg] wv: [0.63501699 0.         0.05121581 0.         1.         0.36939584
 0.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 236: Average loss: 0.6607, Accuracy: 7807/10000 (78.0700%)
___Test Target_ResNet_18 poisoned: True, epoch: 236: Average loss: 6.0573, Accuracy: 299/9000 (3.3222%)
Done in 176.1205129623413 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:237 choose agents : [17, 33, 77, 11, 65, 0, 98, 20, 45, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   1,  Average loss: 0.0099, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   2,  Average loss: 0.0134, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   4,  Average loss: 0.0038, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   5,  Average loss: 0.0031, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 17, internal_epoch   6,  Average loss: 0.0020, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.63085405299503.
Norm before scaling: 38.312033222584745. Distance: 8.910291537771698
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.6393, Accuracy: 4989/10000 (49.8900%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.0723, Accuracy: 8772/9000 (97.4667%)
Scaling by  100
Scaled Norm after poisoning: 890.270991047108, distance: 891.0290399307983
Total norm for 4 adversaries is: 890.270991047108. distance: 891.0290399307983
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0131, Accuracy: 439/527 (83.3017%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   3,  Average loss: 0.0052, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 503/527 (95.4459%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.63085405299503.
Norm before scaling: 38.55348988134861. Distance: 9.9170444534104
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.6810, Accuracy: 4944/10000 (49.4400%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 0.2195, Accuracy: 8264/9000 (91.8222%)
Scaling by  100
Scaled Norm after poisoning: 991.003500246089, distance: 991.7045300894819
Total norm for 4 adversaries is: 991.003500246089. distance: 991.7045300894819
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   1,  Average loss: 0.0066, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   3,  Average loss: 0.0027, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   5,  Average loss: 0.0013, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.63085405299503.
Norm before scaling: 37.772037364174906. Distance: 5.844570163555958
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.1129, Accuracy: 6340/10000 (63.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 3.1981, Accuracy: 1190/9000 (13.2222%)
Scaling by  100
Scaled Norm after poisoning: 583.6563361688109, distance: 584.4570129616035
Total norm for 4 adversaries is: 583.6563361688109. distance: 584.4570129616035
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   2,  Average loss: 0.0063, Accuracy: 506/546 (92.6740%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   4,  Average loss: 0.0011, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 237, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.63085405299503.
Norm before scaling: 37.85786115679526. Distance: 6.577251312878631
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 1.3361, Accuracy: 6007/10000 (60.0700%)
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: 5.2945, Accuracy: 28/9000 (0.3111%)
Scaling by  100
Scaled Norm after poisoning: 656.8149710915549, distance: 657.725127807962
Total norm for 4 adversaries is: 656.8149710915549. distance: 657.725127807962
___Test Local_ResNet_18 poisoned: True, epoch: 237: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   1,  Average loss: 0.0040, Accuracy: 289/314 (92.0382%)
___Train Local_ResNet_18,  epoch 237, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 312/314 (99.3631%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.2295, Accuracy: 3583/10000 (35.8300%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   1,  Average loss: 0.0064, Accuracy: 324/367 (88.2834%)
___Train Local_ResNet_18,  epoch 237, local model 0, internal_epoch   2,  Average loss: 0.0038, Accuracy: 343/367 (93.4605%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 4.5740, Accuracy: 2793/10000 (27.9300%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   1,  Average loss: 0.0035, Accuracy: 737/802 (91.8953%)
___Train Local_ResNet_18,  epoch 237, local model 98, internal_epoch   2,  Average loss: 0.0058, Accuracy: 711/802 (88.6534%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 5.0728, Accuracy: 2884/10000 (28.8400%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   1,  Average loss: 0.0078, Accuracy: 304/362 (83.9779%)
___Train Local_ResNet_18,  epoch 237, local model 20, internal_epoch   2,  Average loss: 0.0027, Accuracy: 340/362 (93.9227%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 6.0821, Accuracy: 2843/10000 (28.4300%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   1,  Average loss: 0.0053, Accuracy: 471/529 (89.0359%)
___Train Local_ResNet_18,  epoch 237, local model 45, internal_epoch   2,  Average loss: 0.0043, Accuracy: 486/529 (91.8715%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 3.1512, Accuracy: 3731/10000 (37.3100%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   1,  Average loss: 0.0021, Accuracy: 576/601 (95.8403%)
___Train Local_ResNet_18,  epoch 237, local model 82, internal_epoch   2,  Average loss: 0.0020, Accuracy: 578/601 (96.1730%)
___Test Local_ResNet_18 poisoned: False, epoch: 237: Average loss: 2.6789, Accuracy: 4843/10000 (48.4300%)
time spent on training: 140.1031048297882
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41321499013806706  data num: [526, 527, 496, 546, 314, 367, 802, 362, 529, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.03228242110453649
[foolsgold agg] wv: [0.7406137  0.         0.14692983 0.         0.943697   0.37258782
 1.         1.         0.943697   1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 237: Average loss: 0.6598, Accuracy: 7813/10000 (78.1300%)
___Test Target_ResNet_18 poisoned: True, epoch: 237: Average loss: 6.0288, Accuracy: 304/9000 (3.3778%)
Done in 175.31108450889587 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:238 choose agents : [17, 33, 77, 11, 88, 46, 85, 42, 29, 8]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   1,  Average loss: 0.0125, Accuracy: 469/526 (89.1635%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   2,  Average loss: 0.0110, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   3,  Average loss: 0.0078, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   4,  Average loss: 0.0053, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   5,  Average loss: 0.0040, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 17, internal_epoch   6,  Average loss: 0.0040, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Global model norm: 37.630143634604124.
Norm before scaling: 38.50807957277034. Distance: 9.800757118095042
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.8286, Accuracy: 4674/10000 (46.7400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1645, Accuracy: 8484/9000 (94.2667%)
Scaling by  100
Scaled Norm after poisoning: 979.3075997867064, distance: 980.0757304922921
Total norm for 4 adversaries is: 979.3075997867064. distance: 980.0757304922921
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   1,  Average loss: 0.0140, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   2,  Average loss: 0.0149, Accuracy: 427/527 (81.0247%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   3,  Average loss: 0.0080, Accuracy: 475/527 (90.1328%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 33, internal_epoch   6,  Average loss: 0.0038, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.630143634604124.
Norm before scaling: 38.47989436716027. Distance: 9.906506074790611
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.7440, Accuracy: 4904/10000 (49.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 0.1889, Accuracy: 8325/9000 (92.5000%)
Scaling by  100
Scaled Norm after poisoning: 989.6757360368092, distance: 990.6506384694859
Total norm for 4 adversaries is: 989.6757360368092. distance: 990.6506384694859
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   2,  Average loss: 0.0060, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   4,  Average loss: 0.0025, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.630143634604124.
Norm before scaling: 37.76758049860687. Distance: 5.695801764928387
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.9956, Accuracy: 6736/10000 (67.3600%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 3.8987, Accuracy: 617/9000 (6.8556%)
Scaling by  100
Scaled Norm after poisoning: 568.8845719915421, distance: 569.5801633659655
Total norm for 4 adversaries is: 568.8845719915421. distance: 569.5801633659655
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   1,  Average loss: 0.0081, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   3,  Average loss: 0.0027, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   4,  Average loss: 0.0021, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 238, local model 11, internal_epoch   6,  Average loss: 0.0007, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.630143634604124.
Norm before scaling: 37.811240939782046. Distance: 6.487512771505673
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.3587, Accuracy: 5940/10000 (59.4000%)
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: 4.6769, Accuracy: 123/9000 (1.3667%)
Scaling by  100
Scaled Norm after poisoning: 647.6508752792665, distance: 648.7512524072689
Total norm for 4 adversaries is: 647.6508752792665. distance: 648.7512524072689
___Test Local_ResNet_18 poisoned: True, epoch: 238: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   1,  Average loss: 0.0067, Accuracy: 386/447 (86.3535%)
___Train Local_ResNet_18,  epoch 238, local model 88, internal_epoch   2,  Average loss: 0.0032, Accuracy: 420/447 (93.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.9274, Accuracy: 2937/10000 (29.3700%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 238, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 591/601 (98.3361%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 1.5859, Accuracy: 5846/10000 (58.4600%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   1,  Average loss: 0.0069, Accuracy: 311/364 (85.4396%)
___Train Local_ResNet_18,  epoch 238, local model 85, internal_epoch   2,  Average loss: 0.0022, Accuracy: 348/364 (95.6044%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.0668, Accuracy: 3050/10000 (30.5000%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   1,  Average loss: 0.0077, Accuracy: 183/198 (92.4242%)
___Train Local_ResNet_18,  epoch 238, local model 42, internal_epoch   2,  Average loss: 0.0053, Accuracy: 180/198 (90.9091%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 4.3012, Accuracy: 3205/10000 (32.0500%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.0054, Accuracy: 767/848 (90.4481%)
___Train Local_ResNet_18,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0040, Accuracy: 782/848 (92.2170%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 7.1829, Accuracy: 2316/10000 (23.1600%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   1,  Average loss: 0.0037, Accuracy: 498/534 (93.2584%)
___Train Local_ResNet_18,  epoch 238, local model 8, internal_epoch   2,  Average loss: 0.0028, Accuracy: 510/534 (95.5056%)
___Test Local_ResNet_18 poisoned: False, epoch: 238: Average loss: 2.1507, Accuracy: 4704/10000 (47.0400%)
time spent on training: 138.34524989128113
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41183408688814627  data num: [526, 527, 496, 546, 447, 601, 364, 198, 848, 534]
[foolsgold agg] considering poison per batch poison_fraction: 0.03217453803813643
[foolsgold agg] wv: [0.84781044 0.         0.2628556  0.         0.6418322  1.
 0.6418322  1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 238: Average loss: 0.6587, Accuracy: 7812/10000 (78.1200%)
___Test Target_ResNet_18 poisoned: True, epoch: 238: Average loss: 6.0011, Accuracy: 315/9000 (3.5000%)
Done in 172.98965907096863 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:239 choose agents : [17, 33, 77, 11, 63, 48, 69, 96, 88, 20]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   1,  Average loss: 0.0118, Accuracy: 465/526 (88.4030%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   2,  Average loss: 0.0100, Accuracy: 467/526 (88.7833%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   3,  Average loss: 0.0058, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 492/526 (93.5361%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   5,  Average loss: 0.0036, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Global model norm: 37.62938129858186.
Norm before scaling: 38.385802696215855. Distance: 9.147337445870946
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.6323, Accuracy: 5117/10000 (51.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.3384, Accuracy: 7967/9000 (88.5222%)
Scaling by  100
Scaled Norm after poisoning: 914.0769250998518, distance: 914.7338069077801
Total norm for 4 adversaries is: 914.0769250998518. distance: 914.7338069077801
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   1,  Average loss: 0.0137, Accuracy: 441/527 (83.6812%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   2,  Average loss: 0.0104, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   3,  Average loss: 0.0086, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   4,  Average loss: 0.0049, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   5,  Average loss: 0.0038, Accuracy: 501/527 (95.0664%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 33, internal_epoch   6,  Average loss: 0.0029, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62938129858186.
Norm before scaling: 38.51944548749453. Distance: 9.752357002389257
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.7324, Accuracy: 4831/10000 (48.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 0.2726, Accuracy: 8161/9000 (90.6778%)
Scaling by  100
Scaled Norm after poisoning: 974.5600930676363, distance: 975.2355805137546
Total norm for 4 adversaries is: 974.5600930676363. distance: 975.2355805137546
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   1,  Average loss: 0.0075, Accuracy: 447/496 (90.1210%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   2,  Average loss: 0.0069, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   3,  Average loss: 0.0038, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   4,  Average loss: 0.0023, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 77, internal_epoch   6,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Global model norm: 37.62938129858186.
Norm before scaling: 37.76508843226605. Distance: 5.859767239475479
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.0157, Accuracy: 6725/10000 (67.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 3.7768, Accuracy: 684/9000 (7.6000%)
Scaling by  100
Scaled Norm after poisoning: 585.1274166794784, distance: 585.9767220205936
Total norm for 4 adversaries is: 585.1274166794784. distance: 585.9767220205936
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   1,  Average loss: 0.0069, Accuracy: 491/546 (89.9267%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   2,  Average loss: 0.0043, Accuracy: 513/546 (93.9560%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   3,  Average loss: 0.0022, Accuracy: 528/546 (96.7033%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 239, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.62938129858186.
Norm before scaling: 37.80907299811201. Distance: 6.278579675702191
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.2897, Accuracy: 6206/10000 (62.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: 4.8222, Accuracy: 166/9000 (1.8444%)
Scaling by  100
Scaled Norm after poisoning: 626.9250603142293, distance: 627.8579656259845
Total norm for 4 adversaries is: 626.9250603142293. distance: 627.8579656259845
___Test Local_ResNet_18 poisoned: True, epoch: 239: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 702/752 (93.3511%)
___Train Local_ResNet_18,  epoch 239, local model 63, internal_epoch   2,  Average loss: 0.0022, Accuracy: 721/752 (95.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 1.7399, Accuracy: 5782/10000 (57.8200%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   1,  Average loss: 0.0056, Accuracy: 333/378 (88.0952%)
___Train Local_ResNet_18,  epoch 239, local model 48, internal_epoch   2,  Average loss: 0.0030, Accuracy: 352/378 (93.1217%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 2.6362, Accuracy: 4266/10000 (42.6600%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   1,  Average loss: 0.0073, Accuracy: 189/216 (87.5000%)
___Train Local_ResNet_18,  epoch 239, local model 69, internal_epoch   2,  Average loss: 0.0016, Accuracy: 213/216 (98.6111%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 12.0598, Accuracy: 1008/10000 (10.0800%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   1,  Average loss: 0.0038, Accuracy: 659/708 (93.0791%)
___Train Local_ResNet_18,  epoch 239, local model 96, internal_epoch   2,  Average loss: 0.0053, Accuracy: 625/708 (88.2768%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.7276, Accuracy: 3643/10000 (36.4300%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.0069, Accuracy: 386/447 (86.3535%)
___Train Local_ResNet_18,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0023, Accuracy: 429/447 (95.9732%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 3.3337, Accuracy: 3674/10000 (36.7400%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   1,  Average loss: 0.0069, Accuracy: 317/362 (87.5691%)
___Train Local_ResNet_18,  epoch 239, local model 20, internal_epoch   2,  Average loss: 0.0018, Accuracy: 351/362 (96.9613%)
___Test Local_ResNet_18 poisoned: False, epoch: 239: Average loss: 6.4447, Accuracy: 2822/10000 (28.2200%)
time spent on training: 137.7898530960083
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4225494150867285  data num: [526, 527, 496, 546, 752, 378, 216, 708, 447, 362]
[foolsgold agg] considering poison per batch poison_fraction: 0.033011673053650666
[foolsgold agg] wv: [0.76394294 0.         0.19746542 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 239: Average loss: 0.6570, Accuracy: 7814/10000 (78.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 239: Average loss: 5.9766, Accuracy: 319/9000 (3.5444%)
Done in 171.78394389152527 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:240 choose agents : [17, 33, 77, 11, 71, 51, 95, 80, 24, 55]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   1,  Average loss: 0.0119, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   2,  Average loss: 0.0116, Accuracy: 448/526 (85.1711%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   3,  Average loss: 0.0075, Accuracy: 479/526 (91.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   4,  Average loss: 0.0045, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   5,  Average loss: 0.0049, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 514/526 (97.7186%), train_poison_data_count: 45
Global model norm: 37.62867571850124.
Norm before scaling: 38.29095062040198. Distance: 9.065673693342385
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.7643, Accuracy: 4614/10000 (46.1400%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.2609, Accuracy: 8181/9000 (90.9000%)
Scaling by  100
Scaled Norm after poisoning: 905.5880340971826, distance: 906.5674271668931
Total norm for 4 adversaries is: 905.5880340971826. distance: 906.5674271668931
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   1,  Average loss: 0.0108, Accuracy: 450/527 (85.3890%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   2,  Average loss: 0.0105, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   3,  Average loss: 0.0061, Accuracy: 477/527 (90.5123%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   4,  Average loss: 0.0034, Accuracy: 499/527 (94.6869%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   5,  Average loss: 0.0028, Accuracy: 505/527 (95.8254%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 33, internal_epoch   6,  Average loss: 0.0016, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.62867571850124.
Norm before scaling: 38.28925458404176. Distance: 8.740118932547665
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.9294, Accuracy: 4728/10000 (47.2800%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 0.6661, Accuracy: 7359/9000 (81.7667%)
Scaling by  100
Scaled Norm after poisoning: 873.3204952936808, distance: 874.0118348741051
Total norm for 4 adversaries is: 873.3204952936808. distance: 874.0118348741051
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   1,  Average loss: 0.0081, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   2,  Average loss: 0.0055, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   3,  Average loss: 0.0041, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   5,  Average loss: 0.0008, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.62867571850124.
Norm before scaling: 37.71568668950544. Distance: 5.646012288127828
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.0081, Accuracy: 6635/10000 (66.3500%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 3.8163, Accuracy: 947/9000 (10.5222%)
Scaling by  100
Scaled Norm after poisoning: 563.6118733224132, distance: 564.6012697027877
Total norm for 4 adversaries is: 563.6118733224132. distance: 564.6012697027877
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   1,  Average loss: 0.0083, Accuracy: 483/546 (88.4615%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   2,  Average loss: 0.0058, Accuracy: 505/546 (92.4908%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   3,  Average loss: 0.0043, Accuracy: 518/546 (94.8718%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 240, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.62867571850124.
Norm before scaling: 37.87305488249941. Distance: 6.827393097573118
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 1.2710, Accuracy: 6158/10000 (61.5800%)
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: 4.9488, Accuracy: 23/9000 (0.2556%)
Scaling by  100
Scaled Norm after poisoning: 681.7129848770669, distance: 682.7392666677375
Total norm for 4 adversaries is: 681.7129848770669. distance: 682.7392666677375
___Test Local_ResNet_18 poisoned: True, epoch: 240: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   1,  Average loss: 0.0047, Accuracy: 1064/1166 (91.2521%)
___Train Local_ResNet_18,  epoch 240, local model 71, internal_epoch   2,  Average loss: 0.0076, Accuracy: 1000/1166 (85.7633%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.8046, Accuracy: 3785/10000 (37.8500%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   1,  Average loss: 0.0035, Accuracy: 447/479 (93.3194%)
___Train Local_ResNet_18,  epoch 240, local model 51, internal_epoch   2,  Average loss: 0.0014, Accuracy: 467/479 (97.4948%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.8979, Accuracy: 3328/10000 (33.2800%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   1,  Average loss: 0.0090, Accuracy: 474/569 (83.3040%)
___Train Local_ResNet_18,  epoch 240, local model 95, internal_epoch   2,  Average loss: 0.0047, Accuracy: 517/569 (90.8612%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.7115, Accuracy: 2551/10000 (25.5100%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   1,  Average loss: 0.0056, Accuracy: 317/363 (87.3278%)
___Train Local_ResNet_18,  epoch 240, local model 80, internal_epoch   2,  Average loss: 0.0010, Accuracy: 357/363 (98.3471%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 2.8720, Accuracy: 4301/10000 (43.0100%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   1,  Average loss: 0.0040, Accuracy: 295/320 (92.1875%)
___Train Local_ResNet_18,  epoch 240, local model 24, internal_epoch   2,  Average loss: 0.0011, Accuracy: 315/320 (98.4375%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 3.5236, Accuracy: 3516/10000 (35.1600%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   1,  Average loss: 0.0047, Accuracy: 271/299 (90.6355%)
___Train Local_ResNet_18,  epoch 240, local model 55, internal_epoch   2,  Average loss: 0.0009, Accuracy: 294/299 (98.3278%)
___Test Local_ResNet_18 poisoned: False, epoch: 240: Average loss: 6.8454, Accuracy: 2075/10000 (20.7500%)
time spent on training: 139.41196250915527
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.395955395955396  data num: [526, 527, 496, 546, 1166, 479, 569, 363, 320, 299]
[foolsgold agg] considering poison per batch poison_fraction: 0.03093401530901531
[foolsgold agg] wv: [1.         0.06028179 0.3504171  0.06028179 1.         0.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 240: Average loss: 0.6573, Accuracy: 7814/10000 (78.1400%)
___Test Target_ResNet_18 poisoned: True, epoch: 240: Average loss: 5.9321, Accuracy: 330/9000 (3.6667%)
Done in 173.55571055412292 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:241 choose agents : [17, 33, 77, 11, 13, 63, 61, 41, 90, 74]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   1,  Average loss: 0.0112, Accuracy: 475/526 (90.3042%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   2,  Average loss: 0.0129, Accuracy: 452/526 (85.9316%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   3,  Average loss: 0.0077, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   4,  Average loss: 0.0035, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Global model norm: 37.62785820227648.
Norm before scaling: 38.271916910751116. Distance: 8.717676677745903
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.6965, Accuracy: 4810/10000 (48.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.2227, Accuracy: 8278/9000 (91.9778%)
Scaling by  100
Scaled Norm after poisoning: 871.0243251482705, distance: 871.7676367587868
Total norm for 4 adversaries is: 871.0243251482705. distance: 871.7676367587868
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   1,  Average loss: 0.0146, Accuracy: 440/527 (83.4915%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   2,  Average loss: 0.0132, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   3,  Average loss: 0.0084, Accuracy: 466/527 (88.4250%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   4,  Average loss: 0.0054, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 519/527 (98.4820%), train_poison_data_count: 45
Global model norm: 37.62785820227648.
Norm before scaling: 38.904136802550475. Distance: 11.064661881580971
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.9352, Accuracy: 4510/10000 (45.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 0.6809, Accuracy: 7177/9000 (79.7444%)
Scaling by  100
Scaled Norm after poisoning: 1105.98728518912, distance: 1106.4660523486475
Total norm for 4 adversaries is: 1105.98728518912. distance: 1106.4660523486475
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   1,  Average loss: 0.0074, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   2,  Average loss: 0.0065, Accuracy: 451/496 (90.9274%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 474/496 (95.5645%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 483/496 (97.3790%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62785820227648.
Norm before scaling: 37.78744165817941. Distance: 5.92421480923481
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.0305, Accuracy: 6618/10000 (66.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 3.7366, Accuracy: 658/9000 (7.3111%)
Scaling by  100
Scaled Norm after poisoning: 591.6695129039522, distance: 592.4214346645468
Total norm for 4 adversaries is: 591.6695129039522. distance: 592.4214346645468
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   1,  Average loss: 0.0070, Accuracy: 489/546 (89.5604%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 529/546 (96.8864%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 241, local model 11, internal_epoch   6,  Average loss: 0.0009, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.62785820227648.
Norm before scaling: 37.80443967551546. Distance: 6.343848617614006
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.3516, Accuracy: 5913/10000 (59.1300%)
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: 4.2023, Accuracy: 124/9000 (1.3778%)
Scaling by  100
Scaled Norm after poisoning: 633.3778986513502, distance: 634.3848398251648
Total norm for 4 adversaries is: 633.3778986513502. distance: 634.3848398251648
___Test Local_ResNet_18 poisoned: True, epoch: 241: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   1,  Average loss: 0.0039, Accuracy: 570/620 (91.9355%)
___Train Local_ResNet_18,  epoch 241, local model 13, internal_epoch   2,  Average loss: 0.0030, Accuracy: 590/620 (95.1613%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.9631, Accuracy: 4343/10000 (43.4300%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   1,  Average loss: 0.0024, Accuracy: 718/752 (95.4787%)
___Train Local_ResNet_18,  epoch 241, local model 63, internal_epoch   2,  Average loss: 0.0018, Accuracy: 727/752 (96.6755%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 1.4896, Accuracy: 6078/10000 (60.7800%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   1,  Average loss: 0.0039, Accuracy: 541/590 (91.6949%)
___Train Local_ResNet_18,  epoch 241, local model 61, internal_epoch   2,  Average loss: 0.0060, Accuracy: 539/590 (91.3559%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.2743, Accuracy: 3150/10000 (31.5000%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   1,  Average loss: 0.0079, Accuracy: 431/513 (84.0156%)
___Train Local_ResNet_18,  epoch 241, local model 41, internal_epoch   2,  Average loss: 0.0246, Accuracy: 474/513 (92.3977%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 4.6042, Accuracy: 3455/10000 (34.5500%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   1,  Average loss: 0.0090, Accuracy: 518/578 (89.6194%)
___Train Local_ResNet_18,  epoch 241, local model 90, internal_epoch   2,  Average loss: 0.0186, Accuracy: 417/578 (72.1453%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 44.4843, Accuracy: 1001/10000 (10.0100%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   1,  Average loss: 0.0044, Accuracy: 434/469 (92.5373%)
___Train Local_ResNet_18,  epoch 241, local model 74, internal_epoch   2,  Average loss: 0.0028, Accuracy: 443/469 (94.4563%)
___Test Local_ResNet_18 poisoned: False, epoch: 241: Average loss: 2.5187, Accuracy: 4274/10000 (42.7400%)
time spent on training: 136.21201610565186
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.372974897632188  data num: [526, 527, 496, 546, 620, 752, 590, 513, 578, 469]
[foolsgold agg] considering poison per batch poison_fraction: 0.029138663877514688
[foolsgold agg] wv: [0.64390592 0.         0.11828787 0.         1.         0.08717327
 1.         1.         1.         0.08717327]
___Test Target_ResNet_18 poisoned: False, epoch: 241: Average loss: 0.6551, Accuracy: 7822/10000 (78.2200%)
___Test Target_ResNet_18 poisoned: True, epoch: 241: Average loss: 5.8876, Accuracy: 339/9000 (3.7667%)
Done in 170.3528597354889 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:242 choose agents : [17, 33, 77, 11, 85, 14, 21, 78, 1, 2]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   1,  Average loss: 0.0113, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   2,  Average loss: 0.0117, Accuracy: 442/526 (84.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   3,  Average loss: 0.0078, Accuracy: 476/526 (90.4943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   4,  Average loss: 0.0052, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   5,  Average loss: 0.0037, Accuracy: 503/526 (95.6274%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 17, internal_epoch   6,  Average loss: 0.0040, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 37.626503746424376.
Norm before scaling: 38.62626097759625. Distance: 9.976318165200064
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.5926, Accuracy: 5185/10000 (51.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.2120, Accuracy: 8299/9000 (92.2111%)
Scaling by  100
Scaled Norm after poisoning: 997.173756172915, distance: 997.6317268912412
Total norm for 4 adversaries is: 997.173756172915. distance: 997.6317268912412
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   1,  Average loss: 0.0144, Accuracy: 436/527 (82.7324%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   2,  Average loss: 0.0091, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   3,  Average loss: 0.0091, Accuracy: 469/527 (88.9943%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   4,  Average loss: 0.0041, Accuracy: 500/527 (94.8767%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   5,  Average loss: 0.0020, Accuracy: 515/527 (97.7230%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 33, internal_epoch   6,  Average loss: 0.0020, Accuracy: 513/527 (97.3435%), train_poison_data_count: 45
Global model norm: 37.626503746424376.
Norm before scaling: 38.26108525030687. Distance: 8.927675622960805
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.6483, Accuracy: 5094/10000 (50.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 0.2082, Accuracy: 8350/9000 (92.7778%)
Scaling by  100
Scaled Norm after poisoning: 891.7930323230834, distance: 892.7675719357195
Total norm for 4 adversaries is: 891.7930323230834. distance: 892.7675719357195
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   1,  Average loss: 0.0080, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   3,  Average loss: 0.0026, Accuracy: 477/496 (96.1694%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 77, internal_epoch   6,  Average loss: 0.0003, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.626503746424376.
Norm before scaling: 37.74240985884612. Distance: 5.66259679311588
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.0071, Accuracy: 6821/10000 (68.2100%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 4.2291, Accuracy: 338/9000 (3.7556%)
Scaling by  100
Scaled Norm after poisoning: 565.4492130156342, distance: 566.259712940979
Total norm for 4 adversaries is: 565.4492130156342. distance: 566.259712940979
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   1,  Average loss: 0.0089, Accuracy: 478/546 (87.5458%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   2,  Average loss: 0.0055, Accuracy: 502/546 (91.9414%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 524/546 (95.9707%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 536/546 (98.1685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   5,  Average loss: 0.0007, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 242, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 544/546 (99.6337%), train_poison_data_count: 45
Global model norm: 37.626503746424376.
Norm before scaling: 37.893194178362194. Distance: 6.794459262241534
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 1.4085, Accuracy: 5703/10000 (57.0300%)
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: 4.8704, Accuracy: 141/9000 (1.5667%)
Scaling by  100
Scaled Norm after poisoning: 678.5721452063885, distance: 679.4458909655721
Total norm for 4 adversaries is: 678.5721452063885. distance: 679.4458909655721
___Test Local_ResNet_18 poisoned: True, epoch: 242: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   1,  Average loss: 0.0068, Accuracy: 310/364 (85.1648%)
___Train Local_ResNet_18,  epoch 242, local model 85, internal_epoch   2,  Average loss: 0.0027, Accuracy: 343/364 (94.2308%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.9989, Accuracy: 2594/10000 (25.9400%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   1,  Average loss: 0.0083, Accuracy: 263/318 (82.7044%)
___Train Local_ResNet_18,  epoch 242, local model 14, internal_epoch   2,  Average loss: 0.0015, Accuracy: 310/318 (97.4843%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 10.5238, Accuracy: 1766/10000 (17.6600%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   1,  Average loss: 0.0043, Accuracy: 241/262 (91.9847%)
___Train Local_ResNet_18,  epoch 242, local model 21, internal_epoch   2,  Average loss: 0.0038, Accuracy: 259/262 (98.8550%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 3.8385, Accuracy: 3267/10000 (32.6700%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   1,  Average loss: 0.0049, Accuracy: 227/255 (89.0196%)
___Train Local_ResNet_18,  epoch 242, local model 78, internal_epoch   2,  Average loss: 0.0010, Accuracy: 250/255 (98.0392%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 2.7401, Accuracy: 4442/10000 (44.4200%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   1,  Average loss: 0.0072, Accuracy: 593/641 (92.5117%)
___Train Local_ResNet_18,  epoch 242, local model 1, internal_epoch   2,  Average loss: 0.0113, Accuracy: 556/641 (86.7395%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 4.7124, Accuracy: 4092/10000 (40.9200%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   1,  Average loss: 0.0079, Accuracy: 398/461 (86.3341%)
___Train Local_ResNet_18,  epoch 242, local model 2, internal_epoch   2,  Average loss: 0.0063, Accuracy: 409/461 (88.7202%)
___Test Local_ResNet_18 poisoned: False, epoch: 242: Average loss: 11.0580, Accuracy: 2097/10000 (20.9700%)
time spent on training: 137.51688957214355
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4765696087352138  data num: [526, 527, 496, 546, 364, 318, 262, 255, 641, 461]
[foolsgold agg] considering poison per batch poison_fraction: 0.03723200068243858
[foolsgold agg] wv: [0.7267557  0.         0.17192795 0.         1.         0.82237337
 1.         1.         1.         0.45411878]
___Test Target_ResNet_18 poisoned: False, epoch: 242: Average loss: 0.6542, Accuracy: 7825/10000 (78.2500%)
___Test Target_ResNet_18 poisoned: True, epoch: 242: Average loss: 5.8837, Accuracy: 342/9000 (3.8000%)
Done in 172.095232963562 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:243 choose agents : [17, 33, 77, 11, 9, 5, 16, 36, 94, 57]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   1,  Average loss: 0.0112, Accuracy: 474/526 (90.1141%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   2,  Average loss: 0.0112, Accuracy: 455/526 (86.5019%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   4,  Average loss: 0.0027, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   5,  Average loss: 0.0024, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.62549314460875.
Norm before scaling: 38.13742433313536. Distance: 8.209198830249534
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.7587, Accuracy: 4755/10000 (47.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.0308, Accuracy: 8919/9000 (99.1000%)
Scaling by  100
Scaled Norm after poisoning: 820.0393283251725, distance: 820.9199108317449
Total norm for 4 adversaries is: 820.0393283251725. distance: 820.9199108317449
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   1,  Average loss: 0.0136, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   2,  Average loss: 0.0108, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   3,  Average loss: 0.0073, Accuracy: 474/527 (89.9431%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   4,  Average loss: 0.0033, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   5,  Average loss: 0.0027, Accuracy: 510/527 (96.7742%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 33, internal_epoch   6,  Average loss: 0.0029, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Global model norm: 37.62549314460875.
Norm before scaling: 38.539595418725696. Distance: 9.964569267461346
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.8745, Accuracy: 4904/10000 (49.0400%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 0.3417, Accuracy: 8014/9000 (89.0444%)
Scaling by  100
Scaled Norm after poisoning: 995.6781608531945, distance: 996.4570048426575
Total norm for 4 adversaries is: 995.6781608531945. distance: 996.4570048426575
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   1,  Average loss: 0.0072, Accuracy: 449/496 (90.5242%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 462/496 (93.1452%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 77, internal_epoch   6,  Average loss: 0.0002, Accuracy: 495/496 (99.7984%), train_poison_data_count: 40
Global model norm: 37.62549314460875.
Norm before scaling: 37.77007886438516. Distance: 5.782698496220719
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.9892, Accuracy: 6743/10000 (67.4300%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 4.1800, Accuracy: 516/9000 (5.7333%)
Scaling by  100
Scaled Norm after poisoning: 577.5447764026612, distance: 578.2699412903977
Total norm for 4 adversaries is: 577.5447764026612. distance: 578.2699412903977
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   1,  Average loss: 0.0072, Accuracy: 490/546 (89.7436%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   2,  Average loss: 0.0066, Accuracy: 497/546 (91.0256%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   3,  Average loss: 0.0036, Accuracy: 519/546 (95.0549%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   4,  Average loss: 0.0026, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   5,  Average loss: 0.0015, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 243, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Global model norm: 37.62549314460875.
Norm before scaling: 37.87967786448543. Distance: 6.768959826935884
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.3617, Accuracy: 5890/10000 (58.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: 4.9412, Accuracy: 110/9000 (1.2222%)
Scaling by  100
Scaled Norm after poisoning: 675.9742506190602, distance: 676.8959715126099
Total norm for 4 adversaries is: 675.9742506190602. distance: 676.8959715126099
___Test Local_ResNet_18 poisoned: True, epoch: 243: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   1,  Average loss: 0.0039, Accuracy: 340/368 (92.3913%)
___Train Local_ResNet_18,  epoch 243, local model 9, internal_epoch   2,  Average loss: 0.0012, Accuracy: 360/368 (97.8261%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 7.6641, Accuracy: 2101/10000 (21.0100%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   1,  Average loss: 0.0022, Accuracy: 349/365 (95.6164%)
___Train Local_ResNet_18,  epoch 243, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 362/365 (99.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 1.2078, Accuracy: 6608/10000 (66.0800%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   1,  Average loss: 0.0060, Accuracy: 714/773 (92.3674%)
___Train Local_ResNet_18,  epoch 243, local model 16, internal_epoch   2,  Average loss: 0.0237, Accuracy: 458/773 (59.2497%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 40.1986, Accuracy: 1381/10000 (13.8100%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   1,  Average loss: 0.0069, Accuracy: 736/849 (86.6902%)
___Train Local_ResNet_18,  epoch 243, local model 36, internal_epoch   2,  Average loss: 0.0152, Accuracy: 606/849 (71.3781%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 34.6303, Accuracy: 1908/10000 (19.0800%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   1,  Average loss: 0.0080, Accuracy: 171/203 (84.2365%)
___Train Local_ResNet_18,  epoch 243, local model 94, internal_epoch   2,  Average loss: 0.0018, Accuracy: 202/203 (99.5074%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 3.4247, Accuracy: 3499/10000 (34.9900%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   1,  Average loss: 0.0054, Accuracy: 256/290 (88.2759%)
___Train Local_ResNet_18,  epoch 243, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 286/290 (98.6207%)
___Test Local_ResNet_18 poisoned: False, epoch: 243: Average loss: 3.6918, Accuracy: 4125/10000 (41.2500%)
time spent on training: 137.10213708877563
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.42383168116528425  data num: [526, 527, 496, 546, 368, 365, 773, 849, 203, 290]
[foolsgold agg] considering poison per batch poison_fraction: 0.03311185009103783
[foolsgold agg] wv: [0.78995006 0.         0.         0.         1.         0.92808605
 0.79442061 0.79442061 0.92808605 0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 243: Average loss: 0.6531, Accuracy: 7834/10000 (78.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 243: Average loss: 5.8664, Accuracy: 356/9000 (3.9556%)
Done in 171.37087392807007 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:244 choose agents : [17, 33, 77, 11, 63, 92, 28, 56, 44, 40]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   1,  Average loss: 0.0103, Accuracy: 480/526 (91.2548%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   2,  Average loss: 0.0128, Accuracy: 454/526 (86.3118%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   3,  Average loss: 0.0084, Accuracy: 470/526 (89.3536%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   4,  Average loss: 0.0035, Accuracy: 497/526 (94.4867%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   5,  Average loss: 0.0040, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.62467069259959.
Norm before scaling: 38.37866272982538. Distance: 9.265291513549624
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5972, Accuracy: 5212/10000 (52.1200%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.3253, Accuracy: 7996/9000 (88.8444%)
Scaling by  100
Scaled Norm after poisoning: 925.7527342654732, distance: 926.5292426577803
Total norm for 4 adversaries is: 925.7527342654732. distance: 926.5292426577803
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   1,  Average loss: 0.0129, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   2,  Average loss: 0.0120, Accuracy: 456/527 (86.5275%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   3,  Average loss: 0.0074, Accuracy: 481/527 (91.2713%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   4,  Average loss: 0.0064, Accuracy: 478/527 (90.7021%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   5,  Average loss: 0.0031, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.62467069259959.
Norm before scaling: 38.78095411853285. Distance: 10.625253831411916
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.7659, Accuracy: 4555/10000 (45.5500%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 0.2857, Accuracy: 8123/9000 (90.2556%)
Scaling by  100
Scaled Norm after poisoning: 1062.0362517353162, distance: 1062.5254702829482
Total norm for 4 adversaries is: 1062.0362517353162. distance: 1062.5254702829482
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   1,  Average loss: 0.0063, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   2,  Average loss: 0.0056, Accuracy: 458/496 (92.3387%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   3,  Average loss: 0.0033, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   5,  Average loss: 0.0012, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62467069259959.
Norm before scaling: 37.71411205433419. Distance: 5.546220595750634
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 0.9976, Accuracy: 6677/10000 (66.7700%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 3.5352, Accuracy: 919/9000 (10.2111%)
Scaling by  100
Scaled Norm after poisoning: 553.7319127971585, distance: 554.6220278261584
Total norm for 4 adversaries is: 553.7319127971585. distance: 554.6220278261584
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   2,  Average loss: 0.0037, Accuracy: 522/546 (95.6044%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   3,  Average loss: 0.0017, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   4,  Average loss: 0.0015, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   5,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 244, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.62467069259959.
Norm before scaling: 37.806209122870115. Distance: 6.250397326237737
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.3127, Accuracy: 6171/10000 (61.7100%)
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: 4.7240, Accuracy: 122/9000 (1.3556%)
Scaling by  100
Scaled Norm after poisoning: 624.1417607402985, distance: 625.0398237312563
Total norm for 4 adversaries is: 624.1417607402985. distance: 625.0398237312563
___Test Local_ResNet_18 poisoned: True, epoch: 244: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   1,  Average loss: 0.0028, Accuracy: 708/752 (94.1489%)
___Train Local_ResNet_18,  epoch 244, local model 63, internal_epoch   2,  Average loss: 0.0021, Accuracy: 721/752 (95.8777%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5126, Accuracy: 5852/10000 (58.5200%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   1,  Average loss: 0.0070, Accuracy: 696/796 (87.4372%)
___Train Local_ResNet_18,  epoch 244, local model 92, internal_epoch   2,  Average loss: 0.0096, Accuracy: 653/796 (82.0352%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 6.0064, Accuracy: 3444/10000 (34.4400%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   1,  Average loss: 0.0023, Accuracy: 402/423 (95.0355%)
___Train Local_ResNet_18,  epoch 244, local model 28, internal_epoch   2,  Average loss: 0.0016, Accuracy: 412/423 (97.3995%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.1932, Accuracy: 6508/10000 (65.0800%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   1,  Average loss: 0.0018, Accuracy: 724/743 (97.4428%)
___Train Local_ResNet_18,  epoch 244, local model 56, internal_epoch   2,  Average loss: 0.0012, Accuracy: 730/743 (98.2503%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.5033, Accuracy: 6179/10000 (61.7900%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   1,  Average loss: 0.0054, Accuracy: 395/436 (90.5963%)
___Train Local_ResNet_18,  epoch 244, local model 44, internal_epoch   2,  Average loss: 0.0022, Accuracy: 420/436 (96.3303%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 1.6977, Accuracy: 5336/10000 (53.3600%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   1,  Average loss: 0.0062, Accuracy: 571/652 (87.5767%)
___Train Local_ResNet_18,  epoch 244, local model 40, internal_epoch   2,  Average loss: 0.0065, Accuracy: 581/652 (89.1104%)
___Test Local_ResNet_18 poisoned: False, epoch: 244: Average loss: 3.9553, Accuracy: 3217/10000 (32.1700%)
time spent on training: 137.50558972358704
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.3552653891809395  data num: [526, 527, 496, 546, 752, 796, 423, 743, 436, 652]
[foolsgold agg] considering poison per batch poison_fraction: 0.027755108529760895
[foolsgold agg] wv: [0.57251945 0.         0.         0.         1.         1.
 1.         1.         1.         0.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 244: Average loss: 0.6529, Accuracy: 7838/10000 (78.3800%)
___Test Target_ResNet_18 poisoned: True, epoch: 244: Average loss: 5.8597, Accuracy: 361/9000 (4.0111%)
Done in 172.0963933467865 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:245 choose agents : [17, 33, 77, 11, 74, 85, 2, 99, 35, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   1,  Average loss: 0.0108, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   2,  Average loss: 0.0126, Accuracy: 445/526 (84.6008%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   3,  Average loss: 0.0072, Accuracy: 477/526 (90.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   4,  Average loss: 0.0036, Accuracy: 502/526 (95.4373%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   5,  Average loss: 0.0027, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 17, internal_epoch   6,  Average loss: 0.0025, Accuracy: 512/526 (97.3384%), train_poison_data_count: 45
Global model norm: 37.62403640273562.
Norm before scaling: 38.35956593638834. Distance: 9.050394747223262
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.7207, Accuracy: 4962/10000 (49.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 0.3399, Accuracy: 7942/9000 (88.2444%)
Scaling by  100
Scaled Norm after poisoning: 904.3836644367257, distance: 905.0394673714511
Total norm for 4 adversaries is: 904.3836644367257. distance: 905.0394673714511
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   1,  Average loss: 0.0124, Accuracy: 443/527 (84.0607%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   2,  Average loss: 0.0117, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   3,  Average loss: 0.0065, Accuracy: 470/527 (89.1841%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   4,  Average loss: 0.0053, Accuracy: 492/527 (93.3586%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   5,  Average loss: 0.0055, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 33, internal_epoch   6,  Average loss: 0.0049, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Global model norm: 37.62403640273562.
Norm before scaling: 39.136208583173016. Distance: 11.649079354381938
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.9780, Accuracy: 4585/10000 (45.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 1.1472, Accuracy: 6436/9000 (71.5111%)
Scaling by  100
Scaled Norm after poisoning: 1164.673022783648, distance: 1164.9077753195743
Total norm for 4 adversaries is: 1164.673022783648. distance: 1164.9077753195743
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   1,  Average loss: 0.0076, Accuracy: 454/496 (91.5323%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   2,  Average loss: 0.0059, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   4,  Average loss: 0.0020, Accuracy: 482/496 (97.1774%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   5,  Average loss: 0.0011, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62403640273562.
Norm before scaling: 37.70868043406087. Distance: 5.52622973535218
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.0192, Accuracy: 6624/10000 (66.2400%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 3.3600, Accuracy: 1004/9000 (11.1556%)
Scaling by  100
Scaled Norm after poisoning: 551.7168941132762, distance: 552.6230066691035
Total norm for 4 adversaries is: 551.7168941132762. distance: 552.6230066691035
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 496/546 (90.8425%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   2,  Average loss: 0.0047, Accuracy: 516/546 (94.5055%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   3,  Average loss: 0.0024, Accuracy: 532/546 (97.4359%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   4,  Average loss: 0.0016, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   5,  Average loss: 0.0011, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 245, local model 11, internal_epoch   6,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Global model norm: 37.62403640273562.
Norm before scaling: 37.758016985531526. Distance: 6.102175790440768
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 1.2370, Accuracy: 6184/10000 (61.8400%)
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: 3.5886, Accuracy: 655/9000 (7.2778%)
Scaling by  100
Scaled Norm after poisoning: 609.1530236730341, distance: 610.2176097508167
Total norm for 4 adversaries is: 609.1530236730341. distance: 610.2176097508167
___Test Local_ResNet_18 poisoned: True, epoch: 245: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   1,  Average loss: 0.0036, Accuracy: 438/469 (93.3902%)
___Train Local_ResNet_18,  epoch 245, local model 74, internal_epoch   2,  Average loss: 0.0020, Accuracy: 451/469 (96.1620%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 3.7432, Accuracy: 3716/10000 (37.1600%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   1,  Average loss: 0.0067, Accuracy: 315/364 (86.5385%)
___Train Local_ResNet_18,  epoch 245, local model 85, internal_epoch   2,  Average loss: 0.0040, Accuracy: 341/364 (93.6813%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 4.9140, Accuracy: 2454/10000 (24.5400%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   1,  Average loss: 0.0099, Accuracy: 383/461 (83.0803%)
___Train Local_ResNet_18,  epoch 245, local model 2, internal_epoch   2,  Average loss: 0.0097, Accuracy: 405/461 (87.8525%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 5.9243, Accuracy: 2346/10000 (23.4600%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   1,  Average loss: 0.0056, Accuracy: 359/391 (91.8159%)
___Train Local_ResNet_18,  epoch 245, local model 99, internal_epoch   2,  Average loss: 0.0084, Accuracy: 347/391 (88.7468%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 8.6295, Accuracy: 1970/10000 (19.7000%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   1,  Average loss: 0.0062, Accuracy: 373/419 (89.0215%)
___Train Local_ResNet_18,  epoch 245, local model 35, internal_epoch   2,  Average loss: 0.0022, Accuracy: 403/419 (96.1814%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 4.2767, Accuracy: 3231/10000 (32.3100%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   1,  Average loss: 0.0029, Accuracy: 576/610 (94.4262%)
___Train Local_ResNet_18,  epoch 245, local model 70, internal_epoch   2,  Average loss: 0.0017, Accuracy: 591/610 (96.8852%)
___Test Local_ResNet_18 poisoned: False, epoch: 245: Average loss: 2.1071, Accuracy: 4833/10000 (48.3300%)
time spent on training: 138.30172848701477
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.4356415055105011  data num: [526, 527, 496, 546, 469, 364, 461, 391, 419, 610]
[foolsgold agg] considering poison per batch poison_fraction: 0.0340344926180079
[foolsgold agg] wv: [1.         0.10105413 0.44357886 0.10105413 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 245: Average loss: 0.6542, Accuracy: 7834/10000 (78.3400%)
___Test Target_ResNet_18 poisoned: True, epoch: 245: Average loss: 5.8130, Accuracy: 366/9000 (4.0667%)
Done in 173.2729573249817 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:246 choose agents : [17, 33, 77, 11, 88, 50, 86, 60, 41, 79]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   1,  Average loss: 0.0119, Accuracy: 472/526 (89.7338%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   2,  Average loss: 0.0113, Accuracy: 449/526 (85.3612%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   3,  Average loss: 0.0069, Accuracy: 481/526 (91.4449%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   4,  Average loss: 0.0037, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   5,  Average loss: 0.0023, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 17, internal_epoch   6,  Average loss: 0.0016, Accuracy: 519/526 (98.6692%), train_poison_data_count: 45
Global model norm: 37.62366328605576.
Norm before scaling: 38.41528194246074. Distance: 9.254749213004395
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.7181, Accuracy: 4916/10000 (49.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.2218, Accuracy: 8441/9000 (93.7889%)
Scaling by  100
Scaled Norm after poisoning: 924.8642130064283, distance: 925.4749794024688
Total norm for 4 adversaries is: 924.8642130064283. distance: 925.4749794024688
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   1,  Average loss: 0.0131, Accuracy: 448/527 (85.0095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   2,  Average loss: 0.0130, Accuracy: 452/527 (85.7685%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   3,  Average loss: 0.0055, Accuracy: 488/527 (92.5996%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   4,  Average loss: 0.0033, Accuracy: 496/527 (94.1176%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   5,  Average loss: 0.0026, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 33, internal_epoch   6,  Average loss: 0.0019, Accuracy: 517/527 (98.1025%), train_poison_data_count: 45
Global model norm: 37.62366328605576.
Norm before scaling: 38.44255556183798. Distance: 9.516873282501733
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.9477, Accuracy: 4310/10000 (43.1000%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 0.0361, Accuracy: 8937/9000 (99.3000%)
Scaling by  100
Scaled Norm after poisoning: 950.9448919364361, distance: 951.6872845110415
Total norm for 4 adversaries is: 950.9448919364361. distance: 951.6872845110415
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   1,  Average loss: 0.0087, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   2,  Average loss: 0.0058, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   3,  Average loss: 0.0040, Accuracy: 472/496 (95.1613%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 488/496 (98.3871%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62366328605576.
Norm before scaling: 37.71761726758134. Distance: 5.591845651747619
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.9483, Accuracy: 6831/10000 (68.3100%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 4.0039, Accuracy: 736/9000 (8.1778%)
Scaling by  100
Scaled Norm after poisoning: 558.2865807540066, distance: 559.1845625551549
Total norm for 4 adversaries is: 558.2865807540066. distance: 559.1845625551549
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   1,  Average loss: 0.0065, Accuracy: 492/546 (90.1099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   2,  Average loss: 0.0044, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 526/546 (96.3370%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   4,  Average loss: 0.0010, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   5,  Average loss: 0.0010, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 246, local model 11, internal_epoch   6,  Average loss: 0.0014, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.62366328605576.
Norm before scaling: 37.8142722983416. Distance: 6.358718125818543
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.2959, Accuracy: 6181/10000 (61.8100%)
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: 5.2892, Accuracy: 62/9000 (0.6889%)
Scaling by  100
Scaled Norm after poisoning: 634.9355282231418, distance: 635.8718424336778
Total norm for 4 adversaries is: 634.9355282231418. distance: 635.8718424336778
___Test Local_ResNet_18 poisoned: True, epoch: 246: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   1,  Average loss: 0.0071, Accuracy: 383/447 (85.6823%)
___Train Local_ResNet_18,  epoch 246, local model 88, internal_epoch   2,  Average loss: 0.0028, Accuracy: 420/447 (93.9597%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 5.0298, Accuracy: 3014/10000 (30.1400%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   1,  Average loss: 0.0028, Accuracy: 382/401 (95.2618%)
___Train Local_ResNet_18,  epoch 246, local model 50, internal_epoch   2,  Average loss: 0.0015, Accuracy: 391/401 (97.5062%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.6043, Accuracy: 4613/10000 (46.1300%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   1,  Average loss: 0.0035, Accuracy: 200/212 (94.3396%)
___Train Local_ResNet_18,  epoch 246, local model 86, internal_epoch   2,  Average loss: 0.0009, Accuracy: 211/212 (99.5283%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.1022, Accuracy: 6875/10000 (68.7500%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   1,  Average loss: 0.0043, Accuracy: 261/284 (91.9014%)
___Train Local_ResNet_18,  epoch 246, local model 60, internal_epoch   2,  Average loss: 0.0013, Accuracy: 280/284 (98.5915%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 2.0093, Accuracy: 5024/10000 (50.2400%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   1,  Average loss: 0.0088, Accuracy: 422/513 (82.2612%)
___Train Local_ResNet_18,  epoch 246, local model 41, internal_epoch   2,  Average loss: 0.0045, Accuracy: 475/513 (92.5926%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 3.5235, Accuracy: 3663/10000 (36.6300%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   1,  Average loss: 0.0062, Accuracy: 133/154 (86.3636%)
___Train Local_ResNet_18,  epoch 246, local model 79, internal_epoch   2,  Average loss: 0.0004, Accuracy: 154/154 (100.0000%)
___Test Local_ResNet_18 poisoned: False, epoch: 246: Average loss: 1.0606, Accuracy: 6828/10000 (68.2800%)
time spent on training: 136.91621017456055
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5102289332683877  data num: [526, 527, 496, 546, 447, 401, 212, 284, 513, 154]
[foolsgold agg] considering poison per batch poison_fraction: 0.03986163541159279
[foolsgold agg] wv: [0.59484865 0.         0.06433266 0.         1.         1.
 0.97313627 1.         1.         0.97313627]
___Test Target_ResNet_18 poisoned: False, epoch: 246: Average loss: 0.6541, Accuracy: 7843/10000 (78.4300%)
___Test Target_ResNet_18 poisoned: True, epoch: 246: Average loss: 5.7888, Accuracy: 373/9000 (4.1444%)
Done in 171.34141373634338 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:247 choose agents : [17, 33, 77, 11, 76, 67, 9, 40, 72, 44]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   1,  Average loss: 0.0105, Accuracy: 479/526 (91.0646%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   2,  Average loss: 0.0097, Accuracy: 464/526 (88.2129%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   3,  Average loss: 0.0070, Accuracy: 487/526 (92.5856%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   4,  Average loss: 0.0029, Accuracy: 506/526 (96.1977%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   5,  Average loss: 0.0026, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Global model norm: 37.62244819783047.
Norm before scaling: 38.198849454000246. Distance: 8.47872641230433
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.7609, Accuracy: 4925/10000 (49.2500%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.1972, Accuracy: 8308/9000 (92.3111%)
Scaling by  100
Scaled Norm after poisoning: 847.0448630385524, distance: 847.8727425150546
Total norm for 4 adversaries is: 847.0448630385524. distance: 847.8727425150546
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   1,  Average loss: 0.0124, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   2,  Average loss: 0.0111, Accuracy: 446/527 (84.6300%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   3,  Average loss: 0.0057, Accuracy: 485/527 (92.0304%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   5,  Average loss: 0.0034, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 33, internal_epoch   6,  Average loss: 0.0031, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.62244819783047.
Norm before scaling: 38.451582151088076. Distance: 9.562589757161474
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.7683, Accuracy: 4848/10000 (48.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 0.4491, Accuracy: 7745/9000 (86.0556%)
Scaling by  100
Scaled Norm after poisoning: 955.5156657533146, distance: 956.2590522447356
Total norm for 4 adversaries is: 955.5156657533146. distance: 956.2590522447356
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   1,  Average loss: 0.0081, Accuracy: 440/496 (88.7097%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 453/496 (91.3306%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 475/496 (95.7661%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   4,  Average loss: 0.0017, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   5,  Average loss: 0.0007, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 77, internal_epoch   6,  Average loss: 0.0006, Accuracy: 492/496 (99.1935%), train_poison_data_count: 40
Global model norm: 37.62244819783047.
Norm before scaling: 37.81407860857679. Distance: 6.040353496388115
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.0017, Accuracy: 6717/10000 (67.1700%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 3.7731, Accuracy: 589/9000 (6.5444%)
Scaling by  100
Scaled Norm after poisoning: 603.3830665505952, distance: 604.0353621684744
Total norm for 4 adversaries is: 603.3830665505952. distance: 604.0353621684744
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   1,  Average loss: 0.0066, Accuracy: 493/546 (90.2930%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   2,  Average loss: 0.0049, Accuracy: 514/546 (94.1392%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 247, local model 11, internal_epoch   6,  Average loss: 0.0010, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Global model norm: 37.62244819783047.
Norm before scaling: 37.78799406051064. Distance: 6.137861178272933
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.3095, Accuracy: 6085/10000 (60.8500%)
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: 5.6355, Accuracy: 32/9000 (0.3556%)
Scaling by  100
Scaled Norm after poisoning: 612.8865361957301, distance: 613.7861751049791
Total norm for 4 adversaries is: 612.8865361957301. distance: 613.7861751049791
___Test Local_ResNet_18 poisoned: True, epoch: 247: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   1,  Average loss: 0.0367, Accuracy: 61/65 (93.8462%)
___Train Local_ResNet_18,  epoch 247, local model 76, internal_epoch   2,  Average loss: 0.0435, Accuracy: 64/65 (98.4615%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 1.4171, Accuracy: 6016/10000 (60.1600%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   1,  Average loss: 0.0035, Accuracy: 776/842 (92.1615%)
___Train Local_ResNet_18,  epoch 247, local model 67, internal_epoch   2,  Average loss: 0.0070, Accuracy: 737/842 (87.5297%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 13.3624, Accuracy: 1914/10000 (19.1400%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   1,  Average loss: 0.0040, Accuracy: 337/368 (91.5761%)
___Train Local_ResNet_18,  epoch 247, local model 9, internal_epoch   2,  Average loss: 0.0007, Accuracy: 365/368 (99.1848%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 4.7984, Accuracy: 2953/10000 (29.5300%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   1,  Average loss: 0.0058, Accuracy: 583/652 (89.4172%)
___Train Local_ResNet_18,  epoch 247, local model 40, internal_epoch   2,  Average loss: 0.0102, Accuracy: 535/652 (82.0552%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 22.4341, Accuracy: 1606/10000 (16.0600%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   1,  Average loss: 0.0074, Accuracy: 536/618 (86.7314%)
___Train Local_ResNet_18,  epoch 247, local model 72, internal_epoch   2,  Average loss: 0.0065, Accuracy: 559/618 (90.4531%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 4.0747, Accuracy: 3961/10000 (39.6100%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   1,  Average loss: 0.0034, Accuracy: 401/436 (91.9725%)
___Train Local_ResNet_18,  epoch 247, local model 44, internal_epoch   2,  Average loss: 0.0014, Accuracy: 423/436 (97.0183%)
___Test Local_ResNet_18 poisoned: False, epoch: 247: Average loss: 2.3125, Accuracy: 4753/10000 (47.5300%)
time spent on training: 140.87756156921387
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.41272655634357763  data num: [526, 527, 496, 546, 65, 842, 368, 652, 618, 436]
[foolsgold agg] considering poison per batch poison_fraction: 0.032244262214342005
[foolsgold agg] wv: [0.49864325 0.         0.         0.         0.16549679 0.85283803
 1.         0.         0.85283803 0.16549679]
___Test Target_ResNet_18 poisoned: False, epoch: 247: Average loss: 0.6532, Accuracy: 7841/10000 (78.4100%)
___Test Target_ResNet_18 poisoned: True, epoch: 247: Average loss: 5.7801, Accuracy: 375/9000 (4.1667%)
Done in 178.08919095993042 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:248 choose agents : [17, 33, 77, 11, 46, 96, 54, 39, 67, 82]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   1,  Average loss: 0.0126, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   2,  Average loss: 0.0113, Accuracy: 462/526 (87.8327%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   3,  Average loss: 0.0062, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   4,  Average loss: 0.0046, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   5,  Average loss: 0.0029, Accuracy: 511/526 (97.1483%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 17, internal_epoch   6,  Average loss: 0.0027, Accuracy: 513/526 (97.5285%), train_poison_data_count: 45
Global model norm: 37.62129958703164.
Norm before scaling: 38.36427858169302. Distance: 9.220673130974834
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.8541, Accuracy: 4708/10000 (47.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.3230, Accuracy: 8158/9000 (90.6444%)
Scaling by  100
Scaled Norm after poisoning: 921.2853792392452, distance: 922.067242667258
Total norm for 4 adversaries is: 921.2853792392452. distance: 922.067242667258
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   1,  Average loss: 0.0110, Accuracy: 448/527 (85.0095%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   2,  Average loss: 0.0100, Accuracy: 461/527 (87.4763%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   3,  Average loss: 0.0051, Accuracy: 490/527 (92.9791%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   4,  Average loss: 0.0036, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   5,  Average loss: 0.0024, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 33, internal_epoch   6,  Average loss: 0.0028, Accuracy: 506/527 (96.0152%), train_poison_data_count: 45
Global model norm: 37.62129958703164.
Norm before scaling: 38.15472234093786. Distance: 8.292196387873275
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.5706, Accuracy: 5294/10000 (52.9400%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 0.5264, Accuracy: 7438/9000 (82.6444%)
Scaling by  100
Scaled Norm after poisoning: 828.3636731532836, distance: 829.2195125538232
Total norm for 4 adversaries is: 828.3636731532836. distance: 829.2195125538232
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   1,  Average loss: 0.0087, Accuracy: 448/496 (90.3226%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   2,  Average loss: 0.0045, Accuracy: 470/496 (94.7581%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   3,  Average loss: 0.0030, Accuracy: 476/496 (95.9677%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   4,  Average loss: 0.0012, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 77, internal_epoch   6,  Average loss: 0.0008, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.62129958703164.
Norm before scaling: 37.703120143493265. Distance: 5.561613376549985
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.0075, Accuracy: 6716/10000 (67.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 3.6023, Accuracy: 798/9000 (8.8667%)
Scaling by  100
Scaled Norm after poisoning: 555.2062116907555, distance: 556.1613693434667
Total norm for 4 adversaries is: 555.2062116907555. distance: 556.1613693434667
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 475/546 (86.9963%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 511/546 (93.5897%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   3,  Average loss: 0.0028, Accuracy: 525/546 (96.1538%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   4,  Average loss: 0.0013, Accuracy: 537/546 (98.3516%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   5,  Average loss: 0.0005, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 248, local model 11, internal_epoch   6,  Average loss: 0.0011, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Global model norm: 37.62129958703164.
Norm before scaling: 37.86085170458894. Distance: 6.623663425574473
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.3091, Accuracy: 6118/10000 (61.1800%)
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: 4.8469, Accuracy: 51/9000 (0.5667%)
Scaling by  100
Scaled Norm after poisoning: 661.4872920170122, distance: 662.3664016237539
Total norm for 4 adversaries is: 661.4872920170122. distance: 662.3664016237539
___Test Local_ResNet_18 poisoned: True, epoch: 248: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   1,  Average loss: 0.0013, Accuracy: 593/601 (98.6689%)
___Train Local_ResNet_18,  epoch 248, local model 46, internal_epoch   2,  Average loss: 0.0014, Accuracy: 585/601 (97.3378%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 1.6474, Accuracy: 5734/10000 (57.3400%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   1,  Average loss: 0.0032, Accuracy: 666/708 (94.0678%)
___Train Local_ResNet_18,  epoch 248, local model 96, internal_epoch   2,  Average loss: 0.0035, Accuracy: 650/708 (91.8079%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 4.9171, Accuracy: 2776/10000 (27.7600%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   1,  Average loss: 0.0032, Accuracy: 411/440 (93.4091%)
___Train Local_ResNet_18,  epoch 248, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 433/440 (98.4091%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 3.4238, Accuracy: 4329/10000 (43.2900%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   1,  Average loss: 0.0055, Accuracy: 195/217 (89.8618%)
___Train Local_ResNet_18,  epoch 248, local model 39, internal_epoch   2,  Average loss: 0.0013, Accuracy: 214/217 (98.6175%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.6079, Accuracy: 4482/10000 (44.8200%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   1,  Average loss: 0.0061, Accuracy: 771/842 (91.5677%)
___Train Local_ResNet_18,  epoch 248, local model 67, internal_epoch   2,  Average loss: 0.0161, Accuracy: 607/842 (72.0903%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 12.4810, Accuracy: 1997/10000 (19.9700%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   1,  Average loss: 0.0018, Accuracy: 579/601 (96.3394%)
___Train Local_ResNet_18,  epoch 248, local model 82, internal_epoch   2,  Average loss: 0.0016, Accuracy: 588/601 (97.8369%)
___Test Local_ResNet_18 poisoned: False, epoch: 248: Average loss: 2.0979, Accuracy: 4870/10000 (48.7000%)
time spent on training: 138.49056196212769
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.38063226744186046  data num: [526, 527, 496, 546, 601, 708, 440, 217, 842, 601]
[foolsgold agg] considering poison per batch poison_fraction: 0.02973689589389535
[foolsgold agg] wv: [0.55768838 0.         0.02217317 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 248: Average loss: 0.6527, Accuracy: 7840/10000 (78.4000%)
___Test Target_ResNet_18 poisoned: True, epoch: 248: Average loss: 5.7714, Accuracy: 378/9000 (4.2000%)
Done in 173.81889748573303 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:249 choose agents : [17, 33, 77, 11, 21, 80, 91, 23, 65, 69]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   1,  Average loss: 0.0102, Accuracy: 473/526 (89.9240%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   2,  Average loss: 0.0084, Accuracy: 461/526 (87.6426%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   3,  Average loss: 0.0060, Accuracy: 485/526 (92.2053%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   4,  Average loss: 0.0050, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   5,  Average loss: 0.0039, Accuracy: 505/526 (96.0076%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 17, internal_epoch   6,  Average loss: 0.0034, Accuracy: 501/526 (95.2471%), train_poison_data_count: 45
Global model norm: 37.620668485097724.
Norm before scaling: 38.21975928757271. Distance: 8.571699783030795
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.7955, Accuracy: 4716/10000 (47.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.3868, Accuracy: 7839/9000 (87.1000%)
Scaling by  100
Scaled Norm after poisoning: 856.359664510187, distance: 857.169980225626
Total norm for 4 adversaries is: 856.359664510187. distance: 857.169980225626
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   1,  Average loss: 0.0122, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   2,  Average loss: 0.0108, Accuracy: 454/527 (86.1480%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   3,  Average loss: 0.0068, Accuracy: 486/527 (92.2201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 491/527 (93.1689%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   5,  Average loss: 0.0032, Accuracy: 508/527 (96.3947%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 514/527 (97.5332%), train_poison_data_count: 45
Global model norm: 37.620668485097724.
Norm before scaling: 38.47775458178725. Distance: 9.576567630576616
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.9506, Accuracy: 4557/10000 (45.5700%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 0.3291, Accuracy: 8058/9000 (89.5333%)
Scaling by  100
Scaled Norm after poisoning: 957.0125717565052, distance: 957.6568409404279
Total norm for 4 adversaries is: 957.0125717565052. distance: 957.6568409404279
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   1,  Average loss: 0.0073, Accuracy: 460/496 (92.7419%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 464/496 (93.5484%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   3,  Average loss: 0.0031, Accuracy: 478/496 (96.3710%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 485/496 (97.7823%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   5,  Average loss: 0.0010, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 77, internal_epoch   6,  Average loss: 0.0012, Accuracy: 487/496 (98.1855%), train_poison_data_count: 40
Global model norm: 37.620668485097724.
Norm before scaling: 37.69436608267872. Distance: 5.393700648288669
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.9889, Accuracy: 6748/10000 (67.4800%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 3.4292, Accuracy: 1090/9000 (12.1111%)
Scaling by  100
Scaled Norm after poisoning: 538.4991005099266, distance: 539.3701187496393
Total norm for 4 adversaries is: 538.4991005099266. distance: 539.3701187496393
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   1,  Average loss: 0.0068, Accuracy: 481/546 (88.0952%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   3,  Average loss: 0.0021, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   4,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   5,  Average loss: 0.0009, Accuracy: 542/546 (99.2674%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 249, local model 11, internal_epoch   6,  Average loss: 0.0008, Accuracy: 540/546 (98.9011%), train_poison_data_count: 45
Global model norm: 37.620668485097724.
Norm before scaling: 37.843240345453374. Distance: 6.49385660798108
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.4258, Accuracy: 5796/10000 (57.9600%)
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: 4.9138, Accuracy: 154/9000 (1.7111%)
Scaling by  100
Scaled Norm after poisoning: 648.5211301492034, distance: 649.3856952920968
Total norm for 4 adversaries is: 648.5211301492034. distance: 649.3856952920968
___Test Local_ResNet_18 poisoned: True, epoch: 249: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   1,  Average loss: 0.0038, Accuracy: 237/262 (90.4580%)
___Train Local_ResNet_18,  epoch 249, local model 21, internal_epoch   2,  Average loss: 0.0006, Accuracy: 260/262 (99.2366%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 4.5355, Accuracy: 3244/10000 (32.4400%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   1,  Average loss: 0.0049, Accuracy: 327/363 (90.0826%)
___Train Local_ResNet_18,  epoch 249, local model 80, internal_epoch   2,  Average loss: 0.0012, Accuracy: 356/363 (98.0716%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 6.1868, Accuracy: 3025/10000 (30.2500%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   1,  Average loss: 0.0043, Accuracy: 212/234 (90.5983%)
___Train Local_ResNet_18,  epoch 249, local model 91, internal_epoch   2,  Average loss: 0.0011, Accuracy: 230/234 (98.2906%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 1.5662, Accuracy: 5704/10000 (57.0400%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   1,  Average loss: 0.0038, Accuracy: 225/248 (90.7258%)
___Train Local_ResNet_18,  epoch 249, local model 23, internal_epoch   2,  Average loss: 0.0006, Accuracy: 245/248 (98.7903%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.1293, Accuracy: 4705/10000 (47.0500%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   1,  Average loss: 0.0043, Accuracy: 287/314 (91.4013%)
___Train Local_ResNet_18,  epoch 249, local model 65, internal_epoch   2,  Average loss: 0.0009, Accuracy: 310/314 (98.7261%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 2.8602, Accuracy: 4030/10000 (40.3000%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   1,  Average loss: 0.0071, Accuracy: 189/216 (87.5000%)
___Train Local_ResNet_18,  epoch 249, local model 69, internal_epoch   2,  Average loss: 0.0006, Accuracy: 215/216 (99.5370%)
___Test Local_ResNet_18 poisoned: False, epoch: 249: Average loss: 6.9670, Accuracy: 1347/10000 (13.4700%)
time spent on training: 136.78773498535156
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.5613612004287245  data num: [526, 527, 496, 546, 262, 363, 234, 248, 314, 216]
[foolsgold agg] considering poison per batch poison_fraction: 0.0438563437834941
[foolsgold agg] wv: [0.77738459 0.         0.20300158 0.         1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 249: Average loss: 0.6521, Accuracy: 7839/10000 (78.3900%)
___Test Target_ResNet_18 poisoned: True, epoch: 249: Average loss: 5.7433, Accuracy: 390/9000 (4.3333%)
Done in 170.96388459205627 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:250 choose agents : [17, 33, 77, 11, 44, 38, 93, 2, 16, 36]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   1,  Average loss: 0.0106, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   2,  Average loss: 0.0126, Accuracy: 458/526 (87.0722%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   3,  Average loss: 0.0072, Accuracy: 478/526 (90.8745%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   4,  Average loss: 0.0033, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   5,  Average loss: 0.0041, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 17, internal_epoch   6,  Average loss: 0.0028, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.619170995214496.
Norm before scaling: 38.19404128969678. Distance: 8.602209969387046
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.6001, Accuracy: 4990/10000 (49.9000%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.4199, Accuracy: 7909/9000 (87.8778%)
Scaling by  100
Scaled Norm after poisoning: 859.2751669284991, distance: 860.2211561569501
Total norm for 4 adversaries is: 859.2751669284991. distance: 860.2211561569501
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   1,  Average loss: 0.0133, Accuracy: 442/527 (83.8710%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   2,  Average loss: 0.0125, Accuracy: 449/527 (85.1992%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   3,  Average loss: 0.0089, Accuracy: 472/527 (89.5636%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   4,  Average loss: 0.0048, Accuracy: 487/527 (92.4099%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   5,  Average loss: 0.0040, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 33, internal_epoch   6,  Average loss: 0.0027, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Global model norm: 37.619170995214496.
Norm before scaling: 38.76768749551616. Distance: 10.653528665877234
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.8670, Accuracy: 4608/10000 (46.0800%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 0.5867, Accuracy: 7321/9000 (81.3444%)
Scaling by  100
Scaled Norm after poisoning: 1064.8077291229624, distance: 1065.352817145569
Total norm for 4 adversaries is: 1064.8077291229624. distance: 1065.352817145569
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   1,  Average loss: 0.0079, Accuracy: 441/496 (88.9113%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   2,  Average loss: 0.0051, Accuracy: 459/496 (92.5403%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   3,  Average loss: 0.0020, Accuracy: 484/496 (97.5806%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   4,  Average loss: 0.0015, Accuracy: 489/496 (98.5887%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 77, internal_epoch   6,  Average loss: 0.0007, Accuracy: 491/496 (98.9919%), train_poison_data_count: 40
Global model norm: 37.619170995214496.
Norm before scaling: 37.71547792870488. Distance: 5.495144347914707
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.0866, Accuracy: 6562/10000 (65.6200%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 3.8048, Accuracy: 582/9000 (6.4667%)
Scaling by  100
Scaled Norm after poisoning: 548.7141787852762, distance: 549.5144731942918
Total norm for 4 adversaries is: 548.7141787852762. distance: 549.5144731942918
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   1,  Average loss: 0.0087, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   2,  Average loss: 0.0041, Accuracy: 515/546 (94.3223%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   3,  Average loss: 0.0023, Accuracy: 530/546 (97.0696%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   4,  Average loss: 0.0022, Accuracy: 533/546 (97.6190%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   5,  Average loss: 0.0013, Accuracy: 539/546 (98.7179%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 250, local model 11, internal_epoch   6,  Average loss: 0.0006, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.619170995214496.
Norm before scaling: 37.694375797947295. Distance: 5.946225470924746
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 1.2395, Accuracy: 6099/10000 (60.9900%)
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: 3.3681, Accuracy: 402/9000 (4.4667%)
Scaling by  100
Scaled Norm after poisoning: 593.3141821581547, distance: 594.622595643657
Total norm for 4 adversaries is: 593.3141821581547. distance: 594.622595643657
___Test Local_ResNet_18 poisoned: True, epoch: 250: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   1,  Average loss: 0.0043, Accuracy: 397/436 (91.0550%)
___Train Local_ResNet_18,  epoch 250, local model 44, internal_epoch   2,  Average loss: 0.0023, Accuracy: 417/436 (95.6422%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.5207, Accuracy: 4625/10000 (46.2500%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   1,  Average loss: 0.0028, Accuracy: 715/756 (94.5767%)
___Train Local_ResNet_18,  epoch 250, local model 38, internal_epoch   2,  Average loss: 0.0049, Accuracy: 679/756 (89.8148%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 7.1894, Accuracy: 2485/10000 (24.8500%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   1,  Average loss: 0.0030, Accuracy: 552/584 (94.5205%)
___Train Local_ResNet_18,  epoch 250, local model 93, internal_epoch   2,  Average loss: 0.0047, Accuracy: 550/584 (94.1781%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.8700, Accuracy: 4351/10000 (43.5100%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   1,  Average loss: 0.0067, Accuracy: 399/461 (86.5510%)
___Train Local_ResNet_18,  epoch 250, local model 2, internal_epoch   2,  Average loss: 0.0061, Accuracy: 417/461 (90.4555%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 2.9770, Accuracy: 4057/10000 (40.5700%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   1,  Average loss: 0.0037, Accuracy: 715/773 (92.4968%)
___Train Local_ResNet_18,  epoch 250, local model 16, internal_epoch   2,  Average loss: 0.0062, Accuracy: 702/773 (90.8150%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 3.3828, Accuracy: 3977/10000 (39.7700%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   1,  Average loss: 0.0073, Accuracy: 734/849 (86.4547%)
___Train Local_ResNet_18,  epoch 250, local model 36, internal_epoch   2,  Average loss: 0.0140, Accuracy: 636/849 (74.9117%)
___Test Local_ResNet_18 poisoned: False, epoch: 250: Average loss: 11.0072, Accuracy: 2047/10000 (20.4700%)
time spent on training: 138.6995506286621
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.35186429291232785  data num: [526, 527, 496, 546, 436, 756, 584, 461, 773, 849]
[foolsgold agg] considering poison per batch poison_fraction: 0.027489397883775614
[foolsgold agg] wv: [1.         0.16765228 0.45623042 0.16765228 1.         1.
 1.         1.         1.         1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 250: Average loss: 0.6529, Accuracy: 7829/10000 (78.2900%)
___Test Target_ResNet_18 poisoned: True, epoch: 250: Average loss: 5.7132, Accuracy: 403/9000 (4.4778%)
Done in 173.71714282035828 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:251 choose agents : [17, 33, 77, 11, 36, 26, 95, 49, 48, 27]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   1,  Average loss: 0.0098, Accuracy: 481/526 (91.4449%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   2,  Average loss: 0.0119, Accuracy: 456/526 (86.6920%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   3,  Average loss: 0.0062, Accuracy: 489/526 (92.9658%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   4,  Average loss: 0.0051, Accuracy: 500/526 (95.0570%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   5,  Average loss: 0.0038, Accuracy: 498/526 (94.6768%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 17, internal_epoch   6,  Average loss: 0.0029, Accuracy: 504/526 (95.8175%), train_poison_data_count: 45
Global model norm: 37.61943383090464.
Norm before scaling: 38.42910540954766. Distance: 9.30257260415978
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.9750, Accuracy: 4616/10000 (46.1600%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.6361, Accuracy: 7522/9000 (83.5778%)
Scaling by  100
Scaled Norm after poisoning: 929.6759852228087, distance: 930.2572896785061
Total norm for 4 adversaries is: 929.6759852228087. distance: 930.2572896785061
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   1,  Average loss: 0.0137, Accuracy: 445/527 (84.4402%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   2,  Average loss: 0.0106, Accuracy: 462/527 (87.6660%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   3,  Average loss: 0.0052, Accuracy: 489/527 (92.7894%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   4,  Average loss: 0.0028, Accuracy: 504/527 (95.6357%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   5,  Average loss: 0.0023, Accuracy: 512/527 (97.1537%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 33, internal_epoch   6,  Average loss: 0.0015, Accuracy: 516/527 (97.9127%), train_poison_data_count: 45
Global model norm: 37.61943383090464.
Norm before scaling: 38.17791857601557. Distance: 8.565975625433879
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.8993, Accuracy: 4605/10000 (46.0500%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 0.2135, Accuracy: 8333/9000 (92.5889%)
Scaling by  100
Scaled Norm after poisoning: 855.6109659185067, distance: 856.5974842363244
Total norm for 4 adversaries is: 855.6109659185067. distance: 856.5974842363244
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   1,  Average loss: 0.0082, Accuracy: 446/496 (89.9194%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   2,  Average loss: 0.0072, Accuracy: 450/496 (90.7258%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   3,  Average loss: 0.0039, Accuracy: 471/496 (94.9597%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   4,  Average loss: 0.0024, Accuracy: 481/496 (96.9758%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   5,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 77, internal_epoch   6,  Average loss: 0.0010, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Global model norm: 37.61943383090464.
Norm before scaling: 37.76177027027881. Distance: 5.986054107717168
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.0446, Accuracy: 6606/10000 (66.0600%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 3.3143, Accuracy: 887/9000 (9.8556%)
Scaling by  100
Scaled Norm after poisoning: 597.6900063996386, distance: 598.6054627214824
Total norm for 4 adversaries is: 597.6900063996386. distance: 598.6054627214824
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   1,  Average loss: 0.0067, Accuracy: 499/546 (91.3919%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   2,  Average loss: 0.0052, Accuracy: 510/546 (93.4066%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   3,  Average loss: 0.0025, Accuracy: 531/546 (97.2527%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   4,  Average loss: 0.0008, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 541/546 (99.0842%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 251, local model 11, internal_epoch   6,  Average loss: 0.0004, Accuracy: 543/546 (99.4505%), train_poison_data_count: 45
Global model norm: 37.61943383090464.
Norm before scaling: 37.784619757705315. Distance: 6.185002911627908
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.2435, Accuracy: 6264/10000 (62.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: 5.1186, Accuracy: 45/9000 (0.5000%)
Scaling by  100
Scaled Norm after poisoning: 617.558119734491, distance: 618.5003536781527
Total norm for 4 adversaries is: 617.558119734491. distance: 618.5003536781527
___Test Local_ResNet_18 poisoned: True, epoch: 251: Average loss: nan, Accuracy: 0/9000 (0.0000%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   1,  Average loss: 0.0083, Accuracy: 722/849 (85.0412%)
___Train Local_ResNet_18,  epoch 251, local model 36, internal_epoch   2,  Average loss: 0.0164, Accuracy: 593/849 (69.8469%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 7.8750, Accuracy: 2571/10000 (25.7100%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   1,  Average loss: 0.0043, Accuracy: 435/468 (92.9487%)
___Train Local_ResNet_18,  epoch 251, local model 26, internal_epoch   2,  Average loss: 0.0035, Accuracy: 435/468 (92.9487%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 3.2605, Accuracy: 4026/10000 (40.2600%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   1,  Average loss: 0.0091, Accuracy: 463/569 (81.3708%)
___Train Local_ResNet_18,  epoch 251, local model 95, internal_epoch   2,  Average loss: 0.0057, Accuracy: 508/569 (89.2794%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 6.6994, Accuracy: 2533/10000 (25.3300%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   1,  Average loss: 0.0034, Accuracy: 394/426 (92.4883%)
___Train Local_ResNet_18,  epoch 251, local model 49, internal_epoch   2,  Average loss: 0.0016, Accuracy: 413/426 (96.9484%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 2.1167, Accuracy: 4857/10000 (48.5700%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   1,  Average loss: 0.0047, Accuracy: 345/378 (91.2698%)
___Train Local_ResNet_18,  epoch 251, local model 48, internal_epoch   2,  Average loss: 0.0012, Accuracy: 373/378 (98.6772%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 3.5538, Accuracy: 3278/10000 (32.7800%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   1,  Average loss: 0.0020, Accuracy: 383/397 (96.4736%)
___Train Local_ResNet_18,  epoch 251, local model 27, internal_epoch   2,  Average loss: 0.0020, Accuracy: 389/397 (97.9849%)
___Test Local_ResNet_18 poisoned: False, epoch: 251: Average loss: 1.3537, Accuracy: 6097/10000 (60.9700%)
time spent on training: 138.67568969726562
----------------------------------End one training epoch------------------------------------------
[foolsgold agg] training data poison_ratio: 0.40428406020841373  data num: [526, 527, 496, 546, 849, 468, 569, 426, 378, 397]
[foolsgold agg] considering poison per batch poison_fraction: 0.03158469220378232
[foolsgold agg] wv: [0.51434941 0.         0.03936803 0.         1.         0.25500669
 0.80003684 0.57636366 0.57636366 1.        ]
___Test Target_ResNet_18 poisoned: False, epoch: 251: Average loss: 0.6529, Accuracy: 7835/10000 (78.3500%)
___Test Target_ResNet_18 poisoned: True, epoch: 251: Average loss: 5.6893, Accuracy: 409/9000 (4.5444%)
Done in 173.05844378471375 sec.
----------------------------------Start one training epoch------------------------------------------
Server Epoch:252 choose agents : [17, 33, 77, 11, 49, 74, 94, 29, 76, 70]. Adversary List: [17, 33, 77, 11]
poison local model 17 index 0 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   1,  Average loss: 0.0080, Accuracy: 483/526 (91.8251%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   2,  Average loss: 0.0104, Accuracy: 477/526 (90.6844%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   3,  Average loss: 0.0066, Accuracy: 481/526 (91.4449%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   4,  Average loss: 0.0034, Accuracy: 507/526 (96.3878%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   5,  Average loss: 0.0028, Accuracy: 510/526 (96.9582%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 17, internal_epoch   6,  Average loss: 0.0023, Accuracy: 509/526 (96.7681%), train_poison_data_count: 45
Global model norm: 37.61876213604639.
Norm before scaling: 37.99904430593041. Distance: 7.563842402082749
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.6544, Accuracy: 5150/10000 (51.5000%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.3175, Accuracy: 8101/9000 (90.0111%)
Scaling by  100
Scaled Norm after poisoning: 755.4381592824127, distance: 756.3843269132432
Total norm for 4 adversaries is: 755.4381592824127. distance: 756.3843269132432
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 33 index 1 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   1,  Average loss: 0.0122, Accuracy: 447/527 (84.8197%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   2,  Average loss: 0.0095, Accuracy: 464/527 (88.0455%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   3,  Average loss: 0.0076, Accuracy: 480/527 (91.0816%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   4,  Average loss: 0.0040, Accuracy: 502/527 (95.2562%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   5,  Average loss: 0.0036, Accuracy: 511/527 (96.9639%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 33, internal_epoch   6,  Average loss: 0.0036, Accuracy: 509/527 (96.5844%), train_poison_data_count: 45
Global model norm: 37.61876213604639.
Norm before scaling: 38.43755081297454. Distance: 9.570308514029783
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 1.6450, Accuracy: 4964/10000 (49.6400%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 0.5738, Accuracy: 7469/9000 (82.9889%)
Scaling by  100
Scaled Norm after poisoning: 956.2381698614629, distance: 957.030759693752
Total norm for 4 adversaries is: 956.2381698614629. distance: 957.030759693752
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 77 index 2 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   1,  Average loss: 0.0064, Accuracy: 455/496 (91.7339%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   2,  Average loss: 0.0063, Accuracy: 457/496 (92.1371%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   3,  Average loss: 0.0034, Accuracy: 473/496 (95.3629%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   4,  Average loss: 0.0016, Accuracy: 486/496 (97.9839%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   5,  Average loss: 0.0009, Accuracy: 490/496 (98.7903%), train_poison_data_count: 40
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 77, internal_epoch   6,  Average loss: 0.0009, Accuracy: 493/496 (99.3952%), train_poison_data_count: 40
Global model norm: 37.61876213604639.
Norm before scaling: 37.72321910661423. Distance: 5.562696303429171
will scale.
___Test Local_ResNet_18 poisoned: False, epoch: 252: Average loss: 0.9178, Accuracy: 6995/10000 (69.9500%)
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: 4.0270, Accuracy: 426/9000 (4.7333%)
Scaling by  100
Scaled Norm after poisoning: 555.4670332251951, distance: 556.2696063960352
Total norm for 4 adversaries is: 555.4670332251951. distance: 556.2696063960352
___Test Local_ResNet_18 poisoned: True, epoch: 252: Average loss: nan, Accuracy: 0/9000 (0.0000%)
poison local model 11 index 3 
--------------------Start poison_now -----------------------------
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   1,  Average loss: 0.0057, Accuracy: 504/546 (92.3077%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 512/546 (93.7729%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   3,  Average loss: 0.0029, Accuracy: 527/546 (96.5201%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   4,  Average loss: 0.0018, Accuracy: 535/546 (97.9853%), train_poison_data_count: 45
Current lr: [0.05]
___PoisonTrain Local_ResNet_18 ,  epoch 252, local model 11, internal_epoch   5,  Average loss: 0.0012, Accuracy: 538/546 (98.5348%), train_poison_data_count: 45
